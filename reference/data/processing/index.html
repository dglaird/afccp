
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://dglaird.github.io/afccp/reference/data/processing/">
      
      
        <link rel="prev" href="../preferences/">
      
      
        <link rel="next" href="../values/">
      
      
      <link rel="icon" href="../../../images/logos/afccp_logo_favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Processing - Air Force Cadet Career Problem</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#data.processing" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Air Force Cadet Career Problem" class="md-header__button md-logo" aria-label="Air Force Cadet Career Problem" data-md-component="logo">
      
  <img src="../../../images/logos/afccp_logo_and_text_light.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Air Force Cadet Career Problem
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Processing
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/dglaird/afccp/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  üè† Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../getting-started/getting-started/" class="md-tabs__link">
          
  
  
  üöÄ Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../user-guide/overview/" class="md-tabs__link">
          
  
  
  üìò User Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../developer-guide/" class="md-tabs__link">
        
  
  
    
  
  üß† Developer Guide

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../main/cadetcareerproblem_overview/" class="md-tabs__link">
          
  
  
  CadetCareerProblem

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  üìä Data

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../solutions/" class="md-tabs__link">
          
  
  
  üìà Solutions

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../visualizations/" class="md-tabs__link">
          
  
  
  Visualizations

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../faq/" class="md-tabs__link">
        
  
  
    
  
  ‚ùì FAQs

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../help/" class="md-tabs__link">
        
  
  
    
  
  üÜò Help & Support

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Air Force Cadet Career Problem" class="md-nav__button md-logo" aria-label="Air Force Cadet Career Problem" data-md-component="logo">
      
  <img src="../../../images/logos/afccp_logo_and_text_light.png" alt="logo">

    </a>
    Air Force Cadet Career Problem
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/dglaird/afccp/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üè† Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üöÄ Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            üöÄ Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting-started/getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üìÑ Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üõ†Ô∏è Install Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            üõ†Ô∏è Install Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting-started/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation Instructions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting-started/developer-checklist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Developer Checklist
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üìò User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            üìò User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/tutorial_1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 1 (Introduction)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/tutorial_2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 2 (Data Overview)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/tutorial_3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 3 (Parameters)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/tutorial_4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 4 (Value Parameters)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/tutorial_5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 5 (Data Methods)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/tutorial_6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 6 (Solutions Overview)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/tutorial_7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 7 (Algorithms)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/tutorial_8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 8 (Optimization)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/tutorial_9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 9 (Visualizations)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üß† Developer Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    CadetCareerProblem
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            CadetCareerProblem
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_generated_data_corrections/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generated Data Corrections
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_main_data_corrections/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Main Data Corrections
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_other_adjustments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Other Adjustments
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_value_parameter_specifications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Value Parameter Specifications
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_solution_generation_%26_algorithms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solution Generation & Algorithms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_optimization_models_%26_meta-heuristics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Optimization Models & Meta-Heuristics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_solution_handling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solution Handling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_export_data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Export Data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_data_visualizations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Visualizations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_results_visualizations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Results Visualizations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    üìä Data
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            üìä Data
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adjustments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Adjustments
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../preferences/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Preferences
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Processing
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Processing
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data.processing--data-processing-module" class="md-nav__link">
    <span class="md-ellipsis">
      Data Processing Module
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Processing Module">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data.processing--key-capabilities" class="md-nav__link">
    <span class="md-ellipsis">
      Key Capabilities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data.processing--primary-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Primary Functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data.processing--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data.processing.initialize_file_information" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_file_information
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data.processing.import_afscs_data" class="md-nav__link">
    <span class="md-ellipsis">
      import_afscs_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data.processing.import_cadets_data" class="md-nav__link">
    <span class="md-ellipsis">
      import_cadets_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data.processing.import_afsc_cadet_matrices_data" class="md-nav__link">
    <span class="md-ellipsis">
      import_afsc_cadet_matrices_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data.processing.import_value_parameters_data" class="md-nav__link">
    <span class="md-ellipsis">
      import_value_parameters_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data.processing.import_solutions_data" class="md-nav__link">
    <span class="md-ellipsis">
      import_solutions_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data.processing.import_additional_data" class="md-nav__link">
    <span class="md-ellipsis">
      import_additional_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data.processing.export_afscs_data" class="md-nav__link">
    <span class="md-ellipsis">
      export_afscs_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data.processing.export_cadets_data" class="md-nav__link">
    <span class="md-ellipsis">
      export_cadets_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data.processing.export_afsc_cadet_matrices_data" class="md-nav__link">
    <span class="md-ellipsis">
      export_afsc_cadet_matrices_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data.processing.export_value_parameters_data" class="md-nav__link">
    <span class="md-ellipsis">
      export_value_parameters_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data.processing.export_solutions_data" class="md-nav__link">
    <span class="md-ellipsis">
      export_solutions_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data.processing.export_additional_data" class="md-nav__link">
    <span class="md-ellipsis">
      export_additional_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data.processing.export_solution_results" class="md-nav__link">
    <span class="md-ellipsis">
      export_solution_results
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data.processing.draw_frame_border_outside" class="md-nav__link">
    <span class="md-ellipsis">
      draw_frame_border_outside
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../values/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Values
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../support/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Support
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generation/basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generation- 'Basic'
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generation/realistic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generation- 'Realistic'
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üìà Solutions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            üìà Solutions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../solutions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../solutions/algorithms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Algorithms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../solutions/handling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Handling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../solutions/optimization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../solutions/sensitivity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sensitivity
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Visualizations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Visualizations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../visualizations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../visualizations/bubbles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bubbles
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../visualizations/charts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Charts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../visualizations/slides/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Slides
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ‚ùì FAQs
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../help/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üÜò Help & Support
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<div class="doc doc-object doc-module">



<h1 id="data.processing" class="doc doc-heading">
            <code>data.processing</code>


<a href="#data.processing" class="headerlink" title="Permanent link">&para;</a></h1>

    <div class="doc doc-contents first">

        <h2 id="data.processing--data-processing-module">Data Processing Module<a class="headerlink" href="#data.processing--data-processing-module" title="Permanent link">&para;</a></h2>
<p>This module handles all input/output operations for the AFCCP modeling pipeline.</p>
<p>It supports importing problem instance data (AFSCs, cadets, preferences, value functions, etc.)
and exporting solutions and diagnostics to CSV and Excel formats for analysis. It also
initializes the directory structure for versioned data instances.</p>
<h3 id="data.processing--key-capabilities">Key Capabilities<a class="headerlink" href="#data.processing--key-capabilities" title="Permanent link">&para;</a></h3>
<ul>
<li>Organizes input/output folders and paths for a data instance</li>
<li>Imports cleaned data required for AFCCP optimization</li>
<li>Exports results and supporting data for evaluation and visualization</li>
</ul>
<h3 id="data.processing--primary-functions">Primary Functions<a class="headerlink" href="#data.processing--primary-functions" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>Initialization</strong></p>
<ul>
<li><code>initialize_file_information</code>: Sets up import/export folder paths for a given data name and version</li>
</ul>
</li>
<li>
<p><strong>Import Functions</strong></p>
<ul>
<li><code>import_afscs_data</code>: Loads AFSCs and related structural data</li>
<li><code>import_cadets_data</code>: Loads cadet records and attributes</li>
<li><code>import_afsc_cadet_matrices_data</code>: Loads cadet preference matrices and qualification matrices</li>
<li><code>import_value_parameters_data</code>: Loads objective weights and breakpoints for value functions</li>
<li><code>import_solutions_data</code>: Imports previously solved cadet-to-AFSC assignments</li>
<li><code>import_additional_data</code>: Loads auxiliary data like base assignments and course info</li>
</ul>
</li>
<li>
<p><strong>Export Functions</strong></p>
<ul>
<li><code>export_afscs_data</code>: Saves AFSC-related data to CSV</li>
<li><code>export_cadets_data</code>: Saves cadet-related data to CSV</li>
<li><code>export_afsc_cadet_matrices_data</code>: Saves preference and qualification matrices to CSV</li>
<li><code>export_value_parameters_data</code>: Saves value function breakpoints and weights to CSV</li>
<li><code>export_solutions_data</code>: Saves one or more solutions in compact CSV format</li>
<li><code>export_additional_data</code>: Saves supporting data (base preferences, utility matrices, courses)</li>
<li><code>export_solution_results_excel</code>: Writes detailed solution metrics and diagnostics to an Excel workbook</li>
</ul>
</li>
</ul>
<h3 id="data.processing--notes">Notes<a class="headerlink" href="#data.processing--notes" title="Permanent link">&para;</a></h3>
<p>All functions assume access to an <code>Instance</code> object that contains parameters, value structures,
solution data, and export path information. The module is used during both the data preparation
and results analysis stages of the AFCCP workflow.</p>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="data.processing.initialize_file_information" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">initialize_file_information</span><span class="p">(</span><span class="n">data_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span></code>

<a href="#data.processing.initialize_file_information" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Initialize filepaths for an AFCCP data instance.</p>
<p>This function constructs and returns import/export file path dictionaries for a given AFCCP
data instance identified by <code>data_name</code> and <code>data_version</code>. It ensures the required directory
structure exists under <code>instances/</code> and dynamically builds file paths for reading and writing
instance-specific data and results.</p>
<p>It is primarily used to manage file I/O consistently across different data experiments or
scenario versions within the AFCCP modeling system.</p>
<h4 id="data.processing.initialize_file_information--parameters">Parameters<a class="headerlink" href="#data.processing.initialize_file_information--parameters" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>data_name : str
  The name of the data instance (e.g., <code>"2025"</code>, <code>"Baseline"</code>, <code>"TestRun01"</code>). This defines the
  subdirectory under <code>instances/</code> where the data is stored.</p>
</li>
<li>
<p>data_version : str
  The version label for the run (e.g., <code>"Default"</code>, <code>"V1"</code>). Used to separate multiple experimental
  runs under the same data instance name, enabling controlled versioning of model input and output files.</p>
</li>
</ul>
<h4 id="data.processing.initialize_file_information--returns">Returns<a class="headerlink" href="#data.processing.initialize_file_information--returns" title="Permanent link">&para;</a></h4>
<ul>
<li>Tuple[Dict[str, str], Dict[str, str]]
  A tuple of two dictionaries:<ul>
<li><code>import_paths</code>: maps each input data type (e.g., <code>"Cadets"</code>, <code>"AFSCs"</code>) to its CSV file path.</li>
<li><code>export_paths</code>: maps each output destination (e.g., <code>"Solutions"</code>, <code>"Results Charts"</code>) to its folder or file path.</li>
</ul>
</li>
</ul>
<h4 id="data.processing.initialize_file_information--directory-behavior">Directory Behavior<a class="headerlink" href="#data.processing.initialize_file_information--directory-behavior" title="Permanent link">&para;</a></h4>
<ul>
<li>Creates base folder <code>instances/&lt;data_name&gt;/</code> if it doesn't exist.</li>
<li>Creates version-specific folders for <code>"Model Input"</code> and <code>"Analysis &amp; Results"</code>:<ul>
<li>e.g., <code>"4. Model Input (V1)"</code>, <code>"5. Analysis &amp; Results (V1)"</code></li>
</ul>
</li>
<li>Also creates subfolders under <code>"Analysis &amp; Results"</code> such as:<ul>
<li><code>"Data Charts"</code>, <code>"Results Charts"</code>, <code>"Cadet Board"</code>, <code>"Value Functions"</code></li>
</ul>
</li>
<li>If version-specific input files are not found, it defaults to shared or base files when appropriate.</li>
</ul>
<h4 id="data.processing.initialize_file_information--examples">Examples<a class="headerlink" href="#data.processing.initialize_file_information--examples" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">afccp.data.processing</span> <span class="kn">import</span> <span class="n">initialize_file_information</span>

<span class="n">import_paths</span><span class="p">,</span> <span class="n">export_paths</span> <span class="o">=</span> <span class="n">initialize_file_information</span><span class="p">(</span><span class="s2">&quot;2025&quot;</span><span class="p">,</span> <span class="s2">&quot;V1&quot;</span><span class="p">)</span>
<span class="n">afsc_path</span> <span class="o">=</span> <span class="n">import_paths</span><span class="p">[</span><span class="s2">&quot;AFSCs&quot;</span><span class="p">]</span>
<span class="n">solution_folder</span> <span class="o">=</span> <span class="n">export_paths</span><span class="p">[</span><span class="s2">&quot;Analysis &amp; Results&quot;</span><span class="p">]</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">initialize_file_information</span><span class="p">(</span><span class="n">data_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize filepaths for an AFCCP data instance.</span>

<span class="sd">    This function constructs and returns import/export file path dictionaries for a given AFCCP</span>
<span class="sd">    data instance identified by `data_name` and `data_version`. It ensures the required directory</span>
<span class="sd">    structure exists under `instances/` and dynamically builds file paths for reading and writing</span>
<span class="sd">    instance-specific data and results.</span>

<span class="sd">    It is primarily used to manage file I/O consistently across different data experiments or</span>
<span class="sd">    scenario versions within the AFCCP modeling system.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    - data_name : str</span>
<span class="sd">      The name of the data instance (e.g., `&quot;2025&quot;`, `&quot;Baseline&quot;`, `&quot;TestRun01&quot;`). This defines the</span>
<span class="sd">      subdirectory under `instances/` where the data is stored.</span>

<span class="sd">    - data_version : str</span>
<span class="sd">      The version label for the run (e.g., `&quot;Default&quot;`, `&quot;V1&quot;`). Used to separate multiple experimental</span>
<span class="sd">      runs under the same data instance name, enabling controlled versioning of model input and output files.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    - Tuple[Dict[str, str], Dict[str, str]]</span>
<span class="sd">      A tuple of two dictionaries:</span>
<span class="sd">        - `import_paths`: maps each input data type (e.g., `&quot;Cadets&quot;`, `&quot;AFSCs&quot;`) to its CSV file path.</span>
<span class="sd">        - `export_paths`: maps each output destination (e.g., `&quot;Solutions&quot;`, `&quot;Results Charts&quot;`) to its folder or file path.</span>

<span class="sd">    Directory Behavior</span>
<span class="sd">    ------------------</span>
<span class="sd">    - Creates base folder `instances/&lt;data_name&gt;/` if it doesn&#39;t exist.</span>
<span class="sd">    - Creates version-specific folders for `&quot;Model Input&quot;` and `&quot;Analysis &amp; Results&quot;`:</span>
<span class="sd">        - e.g., `&quot;4. Model Input (V1)&quot;`, `&quot;5. Analysis &amp; Results (V1)&quot;`</span>
<span class="sd">    - Also creates subfolders under `&quot;Analysis &amp; Results&quot;` such as:</span>
<span class="sd">        - `&quot;Data Charts&quot;`, `&quot;Results Charts&quot;`, `&quot;Cadet Board&quot;`, `&quot;Value Functions&quot;`</span>
<span class="sd">    - If version-specific input files are not found, it defaults to shared or base files when appropriate.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```python</span>
<span class="sd">    from afccp.data.processing import initialize_file_information</span>

<span class="sd">    import_paths, export_paths = initialize_file_information(&quot;2025&quot;, &quot;V1&quot;)</span>
<span class="sd">    afsc_path = import_paths[&quot;AFSCs&quot;]</span>
<span class="sd">    solution_folder = export_paths[&quot;Analysis &amp; Results&quot;]</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># If we don&#39;t already have the instance folder, we make it now</span>
    <span class="n">instance_path</span> <span class="o">=</span> <span class="s2">&quot;instances/&quot;</span> <span class="o">+</span> <span class="n">data_name</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
    <span class="k">if</span> <span class="n">data_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">afccp</span><span class="o">.</span><span class="n">globals</span><span class="o">.</span><span class="n">instances_available</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">instance_path</span><span class="p">)</span>
    <span class="n">instance_folder</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">instance_path</span><span class="p">))</span>

    <span class="c1"># Valid files/folders</span>
    <span class="n">sub_folders</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Original &amp; Supplemental&quot;</span><span class="p">,</span> <span class="s2">&quot;Combined Data&quot;</span><span class="p">,</span> <span class="s2">&quot;CFMs&quot;</span><span class="p">,</span> <span class="s2">&quot;Model Input&quot;</span><span class="p">,</span> <span class="s2">&quot;Analysis &amp; Results&quot;</span><span class="p">]</span>
    <span class="n">sub_folder_files</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Model Input&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Cadets&quot;</span><span class="p">,</span> <span class="s2">&quot;Cadets Preferences&quot;</span><span class="p">,</span> <span class="s2">&quot;Cadets Utility&quot;</span><span class="p">,</span> <span class="s2">&quot;Cadets Utility Constraints&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Cadets Utility (Final)&quot;</span><span class="p">,</span> <span class="s2">&quot;AFSCs&quot;</span><span class="p">,</span> <span class="s2">&quot;AFSCs Preferences&quot;</span><span class="p">,</span> <span class="s2">&quot;AFSCs Utility&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Value Parameters&quot;</span><span class="p">,</span> <span class="s2">&quot;Goal Programming&quot;</span><span class="p">,</span> <span class="s2">&quot;ROTC Rated Interest&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;ROTC Rated OM&quot;</span><span class="p">,</span> <span class="s2">&quot;USAFA Rated OM&quot;</span><span class="p">,</span> <span class="s2">&quot;OTS Rated OM&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Bases&quot;</span><span class="p">,</span> <span class="s2">&quot;Bases Preferences&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Bases Utility&quot;</span><span class="p">,</span> <span class="s2">&quot;Courses&quot;</span><span class="p">,</span> <span class="s2">&quot;Cadets Selected&quot;</span><span class="p">,</span> <span class="s2">&quot;AFSCs Buckets&quot;</span><span class="p">,</span>
                                        <span class="s1">&#39;Castle Input&#39;</span><span class="p">],</span>
                        <span class="s2">&quot;Analysis &amp; Results&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Solutions&quot;</span><span class="p">,</span> <span class="s2">&quot;Base Solutions&quot;</span><span class="p">,</span> <span class="s2">&quot;Course Solutions&quot;</span><span class="p">]}</span>

    <span class="c1"># Loop through each sub-folder in the above list and determine the filepaths for the various files</span>
    <span class="n">import_filepaths</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">export_filepaths</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sub_folder</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sub_folders</span><span class="p">):</span>

        <span class="c1"># Sub-Folder with the number: &quot;4. Model Input&quot; for example</span>
        <span class="n">numbered_sub_folder</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;. &quot;</span> <span class="o">+</span> <span class="n">sub_folder</span>

        <span class="c1"># All the sub-folders that have this numbered sub-folder</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">instance_folder</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flatnonzero</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">defchararray</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">instance_folder</span><span class="p">,</span> <span class="n">numbered_sub_folder</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">sub_folder_individuals</span> <span class="o">=</span> <span class="n">instance_folder</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sub_folder_individuals</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># If this is the &quot;default version&quot;, we already know what the sub-folder has to be</span>
        <span class="k">if</span> <span class="n">data_version</span> <span class="o">==</span> <span class="s2">&quot;Default&quot;</span><span class="p">:</span>
            <span class="n">import_sub_folder</span> <span class="o">=</span> <span class="n">numbered_sub_folder</span>
            <span class="n">export_sub_folder</span> <span class="o">=</span> <span class="n">numbered_sub_folder</span>

            <span class="c1"># If we don&#39;t currently have this sub-folder, we make it (New instance file)</span>
            <span class="k">if</span> <span class="n">numbered_sub_folder</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sub_folder_individuals</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">instance_path</span> <span class="o">+</span> <span class="n">numbered_sub_folder</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>

        <span class="c1"># If the data version was specified, we have to check if it has the specific folder or not</span>
        <span class="k">else</span><span class="p">:</span>

            <span class="c1"># If the version folder is not there, we import from the default but will export to the data version folder</span>
            <span class="n">version_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flatnonzero</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">defchararray</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">sub_folder_individuals</span><span class="p">,</span> <span class="n">data_version</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">version_indices</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">import_sub_folder</span> <span class="o">=</span> <span class="n">numbered_sub_folder</span>
                <span class="n">export_sub_folder</span> <span class="o">=</span> <span class="n">numbered_sub_folder</span> <span class="o">+</span> <span class="s2">&quot; (&quot;</span> <span class="o">+</span> <span class="n">data_version</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>

                <span class="c1"># We will only ever export specific version data to these sub-folders</span>
                <span class="k">if</span> <span class="n">sub_folder</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Model Input&quot;</span><span class="p">,</span> <span class="s2">&quot;Analysis &amp; Results&quot;</span><span class="p">]:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">instance_path</span> <span class="o">+</span> <span class="n">export_sub_folder</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>

            <span class="c1"># We already have the version folder</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">import_sub_folder</span> <span class="o">=</span> <span class="n">sub_folder_individuals</span><span class="p">[</span><span class="n">version_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="n">export_sub_folder</span> <span class="o">=</span> <span class="n">sub_folder_individuals</span><span class="p">[</span><span class="n">version_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

        <span class="c1"># If this is one of the sub-folders we can import/export to/from</span>
        <span class="k">if</span> <span class="n">sub_folder</span> <span class="ow">in</span> <span class="n">sub_folder_files</span><span class="p">:</span>

            <span class="c1"># Get sub folder paths</span>
            <span class="n">import_sub_folder_path</span> <span class="o">=</span> <span class="n">instance_path</span> <span class="o">+</span> <span class="n">import_sub_folder</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
            <span class="n">export_sub_folder_path</span> <span class="o">=</span> <span class="n">instance_path</span> <span class="o">+</span> <span class="n">export_sub_folder</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>

            <span class="c1"># Add generic file-paths for this sub-folder</span>
            <span class="n">export_filepaths</span><span class="p">[</span><span class="n">sub_folder</span><span class="p">]</span> <span class="o">=</span> <span class="n">export_sub_folder_path</span>
            <span class="n">import_filepaths</span><span class="p">[</span><span class="n">sub_folder</span><span class="p">]</span> <span class="o">=</span> <span class="n">import_sub_folder_path</span>

            <span class="c1"># Loop through each file listed above in the &quot;sub_folder_files&quot; for this sub-folder</span>
            <span class="n">sub_folder_files_available</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">import_sub_folder_path</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">sub_folder_files</span><span class="p">[</span><span class="n">sub_folder</span><span class="p">]:</span>

                <span class="c1"># Create the name of the file</span>
                <span class="k">if</span> <span class="n">data_version</span> <span class="o">==</span> <span class="s2">&quot;Default&quot;</span><span class="p">:</span>
                    <span class="n">filename</span> <span class="o">=</span> <span class="n">data_name</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">file</span> <span class="o">+</span> <span class="s2">&quot;.csv&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">filename</span> <span class="o">=</span> <span class="n">data_name</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">file</span> <span class="o">+</span> <span class="s2">&quot; (&quot;</span> <span class="o">+</span> <span class="n">data_version</span> <span class="o">+</span> <span class="s2">&quot;).csv&quot;</span>

                <span class="c1"># Get the path that we would export this file to</span>
                <span class="n">export_filepaths</span><span class="p">[</span><span class="n">file</span><span class="p">]</span> <span class="o">=</span> <span class="n">export_sub_folder_path</span> <span class="o">+</span> <span class="n">filename</span>

                <span class="c1"># If we already have this file in the &quot;import path&quot;, we add it to that filepath dictionary</span>
                <span class="k">if</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">sub_folder_files_available</span><span class="p">:</span>
                    <span class="n">import_filepaths</span><span class="p">[</span><span class="n">file</span><span class="p">]</span> <span class="o">=</span> <span class="n">import_sub_folder_path</span> <span class="o">+</span> <span class="n">filename</span>
                <span class="k">elif</span> <span class="n">data_version</span> <span class="o">!=</span> <span class="s2">&quot;Default&quot;</span> <span class="ow">and</span> <span class="n">data_name</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">file</span> <span class="o">+</span> <span class="s2">&quot;.csv&quot;</span> <span class="ow">in</span> <span class="n">sub_folder_files_available</span><span class="p">:</span>
                    <span class="n">import_filepaths</span><span class="p">[</span><span class="n">file</span><span class="p">]</span> <span class="o">=</span> <span class="n">import_sub_folder_path</span> <span class="o">+</span> <span class="n">data_name</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">file</span> <span class="o">+</span> <span class="s2">&quot;.csv&quot;</span>

    <span class="c1"># If we don&#39;t have one of the Analysis &amp; Results &quot;sub-sub folders&quot;, we make it</span>
    <span class="k">for</span> <span class="n">sub_sub_folder</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Data Charts&quot;</span><span class="p">,</span> <span class="s2">&quot;Results Charts&quot;</span><span class="p">,</span> <span class="s2">&quot;Cadet Board&quot;</span><span class="p">,</span> <span class="s1">&#39;Value Functions&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">sub_sub_folder</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">export_filepaths</span><span class="p">[</span><span class="s2">&quot;Analysis &amp; Results&quot;</span><span class="p">]):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">export_filepaths</span><span class="p">[</span><span class="s2">&quot;Analysis &amp; Results&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">sub_sub_folder</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>

    <span class="c1"># Return the information</span>
    <span class="k">return</span> <span class="n">import_filepaths</span><span class="p">,</span> <span class="n">export_filepaths</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="data.processing.import_afscs_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">import_afscs_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span></code>

<a href="#data.processing.import_afscs_data" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Imports AFSC-level model input data from CSV and populates the instance parameter dictionary.</p>
<p>This function reads the <code>"AFSCs"</code> input file (provided via <code>import_filepaths</code>) and updates the supplied
<code>parameters</code> dictionary with structured information for each Air Force Specialty Code (AFSC). These inputs
are essential for AFCCP modeling and include AFSC quotas, groupings, tiered degree requirements, and other
structural attributes.</p>
<p>The function handles type conversion, fills missing entries, and appends a special unmatched AFSC ("*") for
use in optimization logic.</p>
<h4 id="data.processing.import_afscs_data--parameters">Parameters<a class="headerlink" href="#data.processing.import_afscs_data--parameters" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>import_filepaths : dict
  A dictionary of import paths keyed by label (e.g., <code>"AFSCs"</code>). Must contain the key <code>"AFSCs"</code> pointing to
  the location of the AFSCs input CSV file.</p>
</li>
<li>
<p>parameters : dict
  A dictionary of instance-wide input parameters. This will be updated in-place with the AFSC-specific
  parameter values.</p>
</li>
</ul>
<h4 id="data.processing.import_afscs_data--returns">Returns<a class="headerlink" href="#data.processing.import_afscs_data--returns" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>dict
The updated <code>parameters</code> dictionary, now containing keys such as:</p>
</li>
<li>
<p><code>"afscs"</code>: List of AFSC names (plus an unmatched AFSC "*")</p>
</li>
<li><code>"acc_grp"</code>: Accession group categories</li>
<li><code>"afscs_stem"</code>: STEM-designation indicator for each AFSC</li>
<li><code>"quota_d"</code>, <code>"quota_e"</code>, <code>"quota_min"</code>, <code>"quota_max"</code>: Target and constraint bounds</li>
<li><code>"pgl"</code>: Projected graduation levels for each AFSC</li>
<li><code>"Deg Tiers"</code>: Tiered degree qualification matrix (if present)</li>
</ul>
<h4 id="data.processing.import_afscs_data--notes">Notes<a class="headerlink" href="#data.processing.import_afscs_data--notes" title="Permanent link">&para;</a></h4>
<ul>
<li>All values are loaded as NumPy arrays to facilitate vectorized modeling.</li>
<li>The unmatched AFSC <code>"*"</code> is appended to <code>"afscs"</code> for modeling unmatched cadets.</li>
<li>NaN entries and string "nan" values in the CSV are sanitized to empty strings before processing.</li>
<li>Degree tiers are only added if the <code>"Deg Tier 1"</code> column is present in the CSV.
```</li>
</ul>
<h4 id="data.processing.import_afscs_data--see-also">See Also<a class="headerlink" href="#data.processing.import_afscs_data--see-also" title="Permanent link">&para;</a></h4>
<ul>
<li><a href="../../../afccp/reference/data/processing/#data.processing.initialize_file_information"><code>initialize_file_information</code></a></li>
<li><a href="../../../afccp/reference/globals/#globals.import_csv_data"><code>import_csv_data</code></a></li>
</ul>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">import_afscs_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Imports AFSC-level model input data from CSV and populates the instance parameter dictionary.</span>

<span class="sd">    This function reads the `&quot;AFSCs&quot;` input file (provided via `import_filepaths`) and updates the supplied</span>
<span class="sd">    `parameters` dictionary with structured information for each Air Force Specialty Code (AFSC). These inputs</span>
<span class="sd">    are essential for AFCCP modeling and include AFSC quotas, groupings, tiered degree requirements, and other</span>
<span class="sd">    structural attributes.</span>

<span class="sd">    The function handles type conversion, fills missing entries, and appends a special unmatched AFSC (&quot;*&quot;) for</span>
<span class="sd">    use in optimization logic.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    - import_filepaths : dict</span>
<span class="sd">      A dictionary of import paths keyed by label (e.g., `&quot;AFSCs&quot;`). Must contain the key `&quot;AFSCs&quot;` pointing to</span>
<span class="sd">      the location of the AFSCs input CSV file.</span>

<span class="sd">    - parameters : dict</span>
<span class="sd">      A dictionary of instance-wide input parameters. This will be updated in-place with the AFSC-specific</span>
<span class="sd">      parameter values.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    - dict</span>
<span class="sd">    The updated `parameters` dictionary, now containing keys such as:</span>

<span class="sd">    - `&quot;afscs&quot;`: List of AFSC names (plus an unmatched AFSC &quot;*&quot;)</span>
<span class="sd">    - `&quot;acc_grp&quot;`: Accession group categories</span>
<span class="sd">    - `&quot;afscs_stem&quot;`: STEM-designation indicator for each AFSC</span>
<span class="sd">    - `&quot;quota_d&quot;`, `&quot;quota_e&quot;`, `&quot;quota_min&quot;`, `&quot;quota_max&quot;`: Target and constraint bounds</span>
<span class="sd">    - `&quot;pgl&quot;`: Projected graduation levels for each AFSC</span>
<span class="sd">    - `&quot;Deg Tiers&quot;`: Tiered degree qualification matrix (if present)</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - All values are loaded as NumPy arrays to facilitate vectorized modeling.</span>
<span class="sd">    - The unmatched AFSC `&quot;*&quot;` is appended to `&quot;afscs&quot;` for modeling unmatched cadets.</span>
<span class="sd">    - NaN entries and string &quot;nan&quot; values in the CSV are sanitized to empty strings before processing.</span>
<span class="sd">    - Degree tiers are only added if the `&quot;Deg Tier 1&quot;` column is present in the CSV.</span>
<span class="sd">    ```</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    - [`initialize_file_information`](../../../afccp/reference/data/processing/#data.processing.initialize_file_information)</span>
<span class="sd">    - [`import_csv_data`](../../../afccp/reference/globals/#globals.import_csv_data)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">parameters</span>

    <span class="c1"># Import &#39;AFSCs&#39; dataframe</span>
    <span class="n">afscs_df</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">globals</span><span class="o">.</span><span class="n">import_csv_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">[</span><span class="s2">&quot;AFSCs&quot;</span><span class="p">])</span>

    <span class="c1"># Remove &quot;nans&quot;</span>
    <span class="n">afscs_df</span> <span class="o">=</span> <span class="n">afscs_df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">afscs_df</span> <span class="o">=</span> <span class="n">afscs_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="c1"># Initialize dictionary translating &#39;AFSCs&#39; df columns to their parameter counterparts</span>
    <span class="n">afsc_columns_to_parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;AFSC&quot;</span><span class="p">:</span> <span class="s2">&quot;afscs&quot;</span><span class="p">,</span> <span class="s2">&quot;Accessions Group&quot;</span><span class="p">:</span> <span class="s2">&quot;acc_grp&quot;</span><span class="p">,</span> <span class="s2">&quot;STEM&quot;</span><span class="p">:</span> <span class="s1">&#39;afscs_stem&#39;</span><span class="p">,</span>
                                  <span class="s2">&quot;USAFA Target&quot;</span><span class="p">:</span> <span class="s2">&quot;usafa_quota&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;ROTC Target&quot;</span><span class="p">:</span> <span class="s2">&quot;rotc_quota&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;OTS Target&quot;</span><span class="p">:</span> <span class="s2">&quot;ots_quota&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;PGL Target&quot;</span><span class="p">:</span> <span class="s2">&quot;pgl&quot;</span><span class="p">,</span> <span class="s2">&quot;Estimated&quot;</span><span class="p">:</span> <span class="s2">&quot;quota_e&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;Desired&quot;</span><span class="p">:</span> <span class="s2">&quot;quota_d&quot;</span><span class="p">,</span> <span class="s2">&quot;Min&quot;</span><span class="p">:</span> <span class="s2">&quot;quota_min&quot;</span><span class="p">,</span> <span class="s2">&quot;Max&quot;</span><span class="p">:</span> <span class="s2">&quot;quota_max&quot;</span><span class="p">,</span>
                                  <span class="s1">&#39;Max (Bubbles)&#39;</span><span class="p">:</span> <span class="s1">&#39;max_bubbles&#39;</span><span class="p">,</span>
                                  <span class="s2">&quot;Assign Base&quot;</span><span class="p">:</span> <span class="s1">&#39;afsc_assign_base&#39;</span><span class="p">,</span> <span class="s1">&#39;Num Courses&#39;</span><span class="p">:</span> <span class="s1">&#39;T&#39;</span><span class="p">}</span>

    <span class="c1"># Loop through each column in the &#39;AFSCs&#39; dataframe to put it into the p dictionary</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">afscs_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

        <span class="c1"># If the column is an instance parameter, we load it in as a numpy array</span>
        <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">afsc_columns_to_parameters</span><span class="p">:</span>
            <span class="n">p_name</span> <span class="o">=</span> <span class="n">afsc_columns_to_parameters</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
            <span class="n">p</span><span class="p">[</span><span class="n">p_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">afscs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">col</span><span class="p">])</span>

    <span class="c1"># Number of AFSCs</span>
    <span class="n">p</span><span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;afscs&quot;</span><span class="p">])</span>

    <span class="c1"># Add an &quot;*&quot; to the list of AFSCs to be considered the &quot;Unmatched AFSC&quot;</span>
    <span class="n">p</span><span class="p">[</span><span class="s2">&quot;afscs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;afscs&quot;</span><span class="p">],</span> <span class="s2">&quot;*&quot;</span><span class="p">))</span>

    <span class="c1"># Get the degree tier information from the AFSCs</span>
    <span class="k">if</span> <span class="s2">&quot;Deg Tier 1&quot;</span> <span class="ow">in</span> <span class="n">afscs_df</span><span class="p">:</span>
        <span class="n">p</span><span class="p">[</span><span class="s2">&quot;Deg Tiers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">afscs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;Deg Tier 1&quot;</span><span class="p">:</span> <span class="s2">&quot;Deg Tier 4&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

    <span class="c1"># Return parameters dictionary</span>
    <span class="k">return</span> <span class="n">p</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="data.processing.import_cadets_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">import_cadets_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span></code>

<a href="#data.processing.import_cadets_data" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Imports Cadet-level model input data from CSV and populates the instance parameter dictionary.</p>
<p>This function reads the <code>"Cadets"</code> CSV file specified in <code>import_filepaths</code> and extracts relevant demographic,
qualification, preference, training, and weighting information for each cadet. It populates the provided
<code>parameters</code> dictionary with this structured data, including derived quantities like total cadet count,
preference matrix dimensions, and accession source types (SOCs).</p>
<h4 id="data.processing.import_cadets_data--parameters">Parameters<a class="headerlink" href="#data.processing.import_cadets_data--parameters" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>import_filepaths : dict
  Dictionary of import paths keyed by label. Must contain the key <code>"Cadets"</code> pointing to the cadet input CSV path.</p>
</li>
<li>
<p>parameters : dict
  Dictionary of instance-level parameters. This dictionary will be updated in-place with cadet-related entries.</p>
</li>
</ul>
<h4 id="data.processing.import_cadets_data--returns">Returns<a class="headerlink" href="#data.processing.import_cadets_data--returns" title="Permanent link">&para;</a></h4>
<p>dict
The updated <code>parameters</code> dictionary, now containing cadet-specific fields such as:</p>
<ul>
<li><code>"cadets"</code>, <code>"merit"</code>, <code>"assigned"</code>, <code>"asc1"</code>/<code>"asc2"</code>, <code>"cip1"</code>/<code>"cip2"</code> (basic identifiers)</li>
<li><code>"usafa"</code>, <code>"soc"</code>, <code>"minority"</code>, <code>"race"</code>, <code>"ethnicity"</code> (demographic data)</li>
<li><code>"must_match"</code> (AFSCs that must be assigned)</li>
<li><code>"c_preferences"</code>: Preference matrix (N x P) where N = cadets, P = preference slots</li>
<li><code>"c_utilities"</code>: Utility matrix (N x U), where U = min(P, 10)</li>
<li><code>"SOCs"</code>: List of accession sources present in this instance (e.g., <code>["usafa", "rotc"]</code>)</li>
<li><code>"training_start"</code>, <code>"training_preferences"</code>, <code>"training_threshold"</code> (training pipeline values)</li>
<li><code>"weight_afsc"</code>, <code>"weight_base"</code>, <code>"weight_course"</code> (objective weights)</li>
</ul>
<h4 id="data.processing.import_cadets_data--notes">Notes<a class="headerlink" href="#data.processing.import_cadets_data--notes" title="Permanent link">&para;</a></h4>
<ul>
<li>NaN or string 'nan' entries in the CSV are automatically sanitized.</li>
<li>Extra care is taken to remove BOM characters (e.g., <code>"√Ø¬ª¬ø"</code>) in CSV headers.</li>
<li>Preferences are detected using any column starting with <code>"Pref_"</code>, and corresponding utilities from <code>"Util_1"</code> onward.</li>
<li>SOCs must be one of <code>"USAFA"</code>, <code>"ROTC"</code>, or <code>"OTS"</code>; any other value will raise an error.</li>
<li>This function calls <code>gather_degree_tier_qual_matrix()</code> to supplement qualification mappings.</li>
</ul>
<h4 id="data.processing.import_cadets_data--see-also">See Also<a class="headerlink" href="#data.processing.import_cadets_data--see-also" title="Permanent link">&para;</a></h4>
<ul>
<li><a href="../../../afccp/reference/data/processing/#data.processing.initialize_file_information"><code>initialize_file_information</code></a></li>
<li><a href="../../../afccp/reference/data/adjustments/#data.adjustments.gather_degree_tier_qual_matrix"><code>gather_degree_tier_qual_matrix</code></a></li>
</ul>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">import_cadets_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Imports Cadet-level model input data from CSV and populates the instance parameter dictionary.</span>

<span class="sd">    This function reads the `&quot;Cadets&quot;` CSV file specified in `import_filepaths` and extracts relevant demographic,</span>
<span class="sd">    qualification, preference, training, and weighting information for each cadet. It populates the provided</span>
<span class="sd">    `parameters` dictionary with this structured data, including derived quantities like total cadet count,</span>
<span class="sd">    preference matrix dimensions, and accession source types (SOCs).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    - import_filepaths : dict</span>
<span class="sd">      Dictionary of import paths keyed by label. Must contain the key `&quot;Cadets&quot;` pointing to the cadet input CSV path.</span>

<span class="sd">    - parameters : dict</span>
<span class="sd">      Dictionary of instance-level parameters. This dictionary will be updated in-place with cadet-related entries.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">    The updated `parameters` dictionary, now containing cadet-specific fields such as:</span>

<span class="sd">    - `&quot;cadets&quot;`, `&quot;merit&quot;`, `&quot;assigned&quot;`, `&quot;asc1&quot;`/`&quot;asc2&quot;`, `&quot;cip1&quot;`/`&quot;cip2&quot;` (basic identifiers)</span>
<span class="sd">    - `&quot;usafa&quot;`, `&quot;soc&quot;`, `&quot;minority&quot;`, `&quot;race&quot;`, `&quot;ethnicity&quot;` (demographic data)</span>
<span class="sd">    - `&quot;must_match&quot;` (AFSCs that must be assigned)</span>
<span class="sd">    - `&quot;c_preferences&quot;`: Preference matrix (N x P) where N = cadets, P = preference slots</span>
<span class="sd">    - `&quot;c_utilities&quot;`: Utility matrix (N x U), where U = min(P, 10)</span>
<span class="sd">    - `&quot;SOCs&quot;`: List of accession sources present in this instance (e.g., `[&quot;usafa&quot;, &quot;rotc&quot;]`)</span>
<span class="sd">    - `&quot;training_start&quot;`, `&quot;training_preferences&quot;`, `&quot;training_threshold&quot;` (training pipeline values)</span>
<span class="sd">    - `&quot;weight_afsc&quot;`, `&quot;weight_base&quot;`, `&quot;weight_course&quot;` (objective weights)</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - NaN or string &#39;nan&#39; entries in the CSV are automatically sanitized.</span>
<span class="sd">    - Extra care is taken to remove BOM characters (e.g., `&quot;√Ø¬ª¬ø&quot;`) in CSV headers.</span>
<span class="sd">    - Preferences are detected using any column starting with `&quot;Pref_&quot;`, and corresponding utilities from `&quot;Util_1&quot;` onward.</span>
<span class="sd">    - SOCs must be one of `&quot;USAFA&quot;`, `&quot;ROTC&quot;`, or `&quot;OTS&quot;`; any other value will raise an error.</span>
<span class="sd">    - This function calls `gather_degree_tier_qual_matrix()` to supplement qualification mappings.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    - [`initialize_file_information`](../../../afccp/reference/data/processing/#data.processing.initialize_file_information)</span>
<span class="sd">    - [`gather_degree_tier_qual_matrix`](../../../afccp/reference/data/adjustments/#data.adjustments.gather_degree_tier_qual_matrix)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">parameters</span>

    <span class="c1"># Import &#39;Cadets&#39; dataframe</span>
    <span class="n">cadets_df</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">globals</span><span class="o">.</span><span class="n">import_csv_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">[</span><span class="s2">&quot;Cadets&quot;</span><span class="p">])</span>

    <span class="c1"># Initialize dictionary translating &#39;AFSCs&#39; df columns to their parameter counterparts</span>
    <span class="n">cadet_columns_to_parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Cadet&quot;</span><span class="p">:</span> <span class="s2">&quot;cadets&quot;</span><span class="p">,</span> <span class="s1">&#39;Male&#39;</span><span class="p">:</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="s1">&#39;Minority&#39;</span><span class="p">:</span> <span class="s1">&#39;minority&#39;</span><span class="p">,</span> <span class="s1">&#39;Race&#39;</span><span class="p">:</span> <span class="s1">&#39;race&#39;</span><span class="p">,</span>
                                   <span class="s2">&quot;Ethnicity&quot;</span><span class="p">:</span> <span class="s2">&quot;ethnicity&quot;</span><span class="p">,</span> <span class="s1">&#39;USAFA&#39;</span><span class="p">:</span> <span class="s1">&#39;usafa&#39;</span><span class="p">,</span> <span class="s1">&#39;SOC&#39;</span><span class="p">:</span> <span class="s1">&#39;soc&#39;</span><span class="p">,</span>
                                   <span class="s2">&quot;Must Match&quot;</span><span class="p">:</span> <span class="s2">&quot;must_match&quot;</span><span class="p">,</span>
                                   <span class="s1">&#39;ASC1&#39;</span><span class="p">:</span> <span class="s1">&#39;asc1&#39;</span><span class="p">,</span> <span class="s1">&#39;ASC2&#39;</span><span class="p">:</span> <span class="s1">&#39;asc2&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;CIP1&#39;</span><span class="p">:</span> <span class="s1">&#39;cip1&#39;</span><span class="p">,</span> <span class="s1">&#39;CIP2&#39;</span><span class="p">:</span> <span class="s1">&#39;cip2&#39;</span><span class="p">,</span> <span class="s1">&#39;Merit&#39;</span><span class="p">:</span> <span class="s1">&#39;merit&#39;</span><span class="p">,</span> <span class="s1">&#39;Real Merit&#39;</span><span class="p">:</span> <span class="s1">&#39;merit_all&#39;</span><span class="p">,</span>
                                   <span class="s2">&quot;Assigned&quot;</span><span class="p">:</span> <span class="s2">&quot;assigned&quot;</span><span class="p">,</span> <span class="s2">&quot;STEM&quot;</span><span class="p">:</span> <span class="s2">&quot;stem&quot;</span><span class="p">,</span> <span class="s2">&quot;Accessions Group&quot;</span><span class="p">:</span> <span class="s2">&quot;acc_grp_constraint&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;SF OM&quot;</span><span class="p">:</span> <span class="s2">&quot;sf_om&quot;</span><span class="p">,</span> <span class="s1">&#39;Start Date&#39;</span><span class="p">:</span> <span class="s1">&#39;training_start&#39;</span><span class="p">,</span> <span class="s1">&#39;Start Pref&#39;</span><span class="p">:</span> <span class="s1">&#39;training_preferences&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;Base Threshold&#39;</span><span class="p">:</span> <span class="s1">&#39;base_threshold&#39;</span><span class="p">,</span> <span class="s1">&#39;Course Threshold&#39;</span><span class="p">:</span> <span class="s1">&#39;training_threshold&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;AFSC Weight&#39;</span><span class="p">:</span> <span class="s1">&#39;weight_afsc&#39;</span><span class="p">,</span> <span class="s1">&#39;Base Weight&#39;</span><span class="p">:</span> <span class="s1">&#39;weight_base&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;Course Weight&#39;</span><span class="p">:</span> <span class="s1">&#39;weight_course&#39;</span><span class="p">,</span> <span class="s1">&#39;Least Desired AFSC&#39;</span><span class="p">:</span> <span class="s1">&#39;last_afsc&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;Second Least Desired AFSCs&#39;</span><span class="p">:</span> <span class="s1">&#39;second_to_last_afscs&#39;</span><span class="p">}</span>

    <span class="c1"># Loop through each column in the &#39;Cadets&#39; dataframe to put it into the p dictionary</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cadets_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

        <span class="c1"># Weird characters showing up</span>
        <span class="k">if</span> <span class="s2">&quot;√Ø¬ª¬ø&quot;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">:</span>
            <span class="n">col_name</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;√Ø¬ª¬ø&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">col_name</span> <span class="o">=</span> <span class="n">col</span>

        <span class="c1"># If the column is an instance parameter, we load it in as a numpy array</span>
        <span class="k">if</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="n">cadet_columns_to_parameters</span><span class="p">:</span>
            <span class="n">p_name</span> <span class="o">=</span> <span class="n">cadet_columns_to_parameters</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span>
            <span class="n">p</span><span class="p">[</span><span class="n">p_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cadets_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">col</span><span class="p">])</span>

    <span class="c1"># Number of Cadets</span>
    <span class="n">p</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;cadets&quot;</span><span class="p">])</span>

    <span class="c1"># Get qual matrix information</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">adjustments</span><span class="o">.</span><span class="n">gather_degree_tier_qual_matrix</span><span class="p">(</span><span class="n">cadets_df</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

    <span class="c1"># Number of cadet preference choices available and number of utilities available</span>
    <span class="n">p</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cadets_df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s1">&#39;Pref_&#39;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">])</span>
    <span class="n">p</span><span class="p">[</span><span class="s2">&quot;num_util&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>

        <span class="c1"># Get the preferences and utilities columns from the cadets dataframe</span>
        <span class="n">p</span><span class="p">[</span><span class="s2">&quot;c_preferences&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cadets_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;Pref_1&quot;</span><span class="p">:</span> <span class="s2">&quot;Pref_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">])])</span>
        <span class="n">p</span><span class="p">[</span><span class="s2">&quot;c_utilities&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cadets_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;Util_1&quot;</span><span class="p">:</span> <span class="s2">&quot;Util_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;num_util&quot;</span><span class="p">])])</span>

    <span class="c1"># Determine which SOCs are in this instance</span>
    <span class="k">if</span> <span class="s1">&#39;soc&#39;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
        <span class="n">unique_socs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;soc&#39;</span><span class="p">])</span>  <span class="c1"># Get unique list of SOCs</span>

        <span class="c1"># This just gets the SOCs in the right order</span>
        <span class="n">soc_options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;USAFA&#39;</span><span class="p">,</span> <span class="s1">&#39;ROTC&#39;</span><span class="p">,</span> <span class="s1">&#39;OTS&#39;</span><span class="p">]</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;SOCs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">soc</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">soc</span> <span class="ow">in</span> <span class="n">soc_options</span> <span class="k">if</span> <span class="n">soc</span> <span class="ow">in</span> <span class="n">unique_socs</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">soc</span> <span class="ow">in</span> <span class="n">unique_socs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">soc</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">soc_options</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;SOC </span><span class="si">{</span><span class="n">soc</span><span class="si">}</span><span class="s1"> not recognized as valid SOC option! At least one cadet has it.&#39;</span><span class="p">)</span>

    <span class="c1"># Return parameters dictionary</span>
    <span class="k">return</span> <span class="n">p</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="data.processing.import_afsc_cadet_matrices_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">import_afsc_cadet_matrices_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span></code>

<a href="#data.processing.import_afsc_cadet_matrices_data" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Imports optional AFSC-cadet interaction matrices and updates the instance parameter dictionary accordingly.</p>
<p>This function augments the core cadet and AFSC input data by importing preference matrices, utility matrices,
and supplemental rated-selection files (if available). The imported data enables more advanced modeling of
cadet-AFSC interactions including two-sided preferences and selection boards.</p>
<h4 id="data.processing.import_afsc_cadet_matrices_data--parameters">Parameters<a class="headerlink" href="#data.processing.import_afsc_cadet_matrices_data--parameters" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>import_filepaths : dict
    Dictionary of filepaths keyed by dataset name. Recognized keys include:</p>
<ul>
<li><code>"Cadets Utility"</code></li>
<li><code>"Cadets Preferences"</code></li>
<li><code>"AFSCs Utility"</code></li>
<li><code>"AFSCs Preferences"</code></li>
<li><code>"Cadets Utility (Final)"</code></li>
<li><code>"Cadets Selected"</code></li>
<li><code>"AFSCs Buckets"</code></li>
<li><code>"ROTC Rated Interest"</code>, <code>"ROTC Rated OM"</code>, <code>"USAFA Rated OM"</code>, <code>"OTS Rated OM"</code></li>
</ul>
</li>
<li>
<p>parameters : dict
    Dictionary of model instance parameters. Must contain:</p>
<ul>
<li><code>"afscs"</code>: array of AFSC names</li>
<li><code>"N"</code>: number of cadets</li>
<li><code>"M"</code>: number of AFSCs</li>
<li><code>"num_util"</code>: number of utility entries per cadet</li>
<li><code>"P"</code>: number of preferences</li>
</ul>
</li>
</ul>
<h4 id="data.processing.import_afsc_cadet_matrices_data--returns">Returns<a class="headerlink" href="#data.processing.import_afsc_cadet_matrices_data--returns" title="Permanent link">&para;</a></h4>
<p>dict
Updated parameter dictionary with new keys (if data was provided), including:</p>
<ul>
<li><code>"utility"</code>: cadet utility matrix (N x M)</li>
<li><code>"c_pref_matrix"</code>: cadet preference rankings (N x M, integer-valued, 1 = top choice)</li>
<li><code>"afsc_utility"</code>: AFSC utility matrix (M x M)</li>
<li><code>"a_pref_matrix"</code>: AFSC preference rankings (M x M)</li>
<li><code>"cadet_utility"</code>: final cadet utility matrix (N x M)</li>
<li><code>"c_selected_matrix"</code>: matrix of cadets selected by AFSCs (N x M)</li>
<li><code>"a_bucket_matrix"</code>: bucketing of AFSCs for visualization or selection (M x M)</li>
<li><code>"rr_interest_matrix"</code>, <code>"rr_om_matrix"</code>, <code>"rr_om_cadets"</code>: ROTC board data</li>
<li><code>"ur_om_matrix"</code>, <code>"ur_om_cadets"</code>: USAFA board data</li>
<li><code>"or_om_matrix"</code>, <code>"or_om_cadets"</code>: OTS board data</li>
<li><code>"usafa_cadets"</code>: indices of USAFA cadets in the instance</li>
</ul>
<h4 id="data.processing.import_afsc_cadet_matrices_data--raises">Raises<a class="headerlink" href="#data.processing.import_afsc_cadet_matrices_data--raises" title="Permanent link">&para;</a></h4>
<p>ValueError
  If neither <code>"Cadets Utility"</code> nor <code>"c_utilities"</code> are provided in the inputs, since cadet utility data is required.</p>
<h4 id="data.processing.import_afsc_cadet_matrices_data--notes">Notes<a class="headerlink" href="#data.processing.import_afsc_cadet_matrices_data--notes" title="Permanent link">&para;</a></h4>
<ul>
<li>This function assumes the <code>"Cadets"</code> and <code>"AFSCs"</code> CSVs have already been processed.</li>
<li>If raw preferences/utilities are not explicitly imported, they are reconstructed from <code>c_preferences</code> and <code>c_utilities</code>.</li>
<li>Preference ranks use integers where <code>1</code> is most preferred (not <code>0</code>).</li>
<li>Utility matrices are aligned by the order of <code>p["afscs"]</code> and not by the file column order alone.</li>
<li>AFSC utility and preference data are optional but support two-sided matching or board processes.</li>
<li>Rated OM/Interest files enable specialty-specific board logic for each SOC.</li>
</ul>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">import_afsc_cadet_matrices_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Imports optional AFSC-cadet interaction matrices and updates the instance parameter dictionary accordingly.</span>

<span class="sd">    This function augments the core cadet and AFSC input data by importing preference matrices, utility matrices,</span>
<span class="sd">    and supplemental rated-selection files (if available). The imported data enables more advanced modeling of</span>
<span class="sd">    cadet-AFSC interactions including two-sided preferences and selection boards.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    - import_filepaths : dict</span>
<span class="sd">        Dictionary of filepaths keyed by dataset name. Recognized keys include:</span>

<span class="sd">        - `&quot;Cadets Utility&quot;`</span>
<span class="sd">        - `&quot;Cadets Preferences&quot;`</span>
<span class="sd">        - `&quot;AFSCs Utility&quot;`</span>
<span class="sd">        - `&quot;AFSCs Preferences&quot;`</span>
<span class="sd">        - `&quot;Cadets Utility (Final)&quot;`</span>
<span class="sd">        - `&quot;Cadets Selected&quot;`</span>
<span class="sd">        - `&quot;AFSCs Buckets&quot;`</span>
<span class="sd">        - `&quot;ROTC Rated Interest&quot;`, `&quot;ROTC Rated OM&quot;`, `&quot;USAFA Rated OM&quot;`, `&quot;OTS Rated OM&quot;`</span>

<span class="sd">    - parameters : dict</span>
<span class="sd">        Dictionary of model instance parameters. Must contain:</span>

<span class="sd">        - `&quot;afscs&quot;`: array of AFSC names</span>
<span class="sd">        - `&quot;N&quot;`: number of cadets</span>
<span class="sd">        - `&quot;M&quot;`: number of AFSCs</span>
<span class="sd">        - `&quot;num_util&quot;`: number of utility entries per cadet</span>
<span class="sd">        - `&quot;P&quot;`: number of preferences</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">    Updated parameter dictionary with new keys (if data was provided), including:</span>

<span class="sd">    - `&quot;utility&quot;`: cadet utility matrix (N x M)</span>
<span class="sd">    - `&quot;c_pref_matrix&quot;`: cadet preference rankings (N x M, integer-valued, 1 = top choice)</span>
<span class="sd">    - `&quot;afsc_utility&quot;`: AFSC utility matrix (M x M)</span>
<span class="sd">    - `&quot;a_pref_matrix&quot;`: AFSC preference rankings (M x M)</span>
<span class="sd">    - `&quot;cadet_utility&quot;`: final cadet utility matrix (N x M)</span>
<span class="sd">    - `&quot;c_selected_matrix&quot;`: matrix of cadets selected by AFSCs (N x M)</span>
<span class="sd">    - `&quot;a_bucket_matrix&quot;`: bucketing of AFSCs for visualization or selection (M x M)</span>
<span class="sd">    - `&quot;rr_interest_matrix&quot;`, `&quot;rr_om_matrix&quot;`, `&quot;rr_om_cadets&quot;`: ROTC board data</span>
<span class="sd">    - `&quot;ur_om_matrix&quot;`, `&quot;ur_om_cadets&quot;`: USAFA board data</span>
<span class="sd">    - `&quot;or_om_matrix&quot;`, `&quot;or_om_cadets&quot;`: OTS board data</span>
<span class="sd">    - `&quot;usafa_cadets&quot;`: indices of USAFA cadets in the instance</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">      If neither `&quot;Cadets Utility&quot;` nor `&quot;c_utilities&quot;` are provided in the inputs, since cadet utility data is required.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - This function assumes the `&quot;Cadets&quot;` and `&quot;AFSCs&quot;` CSVs have already been processed.</span>
<span class="sd">    - If raw preferences/utilities are not explicitly imported, they are reconstructed from `c_preferences` and `c_utilities`.</span>
<span class="sd">    - Preference ranks use integers where `1` is most preferred (not `0`).</span>
<span class="sd">    - Utility matrices are aligned by the order of `p[&quot;afscs&quot;]` and not by the file column order alone.</span>
<span class="sd">    - AFSC utility and preference data are optional but support two-sided matching or board processes.</span>
<span class="sd">    - Rated OM/Interest files enable specialty-specific board logic for each SOC.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">parameters</span>

    <span class="c1"># Loop through the potential additional dataframes and import them if we have them</span>
    <span class="n">datasets</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Cadets Utility&quot;</span><span class="p">,</span> <span class="s2">&quot;Cadets Preferences&quot;</span><span class="p">,</span> <span class="s2">&quot;AFSCs Utility&quot;</span><span class="p">,</span> <span class="s2">&quot;AFSCs Preferences&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;ROTC Rated Interest&quot;</span><span class="p">,</span> <span class="s2">&quot;ROTC Rated OM&quot;</span><span class="p">,</span> <span class="s2">&quot;USAFA Rated OM&quot;</span><span class="p">,</span> <span class="s2">&quot;OTS Rated OM&quot;</span><span class="p">,</span> <span class="s1">&#39;Cadets Utility (Final)&#39;</span><span class="p">,</span>
                    <span class="s2">&quot;Cadets Selected&quot;</span><span class="p">,</span> <span class="s2">&quot;AFSCs Buckets&quot;</span><span class="p">]:</span>

        <span class="c1"># If we have the dataset, import it</span>
        <span class="k">if</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">import_filepaths</span><span class="p">:</span>
            <span class="n">datasets</span><span class="p">[</span><span class="n">dataset</span><span class="p">]</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">globals</span><span class="o">.</span><span class="n">import_csv_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">[</span><span class="n">dataset</span><span class="p">])</span>

    <span class="c1"># First and last AFSC (for collecting matrices from dataframes)</span>
    <span class="n">afsc_1</span><span class="p">,</span> <span class="n">afsc_M</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;afscs&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;afscs&quot;</span><span class="p">][</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Load in extra dataframes</span>
    <span class="k">for</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;Cadets Selected&#39;</span><span class="p">:</span> <span class="s1">&#39;c_selected_matrix&#39;</span><span class="p">,</span> <span class="s1">&#39;AFSCs Buckets&#39;</span><span class="p">:</span> <span class="s1">&#39;a_bucket_matrix&#39;</span><span class="p">}</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>
            <span class="n">p</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="n">dataset</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">afsc_1</span><span class="p">:</span> <span class="n">afsc_M</span><span class="p">])</span>

    <span class="c1"># Determine how we incorporate the original cadets&#39; utility matrix</span>
    <span class="k">if</span> <span class="s2">&quot;Cadets Utility&quot;</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>  <span class="c1"># Load in the matrix directly</span>
        <span class="n">p</span><span class="p">[</span><span class="s2">&quot;utility&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;Cadets Utility&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">afsc_1</span><span class="p">:</span> <span class="n">afsc_M</span><span class="p">])</span>
    <span class="k">elif</span> <span class="s2">&quot;c_utilities&quot;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>  <span class="c1"># Create the matrix using the columns</span>

        <span class="c1"># Create utility matrix (numpy array NxM) from the utility/preference column information</span>
        <span class="n">p</span><span class="p">[</span><span class="s2">&quot;utility&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">]])</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">]):</span>
            <span class="k">for</span> <span class="n">util</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;num_util&#39;</span><span class="p">]):</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;c_preferences&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">util</span><span class="p">]</span> <span class="o">==</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;afscs&quot;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">p</span><span class="p">[</span><span class="s1">&#39;utility&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;c_utilities&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">util</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error. No cadet utility data provided which is required.&quot;</span><span class="p">)</span>

    <span class="c1"># Cadets &quot;Real&quot; Utility (after aggregating it with their ordinal rankings)</span>
    <span class="k">if</span> <span class="s1">&#39;Cadets Utility (Final)&#39;</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>  <span class="c1"># Load in the cadet utility matrix</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadet_utility&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;Cadets Utility (Final)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">afsc_1</span><span class="p">:</span> <span class="n">afsc_M</span><span class="p">])</span>

    <span class="c1"># Determine how we incorporate the cadets&#39; preferences dataframe</span>
    <span class="k">if</span> <span class="s2">&quot;Cadets Preferences&quot;</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>  <span class="c1"># Load in the preferences dataframe directly</span>
        <span class="n">p</span><span class="p">[</span><span class="s2">&quot;c_pref_matrix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;Cadets Preferences&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">afsc_1</span><span class="p">:</span> <span class="n">afsc_M</span><span class="p">])</span>
    <span class="k">elif</span> <span class="s2">&quot;c_preferences&quot;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>  <span class="c1"># Create the preferences dataframe using the columns</span>

        <span class="c1"># Create cadet preferences dataframe (numpy array NxM) from the preference column information</span>
        <span class="n">p</span><span class="p">[</span><span class="s2">&quot;c_pref_matrix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">]])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">]):</span>
            <span class="k">for</span> <span class="n">util</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">]):</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;c_preferences&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">util</span><span class="p">]</span> <span class="o">==</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;afscs&quot;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">p</span><span class="p">[</span><span class="s1">&#39;c_pref_matrix&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">util</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># 1 is first choice (NOT 0)</span>

    <span class="c1"># AFSC preferences and utilities are not required initial data elements (Depending on how we solve, they may be)</span>
    <span class="k">if</span> <span class="s2">&quot;AFSCs Utility&quot;</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>  <span class="c1"># Load in the AFSC utility matrix</span>
        <span class="n">p</span><span class="p">[</span><span class="s2">&quot;afsc_utility&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;AFSCs Utility&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">afsc_1</span><span class="p">:</span> <span class="n">afsc_M</span><span class="p">])</span>
    <span class="k">if</span> <span class="s2">&quot;AFSCs Preferences&quot;</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>  <span class="c1"># Load in the AFSC preferences dataframe</span>
        <span class="n">p</span><span class="p">[</span><span class="s2">&quot;a_pref_matrix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;AFSCs Preferences&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">afsc_1</span><span class="p">:</span> <span class="n">afsc_M</span><span class="p">])</span>

    <span class="c1"># All USAFA Cadets</span>
    <span class="n">p</span><span class="p">[</span><span class="s1">&#39;usafa_cadets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;usafa&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Rated dataframes</span>
    <span class="k">if</span> <span class="s2">&quot;ROTC Rated Interest&quot;</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>
        <span class="n">r_afscs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;ROTC Rated Interest&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;rr_interest_matrix&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;ROTC Rated Interest&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">r_afscs</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">r_afscs</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">r_afscs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]])</span>
    <span class="k">if</span> <span class="s2">&quot;ROTC Rated OM&quot;</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>
        <span class="n">r_afscs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;ROTC Rated OM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;rr_om_matrix&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;ROTC Rated OM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">r_afscs</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">r_afscs</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">r_afscs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]])</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;rr_om_cadets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;ROTC Rated OM&#39;</span><span class="p">][</span><span class="s1">&#39;Cadet&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="s2">&quot;USAFA Rated OM&quot;</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>
        <span class="n">r_afscs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;USAFA Rated OM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;ur_om_matrix&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;USAFA Rated OM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">r_afscs</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">r_afscs</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">r_afscs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]])</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;ur_om_cadets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;USAFA Rated OM&#39;</span><span class="p">][</span><span class="s1">&#39;Cadet&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="s2">&quot;OTS Rated OM&quot;</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>
        <span class="n">r_afscs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;OTS Rated OM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;or_om_matrix&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;OTS Rated OM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">r_afscs</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">r_afscs</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">r_afscs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]])</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;or_om_cadets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;OTS Rated OM&#39;</span><span class="p">][</span><span class="s1">&#39;Cadet&#39;</span><span class="p">])</span>

    <span class="c1"># Return dictionary of parameters</span>
    <span class="k">return</span> <span class="n">p</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="data.processing.import_value_parameters_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">import_value_parameters_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">num_breakpoints</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span></code>

<a href="#data.processing.import_value_parameters_data" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Imports and constructs value parameter sets for the model based on CSV definitions and analyst-defined breakpoints.</p>
<p>This function reads and compiles all information associated with value-based decision modeling, including
objective functions, breakpoints, weights, and value constraints for both cadets and AFSCs. It supports multiple
sets of value parameters, each potentially with different assumptions or constraints.</p>
<h4 id="data.processing.import_value_parameters_data--parameters">Parameters<a class="headerlink" href="#data.processing.import_value_parameters_data--parameters" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>import_filepaths : dict
  Dictionary containing paths to relevant files. Required keys:</p>
<ul>
<li><code>"Model Input"</code>: folder path containing individual VP set CSVs.</li>
<li><code>"Value Parameters"</code>: CSV listing metadata about each VP set.
Optional keys:</li>
<li><code>"Cadets Utility Constraints"</code>: file containing minimum cadet utility constraints by VP set.</li>
</ul>
</li>
<li>
<p>parameters : dict
  Instance parameter dictionary already populated with <code>"M"</code>, <code>"N"</code>, and AFSC/cadet-level arrays.</p>
</li>
<li>
<p>num_breakpoints : int, optional (default=24)
  Number of breakpoints to discretize each value function unless exact breakpoints are provided.</p>
</li>
</ul>
<h4 id="data.processing.import_value_parameters_data--returns">Returns<a class="headerlink" href="#data.processing.import_value_parameters_data--returns" title="Permanent link">&para;</a></h4>
<p>dict
A dictionary keyed by VP set names. Each value is a dictionary of value parameters containing:</p>
<ul>
<li>Objective definitions and weights</li>
<li>Breakpoints (<code>a</code>) and values (<code>f^hat</code>)</li>
<li>Minimum utility constraints</li>
<li>AFSC objective indexed sets (<code>K^A</code>)</li>
<li><code>cadet_weight</code>, <code>afsc_weight</code>, and associated metadata</li>
<li>VP set weights and local weights for combination logic</li>
</ul>
<h4 id="data.processing.import_value_parameters_data--raises">Raises<a class="headerlink" href="#data.processing.import_value_parameters_data--raises" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>FileNotFoundError
  If required files are missing from the provided import paths.</p>
</li>
<li>
<p>ValueError
  If the <code>"Value Parameters"</code> file is missing or empty.</p>
</li>
</ul>
<h4 id="data.processing.import_value_parameters_data--notes">Notes<a class="headerlink" href="#data.processing.import_value_parameters_data--notes" title="Permanent link">&para;</a></h4>
<ul>
<li>All AFSC objectives are indexed across <code>O</code> objectives per AFSC.</li>
<li>The function automatically parses objective weight strings and reconstructs value functions if needed.</li>
<li>For each VP set listed in the <code>"Value Parameters"</code> file, the function expects a matching CSV file named
  <code>"VP &lt;VP Name&gt;.csv"</code> (e.g., <code>"VP Baseline.csv"</code>).</li>
<li>Supports optional use of <code>"Cadets Utility Constraints"</code> to impose per-cadet minimums.</li>
<li>If <code>num_breakpoints</code> is <code>None</code>, raw a/f^hat arrays are expected instead of constructing from strings.</li>
<li>Value functions are compressed after loading to remove redundant zero segments for performance.</li>
</ul>
<h4 id="data.processing.import_value_parameters_data--see-also">See Also<a class="headerlink" href="#data.processing.import_value_parameters_data--see-also" title="Permanent link">&para;</a></h4>
<ul>
<li><a href="../../../afccp/reference/data/values/#data.values.value_function_builder"><code>value_function_builder</code></a></li>
<li><a href="../../../afccp/reference/data/values/#data.values.create_segment_dict_from_string"><code>create_segment_dict_from_string</code></a></li>
<li><a href="../../../afccp/reference/data/values/#data.values.condense_value_functions"><code>condense_value_functions</code></a></li>
<li><a href="../../../afccp/reference/data/values/#data.values.value_parameters_sets_additions"><code>value_parameters_sets_additions</code></a></li>
</ul>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">import_value_parameters_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">num_breakpoints</span><span class="o">=</span><span class="mi">24</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Imports and constructs value parameter sets for the model based on CSV definitions and analyst-defined breakpoints.</span>

<span class="sd">    This function reads and compiles all information associated with value-based decision modeling, including</span>
<span class="sd">    objective functions, breakpoints, weights, and value constraints for both cadets and AFSCs. It supports multiple</span>
<span class="sd">    sets of value parameters, each potentially with different assumptions or constraints.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    - import_filepaths : dict</span>
<span class="sd">      Dictionary containing paths to relevant files. Required keys:</span>

<span class="sd">        - `&quot;Model Input&quot;`: folder path containing individual VP set CSVs.</span>
<span class="sd">        - `&quot;Value Parameters&quot;`: CSV listing metadata about each VP set.</span>
<span class="sd">        Optional keys:</span>
<span class="sd">        - `&quot;Cadets Utility Constraints&quot;`: file containing minimum cadet utility constraints by VP set.</span>

<span class="sd">    - parameters : dict</span>
<span class="sd">      Instance parameter dictionary already populated with `&quot;M&quot;`, `&quot;N&quot;`, and AFSC/cadet-level arrays.</span>

<span class="sd">    - num_breakpoints : int, optional (default=24)</span>
<span class="sd">      Number of breakpoints to discretize each value function unless exact breakpoints are provided.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">    A dictionary keyed by VP set names. Each value is a dictionary of value parameters containing:</span>

<span class="sd">    - Objective definitions and weights</span>
<span class="sd">    - Breakpoints (`a`) and values (`f^hat`)</span>
<span class="sd">    - Minimum utility constraints</span>
<span class="sd">    - AFSC objective indexed sets (`K^A`)</span>
<span class="sd">    - `cadet_weight`, `afsc_weight`, and associated metadata</span>
<span class="sd">    - VP set weights and local weights for combination logic</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    - FileNotFoundError</span>
<span class="sd">      If required files are missing from the provided import paths.</span>

<span class="sd">    - ValueError</span>
<span class="sd">      If the `&quot;Value Parameters&quot;` file is missing or empty.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - All AFSC objectives are indexed across `O` objectives per AFSC.</span>
<span class="sd">    - The function automatically parses objective weight strings and reconstructs value functions if needed.</span>
<span class="sd">    - For each VP set listed in the `&quot;Value Parameters&quot;` file, the function expects a matching CSV file named</span>
<span class="sd">      `&quot;VP &lt;VP Name&gt;.csv&quot;` (e.g., `&quot;VP Baseline.csv&quot;`).</span>
<span class="sd">    - Supports optional use of `&quot;Cadets Utility Constraints&quot;` to impose per-cadet minimums.</span>
<span class="sd">    - If `num_breakpoints` is `None`, raw a/f^hat arrays are expected instead of constructing from strings.</span>
<span class="sd">    - Value functions are compressed after loading to remove redundant zero segments for performance.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    - [`value_function_builder`](../../../afccp/reference/data/values/#data.values.value_function_builder)</span>
<span class="sd">    - [`create_segment_dict_from_string`](../../../afccp/reference/data/values/#data.values.create_segment_dict_from_string)</span>
<span class="sd">    - [`condense_value_functions`](../../../afccp/reference/data/values/#data.values.condense_value_functions)</span>
<span class="sd">    - [`value_parameters_sets_additions`](../../../afccp/reference/data/values/#data.values.value_parameters_sets_additions)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">parameters</span>
    <span class="n">afccp_vp</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># Reduce the module name so it fits on one line</span>

    <span class="c1"># Import the cadets utility constraints dataframe if we have it.</span>
    <span class="k">if</span> <span class="s2">&quot;Cadets Utility Constraints&quot;</span> <span class="ow">in</span> <span class="n">import_filepaths</span><span class="p">:</span>
        <span class="n">vp_cadet_df</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">globals</span><span class="o">.</span><span class="n">import_csv_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">[</span><span class="s2">&quot;Cadets Utility Constraints&quot;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vp_cadet_df</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Import the &quot;Value Parameters&quot; dataframe if we have it. If we don&#39;t, the &quot;vp_dict&quot; will be &quot;None&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;Value Parameters&quot;</span> <span class="ow">in</span> <span class="n">import_filepaths</span><span class="p">:</span>
        <span class="n">overall_vp_df</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">globals</span><span class="o">.</span><span class="n">import_csv_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">[</span><span class="s2">&quot;Value Parameters&quot;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># Nothing more we can do now (No &quot;Value Parameters&quot; determined yet for this instance)</span>

    <span class="c1"># Information about the sets of value parameters listed in the &quot;Value Parameters&quot; dataframe</span>
    <span class="n">vp_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">overall_vp_df</span><span class="p">[</span><span class="s1">&#39;VP Name&#39;</span><span class="p">])</span>
    <span class="n">num_vps</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vp_names</span><span class="p">)</span>
    <span class="n">vp_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_vps</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>  <span class="c1"># Initially all weighted at 100%</span>
    <span class="k">if</span> <span class="s1">&#39;VP Weight&#39;</span> <span class="ow">in</span> <span class="n">overall_vp_df</span><span class="p">:</span>
        <span class="n">vp_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">overall_vp_df</span><span class="p">[</span><span class="s1">&#39;VP Weight&#39;</span><span class="p">])</span>

    <span class="c1"># Determine the filenames for the sets of value parameters (VP, VP_2, etc.)</span>
    <span class="n">vp_files</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">[</span><span class="s2">&quot;Model Input&quot;</span><span class="p">]):</span>
        <span class="k">if</span> <span class="s2">&quot;.csv&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">check_vp</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">check_vp</span> <span class="ow">in</span> <span class="n">vp_names</span> <span class="ow">and</span> <span class="s2">&quot;Utility&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>  <span class="c1"># Don&#39;t want VP Global Utility included here</span>
            <span class="n">vp_files</span><span class="p">[</span><span class="n">check_vp</span><span class="p">]</span> <span class="o">=</span> <span class="n">file</span>

    <span class="c1"># Loop through each set of value parameters and load it into the dictionary</span>
    <span class="n">vp_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">vp_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vp_names</span><span class="p">):</span>

        <span class="c1"># Only load in the set of value parameters if we have it</span>
        <span class="k">if</span> <span class="n">vp_name</span> <span class="ow">in</span> <span class="n">vp_files</span><span class="p">:</span>
            <span class="n">filepath</span> <span class="o">=</span> <span class="n">import_filepaths</span><span class="p">[</span><span class="s2">&quot;Model Input&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">vp_files</span><span class="p">[</span><span class="n">vp_name</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING. Value Parameter set &#39;&quot;</span> <span class="o">+</span> <span class="n">vp_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; listed in the &#39;Value Parameters&#39; dataframe but does&quot;</span>
                                                               <span class="s2">&quot; not have its own dataframe (.csv) in &#39;Model Inputs&#39;.&quot;</span><span class="p">)</span>
            <span class="k">continue</span>  <span class="c1"># Skip this set of value parameters</span>

        <span class="c1"># Load value parameter set dataframe</span>
        <span class="n">vp_df</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">globals</span><span class="o">.</span><span class="n">import_csv_data</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
        <span class="n">M</span><span class="p">,</span> <span class="n">O</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vp_df</span><span class="p">)</span> <span class="o">/</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">])</span>  <span class="c1"># Number of AFSCs (M) and number of AFSC objectives (O)</span>

        <span class="c1"># Initialize value parameters dictionary</span>
        <span class="n">value_parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="n">O</span><span class="p">,</span> <span class="s2">&quot;afscs_overall_weight&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">overall_vp_df</span><span class="p">[</span><span class="s1">&#39;AFSCs Weight&#39;</span><span class="p">])[</span><span class="n">v</span><span class="p">],</span>
                            <span class="s2">&quot;cadets_overall_weight&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">overall_vp_df</span><span class="p">[</span><span class="s1">&#39;Cadets Weight&#39;</span><span class="p">])[</span><span class="n">v</span><span class="p">],</span>
                            <span class="s2">&quot;cadet_weight_function&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">overall_vp_df</span><span class="p">[</span><span class="s1">&#39;Cadet Weight Function&#39;</span><span class="p">])[</span><span class="n">v</span><span class="p">],</span>
                            <span class="s2">&quot;afsc_weight_function&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">overall_vp_df</span><span class="p">[</span><span class="s1">&#39;AFSC Weight Function&#39;</span><span class="p">])[</span><span class="n">v</span><span class="p">],</span>
                            <span class="s2">&quot;cadets_overall_value_min&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">overall_vp_df</span><span class="p">[</span><span class="s1">&#39;Cadets Min Value&#39;</span><span class="p">])[</span><span class="n">v</span><span class="p">],</span>
                            <span class="s2">&quot;afscs_overall_value_min&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">overall_vp_df</span><span class="p">[</span><span class="s1">&#39;AFSCs Min Value&#39;</span><span class="p">])[</span><span class="n">v</span><span class="p">],</span> <span class="s2">&quot;M&quot;</span><span class="p">:</span> <span class="n">M</span><span class="p">,</span>
                            <span class="s2">&quot;afsc_value_min&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">M</span><span class="p">),</span> <span class="s1">&#39;cadet_value_min&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]),</span>
                            <span class="s2">&quot;objective_value_min&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">20</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">O</span><span class="p">)]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">)]),</span>
                            <span class="s2">&quot;value_functions&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">200</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">O</span><span class="p">)]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">)]),</span>
                            <span class="s2">&quot;constraint_type&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">M</span><span class="p">,</span> <span class="n">O</span><span class="p">]),</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">O</span><span class="p">)]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">)],</span>
                            <span class="s2">&quot;objective_target&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">M</span><span class="p">,</span> <span class="n">O</span><span class="p">]),</span> <span class="s1">&#39;f^hat&#39;</span><span class="p">:</span> <span class="p">[[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">O</span><span class="p">)]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">)],</span>
                            <span class="s2">&quot;objective_weight&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">M</span><span class="p">,</span> <span class="n">O</span><span class="p">]),</span> <span class="s2">&quot;afsc_weight&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">M</span><span class="p">),</span>
                            <span class="s1">&#39;objectives&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vp_df</span><span class="p">)</span> <span class="o">/</span> <span class="n">M</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Objective&#39;</span><span class="p">]),</span> <span class="s2">&quot;K^A&quot;</span><span class="p">:</span> <span class="p">{},</span>
                            <span class="s1">&#39;num_breakpoints&#39;</span><span class="p">:</span> <span class="n">num_breakpoints</span><span class="p">}</span>

        <span class="c1"># If we have constraints specified for cadet utility</span>
        <span class="k">if</span> <span class="n">vp_cadet_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">value_parameters</span><span class="p">[</span><span class="s2">&quot;cadet_value_min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vp_cadet_df</span><span class="p">[</span><span class="n">vp_name</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

        <span class="c1"># Determine weights on cadets</span>
        <span class="k">if</span> <span class="s1">&#39;merit_all&#39;</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
            <span class="n">value_parameters</span><span class="p">[</span><span class="s1">&#39;cadet_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">afccp_vp</span><span class="o">.</span><span class="n">cadet_weight_function</span><span class="p">(</span>
                <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;merit_all&#39;</span><span class="p">],</span> <span class="n">func</span><span class="o">=</span><span class="n">value_parameters</span><span class="p">[</span><span class="s1">&#39;cadet_weight_function&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value_parameters</span><span class="p">[</span><span class="s1">&#39;cadet_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">afccp_vp</span><span class="o">.</span><span class="n">cadet_weight_function</span><span class="p">(</span>
                <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;merit&#39;</span><span class="p">],</span> <span class="n">func</span><span class="o">=</span><span class="n">value_parameters</span><span class="p">[</span><span class="s1">&#39;cadet_weight_function&#39;</span><span class="p">])</span>

        <span class="c1"># Load in value parameter data for each AFSC</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;J&quot;</span><span class="p">]:</span>  <span class="c1"># These are Os (Ohs) not 0s (zeros)</span>
            <span class="n">value_parameters</span><span class="p">[</span><span class="s2">&quot;objective_target&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span><span class="p">:(</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span> <span class="o">+</span> <span class="n">O</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Objective Target&#39;</span><span class="p">])</span>

            <span class="c1"># Force objective weights to sum to 1. K^A is the set of objectives that have non-zero weights for each AFSC</span>
            <span class="n">objective_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span><span class="p">:(</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span> <span class="o">+</span> <span class="n">O</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Objective Weight&#39;</span><span class="p">])</span>
            <span class="n">value_parameters</span><span class="p">[</span><span class="s2">&quot;objective_weight&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">objective_weights</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">objective_weights</span><span class="p">)</span>
            <span class="n">value_parameters</span><span class="p">[</span><span class="s1">&#39;K^A&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">value_parameters</span><span class="p">[</span><span class="s1">&#39;objective_weight&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

            <span class="n">value_parameters</span><span class="p">[</span><span class="s2">&quot;objective_value_min&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span><span class="p">:(</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span> <span class="o">+</span> <span class="n">O</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
                                                                     <span class="s1">&#39;Min Objective Value&#39;</span><span class="p">])</span>
            <span class="n">value_parameters</span><span class="p">[</span><span class="s2">&quot;constraint_type&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span><span class="p">:(</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span> <span class="o">+</span> <span class="n">O</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Constraint Type&#39;</span><span class="p">])</span>
            <span class="n">value_parameters</span><span class="p">[</span><span class="s2">&quot;value_functions&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span><span class="p">:(</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span> <span class="o">+</span> <span class="n">O</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Value Functions&#39;</span><span class="p">])</span>
            <span class="n">value_parameters</span><span class="p">[</span><span class="s2">&quot;afsc_weight&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">vp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span><span class="p">,</span> <span class="s2">&quot;AFSC Weight&quot;</span><span class="p">]</span>
            <span class="n">value_parameters</span><span class="p">[</span><span class="s2">&quot;afsc_value_min&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">vp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span><span class="p">,</span> <span class="s2">&quot;Min Value&quot;</span><span class="p">]</span>
            <span class="n">cadets</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;I^E&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>  <span class="c1"># Indices of cadets that are eligible for this AFSC</span>

            <span class="c1"># Loop through each objective for this AFSC</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">objective</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">value_parameters</span><span class="p">[</span><span class="s1">&#39;objectives&#39;</span><span class="p">]):</span>

                <span class="c1"># Refactored column names</span>
                <span class="k">if</span> <span class="s1">&#39;Function Breakpoints&#39;</span> <span class="ow">in</span> <span class="n">vp_df</span><span class="p">:</span>
                    <span class="n">measure_col_name</span> <span class="o">=</span> <span class="s1">&#39;Function Breakpoints&#39;</span>
                    <span class="n">value_col_name</span> <span class="o">=</span> <span class="s1">&#39;Function Breakpoint Values&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">measure_col_name</span> <span class="o">=</span> <span class="s1">&#39;Function Breakpoint Measures (a)&#39;</span>
                    <span class="n">value_col_name</span> <span class="o">=</span> <span class="s1">&#39;Function Breakpoint Values (f^hat)&#39;</span>

                <span class="c1"># We import the functions directly from the breakpoints</span>
                <span class="k">if</span> <span class="n">num_breakpoints</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">a_string</span> <span class="o">=</span> <span class="n">vp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span> <span class="n">measure_col_name</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">a_string</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
                        <span class="n">value_parameters</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a_string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>
                    <span class="n">fhat_string</span> <span class="o">=</span> <span class="n">vp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span> <span class="n">value_col_name</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">fhat_string</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
                        <span class="n">value_parameters</span><span class="p">[</span><span class="s1">&#39;f^hat&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fhat_string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>

                <span class="c1"># Recreate the functions from the vf strings</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">vf_string</span> <span class="o">=</span> <span class="n">value_parameters</span><span class="p">[</span><span class="s2">&quot;value_functions&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">vf_string</span> <span class="o">!=</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">objective</span> <span class="o">==</span> <span class="s1">&#39;Merit&#39;</span><span class="p">:</span>
                            <span class="n">actual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;merit&#39;</span><span class="p">][</span><span class="n">cadets</span><span class="p">])</span>
                        <span class="k">elif</span> <span class="n">objective</span> <span class="o">==</span> <span class="s1">&#39;USAFA Proportion&#39;</span><span class="p">:</span>
                            <span class="n">actual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;usafa&#39;</span><span class="p">][</span><span class="n">cadets</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">actual</span> <span class="o">=</span> <span class="kc">None</span>

                        <span class="c1"># Adjust target information for the &quot;Combined Quota&quot; objective</span>
                        <span class="k">if</span> <span class="n">objective</span> <span class="o">==</span> <span class="s1">&#39;Combined Quota&#39;</span><span class="p">:</span>
                            <span class="n">minimum</span><span class="p">,</span> <span class="n">maximum</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;quota_min&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;quota_max&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                            <span class="n">target</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;quota_d&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>  <span class="c1"># Desired number of cadets</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">minimum</span><span class="p">,</span> <span class="n">maximum</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">value_parameters</span><span class="p">[</span><span class="s1">&#39;objective_target&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>

                        <span class="c1"># Construct the value function (get the breakpoint coordinates)</span>
                        <span class="n">segment_dict</span> <span class="o">=</span> <span class="n">afccp_vp</span><span class="o">.</span><span class="n">create_segment_dict_from_string</span><span class="p">(</span>
                            <span class="n">vf_string</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">actual</span><span class="o">=</span><span class="n">actual</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="n">maximum</span><span class="p">,</span> <span class="n">minimum</span><span class="o">=</span><span class="n">minimum</span><span class="p">)</span>
                        <span class="n">value_parameters</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">value_parameters</span><span class="p">[</span><span class="s1">&#39;f^hat&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">afccp_vp</span><span class="o">.</span><span class="n">value_function_builder</span><span class="p">(</span>
                            <span class="n">segment_dict</span><span class="p">,</span> <span class="n">num_breakpoints</span><span class="o">=</span><span class="n">num_breakpoints</span><span class="p">)</span>

        <span class="c1"># Force AFSC weights to sum to 1</span>
        <span class="n">value_parameters</span><span class="p">[</span><span class="s2">&quot;afsc_weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value_parameters</span><span class="p">[</span><span class="s2">&quot;afsc_weight&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">value_parameters</span><span class="p">[</span><span class="s2">&quot;afsc_weight&quot;</span><span class="p">])</span>

        <span class="c1"># &quot;Condense&quot; the value functions by removing unnecessary zeros</span>
        <span class="n">value_parameters</span> <span class="o">=</span> <span class="n">afccp_vp</span><span class="o">.</span><span class="n">condense_value_functions</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">value_parameters</span><span class="p">)</span>

        <span class="c1"># Add indexed sets and subsets of AFSCs and AFSC objectives</span>
        <span class="n">value_parameters</span> <span class="o">=</span> <span class="n">afccp_vp</span><span class="o">.</span><span class="n">value_parameters_sets_additions</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">value_parameters</span><span class="p">)</span>

        <span class="c1"># Save the value parameters to the dictionary</span>
        <span class="n">vp_dict</span><span class="p">[</span><span class="n">vp_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">value_parameters</span><span class="p">)</span>
        <span class="n">vp_dict</span><span class="p">[</span><span class="n">vp_name</span><span class="p">][</span><span class="s1">&#39;vp_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vp_weights</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
        <span class="n">vp_dict</span><span class="p">[</span><span class="n">vp_name</span><span class="p">][</span><span class="s1">&#39;vp_local_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vp_weights</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">vp_weights</span><span class="p">)</span>

    <span class="c1"># Return the dictionary of value parameter sets</span>
    <span class="k">return</span> <span class="n">vp_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="data.processing.import_solutions_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">import_solutions_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span></code>

<a href="#data.processing.import_solutions_data" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Imports and assembles cadet assignment solutions from a saved output file (<code>&lt;data_name&gt; Solutions.csv</code>). Optionally,
more files are read in for Base/Training Course solutions.</p>
<p>This function reads solution files containing AFSC, base, and course assignments for each cadet,
converts string labels to indexed arrays, and returns a structured dictionary containing all
available solution configurations.</p>
<h4 id="data.processing.import_solutions_data--parameters">Parameters<a class="headerlink" href="#data.processing.import_solutions_data--parameters" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>import_filepaths : dict
Dictionary containing filepaths to solution files. Expected keys:</p>
<ul>
<li><code>"Solutions"</code>: required CSV file with AFSC assignments (one column per solution).</li>
<li><code>"Base Solutions"</code>: optional CSV with base assignments (same column names as above).</li>
<li><code>"Course Solutions"</code>: optional CSV with course assignments (same column names as above).</li>
</ul>
</li>
<li>
<p>parameters : dict
Dictionary of instance parameters. Must contain:</p>
<ul>
<li><code>'afscs'</code>: array of valid AFSC names.</li>
<li><code>'bases'</code>: array of valid base names (if <code>"Base Solutions"</code> is provided).</li>
<li><code>'courses'</code>: list of valid course arrays for each AFSC (if <code>"Course Solutions"</code> is provided).</li>
<li><code>'S'</code>: sentinel index value for unmatched bases.</li>
</ul>
</li>
</ul>
<h4 id="data.processing.import_solutions_data--returns">Returns<a class="headerlink" href="#data.processing.import_solutions_data--returns" title="Permanent link">&para;</a></h4>
<p>dict
Dictionary mapping solution names to their data. Each solution entry contains:</p>
<ul>
<li><code>'name'</code>: name of the solution (from CSV column header)</li>
<li><code>'afsc_array'</code>: array of assigned AFSC strings</li>
<li><code>'j_array'</code>: array of assigned AFSC indices (matching <code>parameters['afscs']</code>)</li>
<li><code>'base_array'</code> (optional): array of base names (if base data is present)</li>
<li><code>'b_array'</code> (optional): array of base indices (or sentinel <code>S</code> if unmatched)</li>
<li><code>'course_array'</code> (optional): array of course names (if course data is present)</li>
<li><code>'c_array'</code> (optional): array of <code>(j, c)</code> tuples representing AFSC/course index pairs</li>
</ul>
<h4 id="data.processing.import_solutions_data--raises">Raises<a class="headerlink" href="#data.processing.import_solutions_data--raises" title="Permanent link">&para;</a></h4>
<ul>
<li>FileNotFoundError
  If the required <code>"Solutions"</code> file is not present in <code>import_filepaths</code>.</li>
</ul>
<h4 id="data.processing.import_solutions_data--notes">Notes<a class="headerlink" href="#data.processing.import_solutions_data--notes" title="Permanent link">&para;</a></h4>
<ul>
<li>If a course assignment is not found within any AFSC‚Äôs course list, a fallback value of <code>(0, 0)</code> is added
  and a warning is printed.</li>
<li>Assumes that all solution files share the same cadet ordering and column headers for consistent mapping.</li>
</ul>
<h4 id="data.processing.import_solutions_data--see-also">See Also<a class="headerlink" href="#data.processing.import_solutions_data--see-also" title="Permanent link">&para;</a></h4>
<ul>
<li><a href="../../../afccp/reference/globals/#globals.import_csv_data"><code>import_csv_data</code></a></li>
<li><a href="../../../afccp/reference/data/processing/#data.processing.initialize_file_information"><code>initialize_file_information</code></a></li>
</ul>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">import_solutions_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Imports and assembles cadet assignment solutions from a saved output file (`&lt;data_name&gt; Solutions.csv`). Optionally,</span>
<span class="sd">    more files are read in for Base/Training Course solutions.</span>

<span class="sd">    This function reads solution files containing AFSC, base, and course assignments for each cadet,</span>
<span class="sd">    converts string labels to indexed arrays, and returns a structured dictionary containing all</span>
<span class="sd">    available solution configurations.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    - import_filepaths : dict</span>
<span class="sd">    Dictionary containing filepaths to solution files. Expected keys:</span>

<span class="sd">        - `&quot;Solutions&quot;`: required CSV file with AFSC assignments (one column per solution).</span>
<span class="sd">        - `&quot;Base Solutions&quot;`: optional CSV with base assignments (same column names as above).</span>
<span class="sd">        - `&quot;Course Solutions&quot;`: optional CSV with course assignments (same column names as above).</span>

<span class="sd">    - parameters : dict</span>
<span class="sd">    Dictionary of instance parameters. Must contain:</span>

<span class="sd">        - `&#39;afscs&#39;`: array of valid AFSC names.</span>
<span class="sd">        - `&#39;bases&#39;`: array of valid base names (if `&quot;Base Solutions&quot;` is provided).</span>
<span class="sd">        - `&#39;courses&#39;`: list of valid course arrays for each AFSC (if `&quot;Course Solutions&quot;` is provided).</span>
<span class="sd">        - `&#39;S&#39;`: sentinel index value for unmatched bases.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">    Dictionary mapping solution names to their data. Each solution entry contains:</span>

<span class="sd">    - `&#39;name&#39;`: name of the solution (from CSV column header)</span>
<span class="sd">    - `&#39;afsc_array&#39;`: array of assigned AFSC strings</span>
<span class="sd">    - `&#39;j_array&#39;`: array of assigned AFSC indices (matching `parameters[&#39;afscs&#39;]`)</span>
<span class="sd">    - `&#39;base_array&#39;` (optional): array of base names (if base data is present)</span>
<span class="sd">    - `&#39;b_array&#39;` (optional): array of base indices (or sentinel `S` if unmatched)</span>
<span class="sd">    - `&#39;course_array&#39;` (optional): array of course names (if course data is present)</span>
<span class="sd">    - `&#39;c_array&#39;` (optional): array of `(j, c)` tuples representing AFSC/course index pairs</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    - FileNotFoundError</span>
<span class="sd">      If the required `&quot;Solutions&quot;` file is not present in `import_filepaths`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - If a course assignment is not found within any AFSC‚Äôs course list, a fallback value of `(0, 0)` is added</span>
<span class="sd">      and a warning is printed.</span>
<span class="sd">    - Assumes that all solution files share the same cadet ordering and column headers for consistent mapping.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    - [`import_csv_data`](../../../afccp/reference/globals/#globals.import_csv_data)</span>
<span class="sd">    - [`initialize_file_information`](../../../afccp/reference/data/processing/#data.processing.initialize_file_information)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">parameters</span>

    <span class="c1"># Import the &quot;Solutions&quot; dataframe if we have it. If we don&#39;t, the &quot;solutions_dict&quot; will be &quot;None&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;Solutions&quot;</span> <span class="ow">in</span> <span class="n">import_filepaths</span><span class="p">:</span>
        <span class="n">solutions_df</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">globals</span><span class="o">.</span><span class="n">import_csv_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">[</span><span class="s2">&quot;Solutions&quot;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># Nothing more we can do now (No solutions determined yet for this instance)</span>

    <span class="c1"># Get list of solution names</span>
    <span class="n">solution_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">solutions_df</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="c1"># Loop through each solution, convert to a numpy array of AFSC indices, and then add it to the dictionary</span>
    <span class="n">solutions</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">solution_name</span> <span class="ow">in</span> <span class="n">solution_names</span><span class="p">:</span>

        <span class="c1"># Convert solution of AFSC names to indices and then save it to the dictionary</span>
        <span class="n">afsc_solution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">solutions_df</span><span class="p">[</span><span class="n">solution_name</span><span class="p">])</span>  <span class="c1"># [&quot;15A&quot;, &quot;14N&quot;, &quot;17X&quot;, ...]</span>
        <span class="n">solution</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;j_array&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">afsc</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="n">afsc_solution</span><span class="p">]),</span> <span class="c1"># [3, 2, 5, ...]</span>
                    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">solution_name</span><span class="p">,</span> <span class="s1">&#39;afsc_array&#39;</span><span class="p">:</span> <span class="n">afsc_solution</span><span class="p">}</span>
        <span class="n">solutions</span><span class="p">[</span><span class="n">solution_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span>

    <span class="c1"># If we have this extra component</span>
    <span class="k">if</span> <span class="s1">&#39;Base Solutions&#39;</span> <span class="ow">in</span> <span class="n">import_filepaths</span><span class="p">:</span>
        <span class="n">solutions_df</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">globals</span><span class="o">.</span><span class="n">import_csv_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">[</span><span class="s1">&#39;Base Solutions&#39;</span><span class="p">])</span>

        <span class="c1"># Get list of solution names</span>
        <span class="n">solution_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">solutions_df</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">1</span><span class="p">:]</span>

        <span class="c1"># Loop through each solution in this dataframe and add the base assignments</span>
        <span class="k">for</span> <span class="n">solution_name</span> <span class="ow">in</span> <span class="n">solution_names</span><span class="p">:</span>
            <span class="n">base_solution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">solutions_df</span><span class="p">[</span><span class="n">solution_name</span><span class="p">])</span>
            <span class="n">solutions</span><span class="p">[</span><span class="n">solution_name</span><span class="p">][</span><span class="s1">&#39;base_array&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">base_solution</span>
            <span class="n">solutions</span><span class="p">[</span><span class="n">solution_name</span><span class="p">][</span><span class="s1">&#39;b_array&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;bases&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">base</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">base</span> <span class="ow">in</span> <span class="n">base_solution</span> <span class="k">else</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">base</span> <span class="ow">in</span> <span class="n">base_solution</span><span class="p">])</span>

    <span class="c1"># If we have this extra component</span>
    <span class="k">if</span> <span class="s1">&#39;Course Solutions&#39;</span> <span class="ow">in</span> <span class="n">import_filepaths</span><span class="p">:</span>
        <span class="n">solutions_df</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">globals</span><span class="o">.</span><span class="n">import_csv_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">[</span><span class="s1">&#39;Course Solutions&#39;</span><span class="p">])</span>

        <span class="c1"># Get list of solution names</span>
        <span class="n">solution_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">solutions_df</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">1</span><span class="p">:]</span>

        <span class="c1"># Loop through each solution in this dataframe and add the course assignments</span>
        <span class="k">for</span> <span class="n">solution_name</span> <span class="ow">in</span> <span class="n">solution_names</span><span class="p">:</span>
            <span class="n">course_solution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">solutions_df</span><span class="p">[</span><span class="n">solution_name</span><span class="p">])</span>
            <span class="n">solutions</span><span class="p">[</span><span class="n">solution_name</span><span class="p">][</span><span class="s1">&#39;course_array&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">course_solution</span>
            <span class="n">c_array</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">course</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">course_solution</span><span class="p">):</span>
                <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="n">course</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;courses&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]:</span>
                        <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;courses&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">course</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">c_array</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">j</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
                        <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">break</span>

                <span class="c1"># This shouldn&#39;t happen!</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Course &#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">course</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39; not valid for cadet&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                    <span class="n">c_array</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="n">solutions</span><span class="p">[</span><span class="n">solution_name</span><span class="p">][</span><span class="s1">&#39;c_array&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">c_array</span><span class="p">)</span>

    <span class="c1"># Return the dictionary of solutions</span>
    <span class="k">return</span> <span class="n">solutions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="data.processing.import_additional_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">import_additional_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span></code>

<a href="#data.processing.import_additional_data" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Imports supplemental data files (if present) and updates the instance parameters dictionary.</p>
<p>This function loads optional model extensions including base and course assignments, preference matrices,
and CASTLE-specific AFSC data. These components are not required for basic operation but enhance downstream
modeling functionality (e.g., course scheduling, base optimization, CASTLE implementation).</p>
<h4 id="data.processing.import_additional_data--parameters">Parameters<a class="headerlink" href="#data.processing.import_additional_data--parameters" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>import_filepaths : dict
  Dictionary containing filepaths to additional optional data files. Expected keys include:</p>
<ul>
<li>"Bases", "Bases Preferences", "Bases Utility"</li>
<li>"Courses", "Castle Input"</li>
</ul>
</li>
<li>
<p>parameters : dict
  Dictionary of core model parameters. This dictionary will be updated with any new fields derived from imported files.</p>
</li>
</ul>
<h4 id="data.processing.import_additional_data--returns">Returns<a class="headerlink" href="#data.processing.import_additional_data--returns" title="Permanent link">&para;</a></h4>
<p>dict
Updated parameter dictionary with the following optional fields added if available:</p>
<ul>
<li><code>'bases'</code>: Array of base names</li>
<li><code>'S'</code>: Number of bases</li>
<li><code>'base_min'</code> / <code>'base_max'</code>: Base assignment bounds by AFSC</li>
<li><code>'b_pref_matrix'</code>: Cadet base preference matrix</li>
<li><code>'base_utility'</code>: Cadet base utility matrix</li>
<li><code>'courses'</code>: Dict of course options by AFSC</li>
<li><code>'course_start'</code>, <code>'course_min'</code>, <code>'course_max'</code>: Dicts with course metadata by AFSC</li>
<li><code>'castle_afscs_arr'</code>, <code>'afpc_afscs_arr'</code>: Raw CASTLE vs AFPC AFSC labels</li>
<li><code>'castle_afscs'</code>: Mapping of CASTLE AFSCs ‚Üí AFPC AFSCs</li>
<li><code>'J^CASTLE'</code>: CASTLE AFSCs mapped to indices in the AFPC AFSC array</li>
<li><code>'ots_counts'</code>: OTS accession counts for CASTLE AFSCs</li>
<li><code>'optimal_policy'</code>: Policy toggle per CASTLE AFSC</li>
<li>
<p><code>'castle_q'</code>: Dictionary of breakpoint-based value functions:</p>
<ul>
<li><code>'a'</code>, <code>'f^hat'</code>: Breakpoints and values</li>
<li><code>'r'</code>: Number of breakpoints</li>
<li><code>'L'</code>: Breakpoint indices</li>
</ul>
</li>
</ul>
<h4 id="data.processing.import_additional_data--notes">Notes<a class="headerlink" href="#data.processing.import_additional_data--notes" title="Permanent link">&para;</a></h4>
<ul>
<li>Breakpoint information from <code>"Castle Input"</code> is stored under <code>castle_q</code>.</li>
<li>Course and base matrices are assumed to be properly aligned with the cadet and AFSC indices already in memory.</li>
<li>All newly imported data is optional and loaded only if the corresponding files are provided.</li>
</ul>
<h4 id="data.processing.import_additional_data--see-also">See Also<a class="headerlink" href="#data.processing.import_additional_data--see-also" title="Permanent link">&para;</a></h4>
<ul>
<li><a href="../../../afccp/reference/data/processing/#data.processing.initialize_file_information"><code>initialize_file_information</code></a></li>
<li><a href="../../../afccp/reference/globals/#globals.import_csv_data"><code>import_csv_data</code></a></li>
</ul>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">import_additional_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Imports supplemental data files (if present) and updates the instance parameters dictionary.</span>

<span class="sd">    This function loads optional model extensions including base and course assignments, preference matrices,</span>
<span class="sd">    and CASTLE-specific AFSC data. These components are not required for basic operation but enhance downstream</span>
<span class="sd">    modeling functionality (e.g., course scheduling, base optimization, CASTLE implementation).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    - import_filepaths : dict</span>
<span class="sd">      Dictionary containing filepaths to additional optional data files. Expected keys include:</span>

<span class="sd">        - &quot;Bases&quot;, &quot;Bases Preferences&quot;, &quot;Bases Utility&quot;</span>
<span class="sd">        - &quot;Courses&quot;, &quot;Castle Input&quot;</span>

<span class="sd">    - parameters : dict</span>
<span class="sd">      Dictionary of core model parameters. This dictionary will be updated with any new fields derived from imported files.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">    Updated parameter dictionary with the following optional fields added if available:</span>

<span class="sd">    - `&#39;bases&#39;`: Array of base names</span>
<span class="sd">    - `&#39;S&#39;`: Number of bases</span>
<span class="sd">    - `&#39;base_min&#39;` / `&#39;base_max&#39;`: Base assignment bounds by AFSC</span>
<span class="sd">    - `&#39;b_pref_matrix&#39;`: Cadet base preference matrix</span>
<span class="sd">    - `&#39;base_utility&#39;`: Cadet base utility matrix</span>
<span class="sd">    - `&#39;courses&#39;`: Dict of course options by AFSC</span>
<span class="sd">    - `&#39;course_start&#39;`, `&#39;course_min&#39;`, `&#39;course_max&#39;`: Dicts with course metadata by AFSC</span>
<span class="sd">    - `&#39;castle_afscs_arr&#39;`, `&#39;afpc_afscs_arr&#39;`: Raw CASTLE vs AFPC AFSC labels</span>
<span class="sd">    - `&#39;castle_afscs&#39;`: Mapping of CASTLE AFSCs ‚Üí AFPC AFSCs</span>
<span class="sd">    - `&#39;J^CASTLE&#39;`: CASTLE AFSCs mapped to indices in the AFPC AFSC array</span>
<span class="sd">    - `&#39;ots_counts&#39;`: OTS accession counts for CASTLE AFSCs</span>
<span class="sd">    - `&#39;optimal_policy&#39;`: Policy toggle per CASTLE AFSC</span>
<span class="sd">    - `&#39;castle_q&#39;`: Dictionary of breakpoint-based value functions:</span>

<span class="sd">        - `&#39;a&#39;`, `&#39;f^hat&#39;`: Breakpoints and values</span>
<span class="sd">        - `&#39;r&#39;`: Number of breakpoints</span>
<span class="sd">        - `&#39;L&#39;`: Breakpoint indices</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - Breakpoint information from `&quot;Castle Input&quot;` is stored under `castle_q`.</span>
<span class="sd">    - Course and base matrices are assumed to be properly aligned with the cadet and AFSC indices already in memory.</span>
<span class="sd">    - All newly imported data is optional and loaded only if the corresponding files are provided.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    - [`initialize_file_information`](../../../afccp/reference/data/processing/#data.processing.initialize_file_information)</span>
<span class="sd">    - [`import_csv_data`](../../../afccp/reference/globals/#globals.import_csv_data)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">parameters</span>

    <span class="c1"># Loop through the potential additional dataframes and import them if we have them</span>
    <span class="n">datasets</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Bases&quot;</span><span class="p">,</span> <span class="s2">&quot;Bases Preferences&quot;</span><span class="p">,</span> <span class="s2">&quot;Bases Utility&quot;</span><span class="p">,</span> <span class="s2">&quot;Courses&quot;</span><span class="p">,</span> <span class="s2">&quot;Castle Input&quot;</span><span class="p">]:</span>

        <span class="c1"># If we have the dataset, import it</span>
        <span class="k">if</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">import_filepaths</span><span class="p">:</span>
            <span class="n">datasets</span><span class="p">[</span><span class="n">dataset</span><span class="p">]</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">globals</span><span class="o">.</span><span class="n">import_csv_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">[</span><span class="n">dataset</span><span class="p">])</span>

    <span class="c1"># First and last AFSC (for collecting matrices from dataframes)</span>
    <span class="n">afsc_1</span><span class="p">,</span> <span class="n">afsc_M</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;afscs&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;afscs&quot;</span><span class="p">][</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Extract data from &quot;Bases.csv&quot; if applicable</span>
    <span class="k">if</span> <span class="s2">&quot;Bases&quot;</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;bases&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;Bases&quot;</span><span class="p">][</span><span class="s2">&quot;Base&quot;</span><span class="p">])</span>  <span class="c1"># Set of bases (names)</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;bases&#39;</span><span class="p">])</span>  <span class="c1"># Number of bases (S for &quot;Station&quot;)</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;base_min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;Bases&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">afsc_1</span> <span class="o">+</span> <span class="s2">&quot; Min&quot;</span><span class="p">:</span> <span class="n">afsc_M</span> <span class="o">+</span> <span class="s2">&quot; Min&quot;</span><span class="p">])</span>  <span class="c1"># Minimum base # by AFSC</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;base_max&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;Bases&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">afsc_1</span> <span class="o">+</span> <span class="s2">&quot; Max&quot;</span><span class="p">:</span> <span class="n">afsc_M</span> <span class="o">+</span> <span class="s2">&quot; Max&quot;</span><span class="p">])</span>  <span class="c1"># Maximum base # by AFSC</span>

    <span class="c1"># Extract data from &quot;Base Preferences.csv&quot; and &quot;Base Utility.csv&quot; if applicable</span>
    <span class="k">for</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;b_pref_matrix&#39;</span><span class="p">:</span> <span class="s1">&#39;Bases Preferences&#39;</span><span class="p">,</span> <span class="s1">&#39;base_utility&#39;</span><span class="p">:</span> <span class="s1">&#39;Bases Utility&#39;</span><span class="p">}</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>
            <span class="n">base_1</span><span class="p">,</span> <span class="n">base_S</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;bases&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;bases&#39;</span><span class="p">][</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">p</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="n">dataset</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">base_1</span><span class="p">:</span> <span class="n">base_S</span><span class="p">])</span>

    <span class="c1"># Extract data from &quot;Courses.csv&quot; if applicable</span>
    <span class="k">if</span> <span class="s2">&quot;Courses&quot;</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>

        <span class="c1"># Need a dictionary of indices of courses that apply to each AFSC</span>
        <span class="n">afscs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;Courses&quot;</span><span class="p">][</span><span class="s2">&quot;AFSC&quot;</span><span class="p">])</span>
        <span class="n">afsc_courses</span> <span class="o">=</span> <span class="p">{</span><span class="n">j</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">afscs</span> <span class="o">==</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">])}</span>

        <span class="c1"># Dictionary to translate parameter names to column names</span>
        <span class="n">column_translation</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Course&quot;</span><span class="p">:</span> <span class="s1">&#39;courses&#39;</span><span class="p">,</span> <span class="s1">&#39;Start Date&#39;</span><span class="p">:</span> <span class="s1">&#39;course_start&#39;</span><span class="p">,</span> <span class="s1">&#39;Min&#39;</span><span class="p">:</span> <span class="s1">&#39;course_min&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;Max&#39;</span><span class="p">:</span> <span class="s1">&#39;course_max&#39;</span><span class="p">}</span>

        <span class="c1"># Get each parameter from the columns of this dataset</span>
        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">column_translation</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;Courses&#39;</span><span class="p">][</span><span class="n">col</span><span class="p">])</span>  <span class="c1"># Convert dataframe column to numpy array</span>
            <span class="n">p</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">j</span><span class="p">:</span> <span class="n">arr</span><span class="p">[</span><span class="n">afsc_courses</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">])}</span>

    <span class="c1"># Extract data from &quot;Castle Input.csv&quot; if applicable</span>
    <span class="k">if</span> <span class="s2">&quot;Castle Input&quot;</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>

        <span class="c1"># Load in AFSC arrays</span>
        <span class="n">castle_afscs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;Castle Input&#39;</span><span class="p">][</span><span class="s1">&#39;CASTLE AFSC&#39;</span><span class="p">])</span>
        <span class="n">afpc_afscs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;Castle Input&#39;</span><span class="p">][</span><span class="s1">&#39;AFPC AFSC&#39;</span><span class="p">])</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;castle_afscs_arr&#39;</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;afpc_afscs_arr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">castle_afscs</span><span class="p">,</span> <span class="n">afpc_afscs</span>

        <span class="c1"># Create dictionary of CASTLE AFSCs -&gt; AFPC AFSCs (account for groupings)</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;castle_afscs&#39;</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^CASTLE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">castle_afsc</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">castle_afscs</span><span class="p">):</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">castle_afscs</span> <span class="o">==</span> <span class="n">castle_afsc</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">p</span><span class="p">[</span><span class="s1">&#39;castle_afscs&#39;</span><span class="p">][</span><span class="n">castle_afsc</span><span class="p">]</span> <span class="o">=</span> <span class="n">afpc_afscs</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
            <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^CASTLE&#39;</span><span class="p">][</span><span class="n">castle_afsc</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">afsc</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="n">afpc_afscs</span><span class="p">[</span><span class="n">indices</span><span class="p">]])</span>

        <span class="c1"># Initialize OTS counts and optimal policy dictionary</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;ots_counts&#39;</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;optimal_policy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>

        <span class="c1"># Load in &quot;q&quot; dictionary information if it exists</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;Castle Input&#39;</span><span class="p">]</span>  <span class="c1"># Shorthand</span>
        <span class="k">if</span> <span class="s1">&#39;a&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">q</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;f^hat&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="p">{}}</span>
            <span class="k">for</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">castle_afscs</span><span class="p">):</span>
                <span class="n">row</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;CASTLE AFSC&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">afsc</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                <span class="c1"># Add OTS count information and optimal policy information for this AFSC</span>
                <span class="n">p</span><span class="p">[</span><span class="s1">&#39;ots_counts&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;OTS Count&#39;</span><span class="p">]</span>
                <span class="n">p</span><span class="p">[</span><span class="s1">&#39;optimal_policy&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Optimal&#39;</span><span class="p">]</span>

                <span class="c1"># Load breakpoint coordinates into q dictionary</span>
                <span class="n">a_str</span><span class="p">,</span> <span class="n">f_hat_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]),</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;f^hat&#39;</span><span class="p">])</span>
                <span class="n">q</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)])</span>
                <span class="n">q</span><span class="p">[</span><span class="s1">&#39;f^hat&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">f_hat_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)])</span>

                <span class="c1"># Save additional information to q dictionary</span>
                <span class="n">q</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">]))</span>
                <span class="n">p</span><span class="p">[</span><span class="s1">&#39;castle_q&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">q</span>  <span class="c1"># Save to parameters dictionary</span>

    <span class="c1"># Return parameters dictionary</span>
    <span class="k">return</span> <span class="n">p</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="data.processing.export_afscs_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">export_afscs_data</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span></code>

<a href="#data.processing.export_afscs_data" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Exports AFSC-level data from the given <code>Instance</code> object to a CSV file.</p>
<p>This function collects Air Force Specialty Code (AFSC) parameters stored in the instance,
organizes them into a structured dataframe, and writes the result to disk at the location
specified by <code>instance.export_paths["AFSCs"]</code>.</p>
<h4 id="data.processing.export_afscs_data--parameters">Parameters<a class="headerlink" href="#data.processing.export_afscs_data--parameters" title="Permanent link">&para;</a></h4>
<ul>
<li>instance : Instance
  A fully initialized <code>Instance</code> object with a populated <code>parameters</code> dictionary and <code>export_paths</code> mapping.
  The instance must include AFSC data such as quotas, eligibility, preference counts, and any
  derived degree tier breakdowns.</li>
</ul>
<h4 id="data.processing.export_afscs_data--returns">Returns<a class="headerlink" href="#data.processing.export_afscs_data--returns" title="Permanent link">&para;</a></h4>
<ul>
<li>None
  The function writes the output to disk and does not return a value.</li>
</ul>
<h4 id="data.processing.export_afscs_data--notes">Notes<a class="headerlink" href="#data.processing.export_afscs_data--notes" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>The function dynamically detects and exports the following fields if present:</p>
<ul>
<li>Core AFSC descriptors: name, accession group, STEM tag, base assignment</li>
<li>Quota targets: Desired, Estimated, Min, Max, PGL, commissioning source quotas</li>
<li>Course counts (<code>T</code>) and bubble caps (<code>max_bubbles</code>)</li>
<li>Eligibility counts per commissioning source</li>
<li>Degree tier distributions and tier counts (if <code>"Deg Tiers"</code> and <code>"I^D"</code> are available)</li>
<li>Cadet preference counts per AFSC (if <code>"Choice Count"</code> is present)</li>
</ul>
</li>
<li>
<p>Only the first <code>p["M"]</code> AFSCs are included in the output. Any padding elements (e.g., "*") are excluded.</p>
</li>
<li>
<p>The output file is named <code>"AFSCs.csv"</code> and stored in the directory determined by <code>instance.export_paths</code>.</p>
</li>
</ul>
<h4 id="data.processing.export_afscs_data--see-also">See Also<a class="headerlink" href="#data.processing.export_afscs_data--see-also" title="Permanent link">&para;</a></h4>
<ul>
<li><a href="../../../afccp/reference/data/processing/#data.processing.import_afscs_data"><code>import_afscs_data</code></a></li>
<li><a href="../../../afccp/reference/data/processing/#data.processing.initialize_file_information"><code>initialize_file_information</code></a></li>
</ul>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">export_afscs_data</span><span class="p">(</span><span class="n">instance</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Exports AFSC-level data from the given `Instance` object to a CSV file.</span>

<span class="sd">    This function collects Air Force Specialty Code (AFSC) parameters stored in the instance,</span>
<span class="sd">    organizes them into a structured dataframe, and writes the result to disk at the location</span>
<span class="sd">    specified by `instance.export_paths[&quot;AFSCs&quot;]`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    - instance : Instance</span>
<span class="sd">      A fully initialized `Instance` object with a populated `parameters` dictionary and `export_paths` mapping.</span>
<span class="sd">      The instance must include AFSC data such as quotas, eligibility, preference counts, and any</span>
<span class="sd">      derived degree tier breakdowns.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    - None</span>
<span class="sd">      The function writes the output to disk and does not return a value.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - The function dynamically detects and exports the following fields if present:</span>

<span class="sd">        - Core AFSC descriptors: name, accession group, STEM tag, base assignment</span>
<span class="sd">        - Quota targets: Desired, Estimated, Min, Max, PGL, commissioning source quotas</span>
<span class="sd">        - Course counts (`T`) and bubble caps (`max_bubbles`)</span>
<span class="sd">        - Eligibility counts per commissioning source</span>
<span class="sd">        - Degree tier distributions and tier counts (if `&quot;Deg Tiers&quot;` and `&quot;I^D&quot;` are available)</span>
<span class="sd">        - Cadet preference counts per AFSC (if `&quot;Choice Count&quot;` is present)</span>

<span class="sd">    - Only the first `p[&quot;M&quot;]` AFSCs are included in the output. Any padding elements (e.g., &quot;*&quot;) are excluded.</span>

<span class="sd">    - The output file is named `&quot;AFSCs.csv&quot;` and stored in the directory determined by `instance.export_paths`.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    - [`import_afscs_data`](../../../afccp/reference/data/processing/#data.processing.import_afscs_data)</span>
<span class="sd">    - [`initialize_file_information`](../../../afccp/reference/data/processing/#data.processing.initialize_file_information)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span>

    <span class="c1"># Initialize dictionary translating AFSC parameters to their &quot;AFSCs&quot; df column counterparts</span>
    <span class="n">afsc_parameters_to_columns</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;afscs&quot;</span><span class="p">:</span> <span class="s2">&quot;AFSC&quot;</span><span class="p">,</span> <span class="s2">&quot;acc_grp&quot;</span><span class="p">:</span> <span class="s2">&quot;Accessions Group&quot;</span><span class="p">,</span> <span class="s2">&quot;afscs_stem&quot;</span><span class="p">:</span> <span class="s2">&quot;STEM&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;usafa_quota&quot;</span><span class="p">:</span> <span class="s2">&quot;USAFA Target&quot;</span><span class="p">,</span> <span class="s2">&quot;rotc_quota&quot;</span><span class="p">:</span> <span class="s2">&quot;ROTC Target&quot;</span><span class="p">,</span> <span class="s1">&#39;ots_quota&#39;</span><span class="p">:</span> <span class="s1">&#39;OTS Target&#39;</span><span class="p">,</span>
                                  <span class="s2">&quot;pgl&quot;</span><span class="p">:</span> <span class="s2">&quot;PGL Target&quot;</span><span class="p">,</span> <span class="s2">&quot;quota_e&quot;</span><span class="p">:</span> <span class="s2">&quot;Estimated&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;quota_d&quot;</span><span class="p">:</span> <span class="s2">&quot;Desired&quot;</span><span class="p">,</span> <span class="s2">&quot;quota_min&quot;</span><span class="p">:</span> <span class="s2">&quot;Min&quot;</span><span class="p">,</span> <span class="s2">&quot;quota_max&quot;</span><span class="p">:</span> <span class="s2">&quot;Max&quot;</span><span class="p">,</span>
                                  <span class="s1">&#39;max_bubbles&#39;</span><span class="p">:</span> <span class="s1">&#39;Max (Bubbles)&#39;</span><span class="p">,</span>
                                  <span class="s2">&quot;afsc_assign_base&quot;</span><span class="p">:</span> <span class="s1">&#39;Assign Base&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="s1">&#39;Num Courses&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;usafa_eligible_count&#39;</span><span class="p">:</span> <span class="s1">&#39;USAFA Eligible&#39;</span><span class="p">,</span> <span class="s1">&#39;rotc_eligible_count&#39;</span><span class="p">:</span> <span class="s1">&#39;ROTC Eligible&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;ots_eligible_count&#39;</span><span class="p">:</span> <span class="s2">&quot;OTS Eligible&quot;</span><span class="p">}</span>

    <span class="c1"># Loop through each parameter in the translation dictionary to create dictionary of &quot;AFSCs&quot; columns</span>
    <span class="n">afscs_columns</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">afsc_parameters_to_columns</span><span class="p">:</span>

        <span class="c1"># If we have the parameter, create the column</span>
        <span class="k">if</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
            <span class="n">col_name</span> <span class="o">=</span> <span class="n">afsc_parameters_to_columns</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span>
            <span class="n">afscs_columns</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">parameter</span><span class="p">][:</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">]]</span>  <span class="c1"># Don&#39;t want to include the *!</span>

    <span class="c1"># Create the degree tier columns</span>
    <span class="k">if</span> <span class="s2">&quot;Deg Tiers&quot;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">afscs_columns</span><span class="p">[</span><span class="s2">&quot;Deg Tier &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;Deg Tiers&quot;</span><span class="p">][:,</span> <span class="n">t</span><span class="p">]</span>

    <span class="c1"># Degree Tier Counts</span>
    <span class="k">if</span> <span class="s2">&quot;Tier 1&quot;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I^D&#39;</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">]:</span>
            <span class="n">afscs_columns</span><span class="p">[</span><span class="s1">&#39;Deg Tier &#39;</span> <span class="o">+</span> <span class="n">t</span> <span class="o">+</span> <span class="s1">&#39; Count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;I^D&#39;</span><span class="p">][</span><span class="s1">&#39;Tier &#39;</span> <span class="o">+</span> <span class="n">t</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]]</span>

    <span class="c1"># Preference Counts</span>
    <span class="k">if</span> <span class="s1">&#39;Choice Count&#39;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;Choice Count&#39;</span><span class="p">]:</span>
            <span class="n">afscs_columns</span><span class="p">[</span><span class="s1">&#39;Choice &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">choice</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;Choice Count&#39;</span><span class="p">][</span><span class="n">choice</span><span class="p">]</span>

    <span class="c1"># Create dataframe</span>
    <span class="n">afscs_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">afscs_columns</span><span class="p">)</span>

    <span class="c1"># Export &#39;AFSCs&#39; dataframe</span>
    <span class="n">afscs_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="s2">&quot;AFSCs&quot;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="data.processing.export_cadets_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">export_cadets_data</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span></code>

<a href="#data.processing.export_cadets_data" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Exports cadet-level data from the given <code>Instance</code> object to a CSV file.</p>
<p>This function builds the "Cadets" dataframe from internal model parameters stored in the instance,
capturing individual cadet characteristics, preferences, and qualification data (if available).
The output is saved to disk at the location specified by <code>instance.export_paths["Cadets"]</code>.</p>
<h4 id="data.processing.export_cadets_data--parameters">Parameters<a class="headerlink" href="#data.processing.export_cadets_data--parameters" title="Permanent link">&para;</a></h4>
<ul>
<li>instance : Instance
  A fully initialized <code>Instance</code> object containing model parameters (<code>parameters</code>) and a configured
  export path for the "Cadets" CSV file.</li>
</ul>
<h4 id="data.processing.export_cadets_data--returns">Returns<a class="headerlink" href="#data.processing.export_cadets_data--returns" title="Permanent link">&para;</a></h4>
<ul>
<li>None
  The function writes the cadet-level data to disk and does not return a value.</li>
</ul>
<h4 id="data.processing.export_cadets_data--notes">Notes<a class="headerlink" href="#data.processing.export_cadets_data--notes" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>The following cadet-level attributes will be included if present in <code>parameters</code>:</p>
<ul>
<li>Basic profile: Cadet ID, gender, race, ethnicity, accession group, STEM tag, ASC codes</li>
<li>Assignment metadata: must-match flags, base/course preferences, assigned AFSC</li>
<li>Merit metrics: raw merit, real merit</li>
<li>Training data: start date, preference rankings, course/base weights and thresholds</li>
<li>Utility and preference columns: if present, the full <code>c_utilities</code> and <code>c_preferences</code> matrices will be exported</li>
<li>Qualification data: if a <code>qual</code> matrix is present, columns are added for each AFSC (e.g., <code>qual_17X</code>, <code>qual_21R</code>)</li>
</ul>
</li>
<li>
<p>The preference and utility columns are labeled as <code>Pref_1</code>, <code>Pref_2</code>, ..., <code>Util_1</code>, <code>Util_2</code>, etc.</p>
</li>
<li>The output is saved as <code>"Cadets.csv"</code> under the directory given by <code>instance.export_paths</code>.</li>
</ul>
<h4 id="data.processing.export_cadets_data--see-also">See Also<a class="headerlink" href="#data.processing.export_cadets_data--see-also" title="Permanent link">&para;</a></h4>
<ul>
<li><a href="../../../afccp/reference/data/processing/#data.processing.import_cadets_data"><code>import_cadets_data</code></a></li>
<li><a href="../../../afccp/reference/data/processing/#data.processing.initialize_file_information"><code>initialize_file_information</code></a></li>
</ul>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">export_cadets_data</span><span class="p">(</span><span class="n">instance</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Exports cadet-level data from the given `Instance` object to a CSV file.</span>

<span class="sd">    This function builds the &quot;Cadets&quot; dataframe from internal model parameters stored in the instance,</span>
<span class="sd">    capturing individual cadet characteristics, preferences, and qualification data (if available).</span>
<span class="sd">    The output is saved to disk at the location specified by `instance.export_paths[&quot;Cadets&quot;]`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    - instance : Instance</span>
<span class="sd">      A fully initialized `Instance` object containing model parameters (`parameters`) and a configured</span>
<span class="sd">      export path for the &quot;Cadets&quot; CSV file.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    - None</span>
<span class="sd">      The function writes the cadet-level data to disk and does not return a value.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - The following cadet-level attributes will be included if present in `parameters`:</span>

<span class="sd">        - Basic profile: Cadet ID, gender, race, ethnicity, accession group, STEM tag, ASC codes</span>
<span class="sd">        - Assignment metadata: must-match flags, base/course preferences, assigned AFSC</span>
<span class="sd">        - Merit metrics: raw merit, real merit</span>
<span class="sd">        - Training data: start date, preference rankings, course/base weights and thresholds</span>
<span class="sd">        - Utility and preference columns: if present, the full `c_utilities` and `c_preferences` matrices will be exported</span>
<span class="sd">        - Qualification data: if a `qual` matrix is present, columns are added for each AFSC (e.g., `qual_17X`, `qual_21R`)</span>

<span class="sd">    - The preference and utility columns are labeled as `Pref_1`, `Pref_2`, ..., `Util_1`, `Util_2`, etc.</span>
<span class="sd">    - The output is saved as `&quot;Cadets.csv&quot;` under the directory given by `instance.export_paths`.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    - [`import_cadets_data`](../../../afccp/reference/data/processing/#data.processing.import_cadets_data)</span>
<span class="sd">    - [`initialize_file_information`](../../../afccp/reference/data/processing/#data.processing.initialize_file_information)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span>

    <span class="c1"># Initialize dictionary translating &#39;AFSCs&#39; df columns to their parameter counterparts</span>
    <span class="n">cadet_parameters_to_columns</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cadets&quot;</span><span class="p">:</span> <span class="s2">&quot;Cadet&quot;</span><span class="p">,</span> <span class="s2">&quot;must_match&quot;</span><span class="p">:</span> <span class="s2">&quot;Must Match&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;assigned&quot;</span><span class="p">:</span> <span class="s2">&quot;Assigned&quot;</span><span class="p">,</span> <span class="s2">&quot;acc_grp_constraint&quot;</span><span class="p">:</span> <span class="s2">&quot;Accessions Group&quot;</span><span class="p">,</span>
                                   <span class="s1">&#39;training_start&#39;</span><span class="p">:</span> <span class="s1">&#39;Start Date&#39;</span><span class="p">,</span> <span class="s1">&#39;training_preferences&#39;</span><span class="p">:</span> <span class="s1">&#39;Start Pref&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;base_threshold&#39;</span><span class="p">:</span> <span class="s1">&#39;Base Threshold&#39;</span><span class="p">,</span> <span class="s1">&#39;training_threshold&#39;</span><span class="p">:</span> <span class="s1">&#39;Course Threshold&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;weight_afsc&#39;</span><span class="p">:</span> <span class="s1">&#39;AFSC Weight&#39;</span><span class="p">,</span> <span class="s1">&#39;weight_base&#39;</span><span class="p">:</span> <span class="s1">&#39;Base Weight&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;weight_course&#39;</span><span class="p">:</span> <span class="s1">&#39;Course Weight&#39;</span><span class="p">,</span>
                                   <span class="s2">&quot;sf_om&quot;</span><span class="p">:</span> <span class="s2">&quot;SF OM&quot;</span><span class="p">,</span> <span class="s1">&#39;usafa&#39;</span><span class="p">:</span> <span class="s1">&#39;USAFA&#39;</span><span class="p">,</span> <span class="s1">&#39;soc&#39;</span><span class="p">:</span> <span class="s1">&#39;SOC&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;male&#39;</span><span class="p">:</span> <span class="s1">&#39;Male&#39;</span><span class="p">,</span> <span class="s1">&#39;minority&#39;</span><span class="p">:</span> <span class="s1">&#39;Minority&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;race&#39;</span><span class="p">:</span> <span class="s1">&#39;Race&#39;</span><span class="p">,</span> <span class="s2">&quot;ethnicity&quot;</span><span class="p">:</span> <span class="s2">&quot;Ethnicity&quot;</span><span class="p">,</span> <span class="s1">&#39;asc1&#39;</span><span class="p">:</span> <span class="s1">&#39;ASC1&#39;</span><span class="p">,</span> <span class="s1">&#39;asc2&#39;</span><span class="p">:</span> <span class="s1">&#39;ASC2&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;stem&#39;</span><span class="p">:</span> <span class="s1">&#39;STEM&#39;</span><span class="p">,</span> <span class="s1">&#39;cip1&#39;</span><span class="p">:</span> <span class="s1">&#39;CIP1&#39;</span><span class="p">,</span> <span class="s1">&#39;cip2&#39;</span><span class="p">:</span> <span class="s1">&#39;CIP2&#39;</span><span class="p">,</span> <span class="s1">&#39;merit&#39;</span><span class="p">:</span> <span class="s1">&#39;Merit&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;merit_all&#39;</span><span class="p">:</span> <span class="s1">&#39;Real Merit&#39;</span><span class="p">,</span> <span class="s1">&#39;last_afsc&#39;</span><span class="p">:</span> <span class="s1">&#39;Least Desired AFSC&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;second_to_last_afscs&#39;</span><span class="p">:</span> <span class="s1">&#39;Second Least Desired AFSCs&#39;</span><span class="p">}</span>

    <span class="c1"># Loop through each parameter in the translation dictionary to get &quot;Cadets&quot; dataframe column counterpart</span>
    <span class="n">cadets_columns</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">cadet_parameters_to_columns</span><span class="p">:</span>

        <span class="c1"># If we have the parameter, we create its column</span>
        <span class="k">if</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
            <span class="n">col_name</span> <span class="o">=</span> <span class="n">cadet_parameters_to_columns</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span>
            <span class="n">cadets_columns</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span>

    <span class="c1"># If we had the cadet pafccp/reference/utility columns before, we&#39;ll add them back in</span>
    <span class="k">if</span> <span class="s2">&quot;c_preferences&quot;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>

        <span class="c1"># Add utility columns</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;num_util&quot;</span><span class="p">]):</span>
            <span class="n">cadets_columns</span><span class="p">[</span><span class="s2">&quot;Util_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;c_utilities&quot;</span><span class="p">][:,</span> <span class="n">c</span><span class="p">]</span>

        <span class="c1"># Add preference columns</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">]):</span>
            <span class="n">cadets_columns</span><span class="p">[</span><span class="s2">&quot;Pref_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;c_preferences&quot;</span><span class="p">][:,</span> <span class="n">c</span><span class="p">]</span>

    <span class="c1"># If we have the qual matrix, we add that here</span>
    <span class="k">if</span> <span class="s2">&quot;qual&quot;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>

        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;afscs&quot;</span><span class="p">][:</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">]]):</span>
            <span class="n">cadets_columns</span><span class="p">[</span><span class="s2">&quot;qual_&quot;</span> <span class="o">+</span> <span class="n">afsc</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;qual&#39;</span><span class="p">][:,</span> <span class="n">j</span><span class="p">]</span>

    <span class="c1"># Create dataframe</span>
    <span class="n">cadets_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cadets_columns</span><span class="p">)</span>

    <span class="c1"># Export &#39;Cadets&#39; dataframe</span>
    <span class="n">cadets_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="s2">&quot;Cadets&quot;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="data.processing.export_afsc_cadet_matrices_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">export_afsc_cadet_matrices_data</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span></code>

<a href="#data.processing.export_afsc_cadet_matrices_data" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Exports cadet-AFSC utility and preference matrices from the given <code>Instance</code> object to CSV files.</p>
<p>This function checks for the presence of known matrix-style parameters in the model (e.g., utility values,
preference rankings, interest scores) and exports them to disk. Each matrix is stored as a CSV with cadets
as rows and AFSCs as columns (or vice versa), depending on the context.</p>
<h4 id="data.processing.export_afsc_cadet_matrices_data--parameters">Parameters<a class="headerlink" href="#data.processing.export_afsc_cadet_matrices_data--parameters" title="Permanent link">&para;</a></h4>
<ul>
<li>instance : Instance
  A fully initialized <code>Instance</code> object containing model parameters (<code>parameters</code>),
  value parameters (<code>value_parameters</code>), and export paths.</li>
</ul>
<h4 id="data.processing.export_afsc_cadet_matrices_data--returns">Returns<a class="headerlink" href="#data.processing.export_afsc_cadet_matrices_data--returns" title="Permanent link">&para;</a></h4>
<ul>
<li>None
  The function writes one or more matrix-style datasets to disk if they exist.</li>
</ul>
<h4 id="data.processing.export_afsc_cadet_matrices_data--notes">Notes<a class="headerlink" href="#data.processing.export_afsc_cadet_matrices_data--notes" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>The following parameters will be exported if present:</p>
<ul>
<li><code>utility</code>: Cadet utilities over all AFSCs ‚Üí <code>"Cadets Utility"</code></li>
<li><code>c_pref_matrix</code>: Cadet preferences over all AFSCs ‚Üí <code>"Cadets Preferences"</code></li>
<li><code>afsc_utility</code>: AFSC utilities over all cadets ‚Üí <code>"AFSCs Utility"</code></li>
<li><code>a_pref_matrix</code>: AFSC preferences over all cadets ‚Üí <code>"AFSCs Preferences"</code></li>
<li><code>rr_interest_matrix</code>: ROTC-rated interest scores ‚Üí <code>"ROTC Rated Interest"</code></li>
<li><code>rr_om_matrix</code>: ROTC OM values ‚Üí <code>"ROTC Rated OM"</code></li>
<li><code>ur_om_matrix</code>: USAFA OM values ‚Üí <code>"USAFA Rated OM"</code></li>
<li><code>or_om_matrix</code>: OTS OM values ‚Üí <code>"OTS Rated OM"</code></li>
<li><code>cadet_utility</code>: Finalized cadet utility values ‚Üí <code>"Cadets Utility (Final)"</code></li>
<li><code>c_selected_matrix</code>: Final cadet selection matrix ‚Üí <code>"Cadets Selected"</code></li>
<li><code>a_bucket_matrix</code>: AFSC bucket matrix ‚Üí <code>"AFSCs Buckets"</code></li>
</ul>
</li>
<li>
<p>Each exported dataframe will have a <code>"Cadet"</code> column followed by one column per AFSC in the relevant set.
  The set of AFSCs may vary depending on whether the data is specific to a commissioning source (SOC).</p>
</li>
<li>
<p>Datasets related to specific SOCs (e.g., <code>"ROTC Rated OM"</code>) use filtered cadet subsets and
  AFSCs determined by <code>determine_soc_rated_afscs()</code>.</p>
</li>
</ul>
<h4 id="data.processing.export_afsc_cadet_matrices_data--see-also">See Also<a class="headerlink" href="#data.processing.export_afsc_cadet_matrices_data--see-also" title="Permanent link">&para;</a></h4>
<ul>
<li><a href="../../../afccp/reference/data/preferences/#data.preferences.determine_soc_rated_afscs"><code>determine_soc_rated_afscs</code></a></li>
<li><a href="../../../afccp/reference/data/processing/#data.processing.import_afsc_cadet_matrices_data"><code>import_afsc_cadet_matrices_data</code></a></li>
<li><a href="../../../afccp/reference/data/processing/#data.processing.initialize_file_information"><code>initialize_file_information</code></a></li>
</ul>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">export_afsc_cadet_matrices_data</span><span class="p">(</span><span class="n">instance</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Exports cadet-AFSC utility and preference matrices from the given `Instance` object to CSV files.</span>

<span class="sd">    This function checks for the presence of known matrix-style parameters in the model (e.g., utility values,</span>
<span class="sd">    preference rankings, interest scores) and exports them to disk. Each matrix is stored as a CSV with cadets</span>
<span class="sd">    as rows and AFSCs as columns (or vice versa), depending on the context.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    - instance : Instance</span>
<span class="sd">      A fully initialized `Instance` object containing model parameters (`parameters`),</span>
<span class="sd">      value parameters (`value_parameters`), and export paths.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    - None</span>
<span class="sd">      The function writes one or more matrix-style datasets to disk if they exist.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - The following parameters will be exported if present:</span>

<span class="sd">        - `utility`: Cadet utilities over all AFSCs ‚Üí `&quot;Cadets Utility&quot;`</span>
<span class="sd">        - `c_pref_matrix`: Cadet preferences over all AFSCs ‚Üí `&quot;Cadets Preferences&quot;`</span>
<span class="sd">        - `afsc_utility`: AFSC utilities over all cadets ‚Üí `&quot;AFSCs Utility&quot;`</span>
<span class="sd">        - `a_pref_matrix`: AFSC preferences over all cadets ‚Üí `&quot;AFSCs Preferences&quot;`</span>
<span class="sd">        - `rr_interest_matrix`: ROTC-rated interest scores ‚Üí `&quot;ROTC Rated Interest&quot;`</span>
<span class="sd">        - `rr_om_matrix`: ROTC OM values ‚Üí `&quot;ROTC Rated OM&quot;`</span>
<span class="sd">        - `ur_om_matrix`: USAFA OM values ‚Üí `&quot;USAFA Rated OM&quot;`</span>
<span class="sd">        - `or_om_matrix`: OTS OM values ‚Üí `&quot;OTS Rated OM&quot;`</span>
<span class="sd">        - `cadet_utility`: Finalized cadet utility values ‚Üí `&quot;Cadets Utility (Final)&quot;`</span>
<span class="sd">        - `c_selected_matrix`: Final cadet selection matrix ‚Üí `&quot;Cadets Selected&quot;`</span>
<span class="sd">        - `a_bucket_matrix`: AFSC bucket matrix ‚Üí `&quot;AFSCs Buckets&quot;`</span>

<span class="sd">    - Each exported dataframe will have a `&quot;Cadet&quot;` column followed by one column per AFSC in the relevant set.</span>
<span class="sd">      The set of AFSCs may vary depending on whether the data is specific to a commissioning source (SOC).</span>

<span class="sd">    - Datasets related to specific SOCs (e.g., `&quot;ROTC Rated OM&quot;`) use filtered cadet subsets and</span>
<span class="sd">      AFSCs determined by `determine_soc_rated_afscs()`.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    - [`determine_soc_rated_afscs`](../../../afccp/reference/data/preferences/#data.preferences.determine_soc_rated_afscs)</span>
<span class="sd">    - [`import_afsc_cadet_matrices_data`](../../../afccp/reference/data/processing/#data.processing.import_afsc_cadet_matrices_data)</span>
<span class="sd">    - [`initialize_file_information`](../../../afccp/reference/data/processing/#data.processing.initialize_file_information)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">vp</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span> <span class="n">instance</span><span class="o">.</span><span class="n">value_parameters</span>

    <span class="c1"># Dataset name translations</span>
    <span class="n">parameter_trans_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;utility&quot;</span><span class="p">:</span> <span class="s2">&quot;Cadets Utility&quot;</span><span class="p">,</span> <span class="s2">&quot;c_pref_matrix&quot;</span><span class="p">:</span> <span class="s2">&quot;Cadets Preferences&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;afsc_utility&quot;</span><span class="p">:</span> <span class="s2">&quot;AFSCs Utility&quot;</span><span class="p">,</span> <span class="s2">&quot;a_pref_matrix&quot;</span><span class="p">:</span> <span class="s2">&quot;AFSCs Preferences&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;rr_interest_matrix&quot;</span><span class="p">:</span> <span class="s2">&quot;ROTC Rated Interest&quot;</span><span class="p">,</span> <span class="s2">&quot;rr_om_matrix&quot;</span><span class="p">:</span> <span class="s2">&quot;ROTC Rated OM&quot;</span><span class="p">,</span>
                            <span class="s1">&#39;ur_om_matrix&#39;</span><span class="p">:</span> <span class="s1">&#39;USAFA Rated OM&#39;</span><span class="p">,</span> <span class="s1">&#39;or_om_matrix&#39;</span><span class="p">:</span> <span class="s1">&#39;OTS Rated OM&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;cadet_utility&#39;</span><span class="p">:</span> <span class="s1">&#39;Cadets Utility (Final)&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;c_selected_matrix&#39;</span><span class="p">:</span> <span class="s1">&#39;Cadets Selected&#39;</span><span class="p">,</span> <span class="s1">&#39;a_bucket_matrix&#39;</span><span class="p">:</span> <span class="s1">&#39;AFSCs Buckets&#39;</span>
                            <span class="p">}</span>

    <span class="c1"># Get all rated AFSCs</span>
    <span class="n">all_rated_afscs</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^Rated&#39;</span><span class="p">]]</span>

    <span class="c1"># Loop through each potential dataset to export</span>
    <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">parameter_trans_dict</span><span class="p">:</span>

        <span class="c1"># If we have this dataset, we export it</span>
        <span class="k">if</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
            <span class="n">dataset</span> <span class="o">=</span> <span class="n">parameter_trans_dict</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span>

            <span class="c1"># Construct the dataframe</span>
            <span class="k">if</span> <span class="s1">&#39;ROTC&#39;</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">:</span>
                <span class="n">cadet_indices</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;Rated Cadets&quot;</span><span class="p">][</span><span class="s1">&#39;rotc&#39;</span><span class="p">]</span>
                <span class="n">pref_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Cadet&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadets&#39;</span><span class="p">][</span><span class="n">cadet_indices</span><span class="p">]})</span>
                <span class="n">afscs</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">determine_soc_rated_afscs</span><span class="p">(</span>
                    <span class="n">soc</span><span class="o">=</span><span class="s1">&#39;rotc&#39;</span><span class="p">,</span> <span class="n">all_rated_afscs</span><span class="o">=</span><span class="n">all_rated_afscs</span><span class="p">)</span>
            <span class="k">elif</span> <span class="s1">&#39;USAFA&#39;</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">:</span>
                <span class="n">cadet_indices</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;Rated Cadets&quot;</span><span class="p">][</span><span class="s1">&#39;usafa&#39;</span><span class="p">]</span>
                <span class="n">pref_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Cadet&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadets&#39;</span><span class="p">][</span><span class="n">cadet_indices</span><span class="p">]})</span>
                <span class="n">afscs</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">determine_soc_rated_afscs</span><span class="p">(</span>
                    <span class="n">soc</span><span class="o">=</span><span class="s1">&#39;usafa&#39;</span><span class="p">,</span> <span class="n">all_rated_afscs</span><span class="o">=</span><span class="n">all_rated_afscs</span><span class="p">)</span>
            <span class="k">elif</span> <span class="s1">&#39;OTS&#39;</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">:</span>
                <span class="n">cadet_indices</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;Rated Cadets&quot;</span><span class="p">][</span><span class="s1">&#39;ots&#39;</span><span class="p">]</span>
                <span class="n">pref_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Cadet&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadets&#39;</span><span class="p">][</span><span class="n">cadet_indices</span><span class="p">]})</span>
                <span class="n">afscs</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">determine_soc_rated_afscs</span><span class="p">(</span>
                    <span class="n">soc</span><span class="o">=</span><span class="s1">&#39;ots&#39;</span><span class="p">,</span> <span class="n">all_rated_afscs</span><span class="o">=</span><span class="n">all_rated_afscs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pref_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Cadet&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;cadets&quot;</span><span class="p">]})</span>
                <span class="n">afscs</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;afscs&quot;</span><span class="p">][:</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">]]</span>

            <span class="c1"># Add the AFSC columns</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">afscs</span><span class="p">):</span>
                <span class="n">pref_df</span><span class="p">[</span><span class="n">afsc</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">parameter</span><span class="p">][:,</span> <span class="n">j</span><span class="p">]</span>

            <span class="c1"># Export the dataset</span>
            <span class="n">pref_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="n">dataset</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="data.processing.export_value_parameters_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">export_value_parameters_data</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span></code>

<a href="#data.processing.export_value_parameters_data" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Export value parameter datasets and related information to CSV files for analysis.</p>
<p>This function extracts and exports optimization value parameter sets, global utility matrices (if available),
and cadet-specific constraints. It supports multiple value parameter configurations by exporting separate
files per set. This facilitates analysis, debugging, or visualization of value-based multi-objective optimization.</p>
<h4 id="data.processing.export_value_parameters_data--parameters">Parameters<a class="headerlink" href="#data.processing.export_value_parameters_data--parameters" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>instance : Instance
  A configured instance of the CadetCareerProblem class, including:</p>
<ul>
<li><code>vp_dict</code>: Dictionary of value parameter sets</li>
<li><code>value_parameters</code>: Active value parameter configuration</li>
<li><code>parameters</code>: General instance parameters (e.g., AFSCs, cadets)</li>
<li><code>export_paths</code>: File paths for saving exports</li>
</ul>
</li>
</ul>
<h4 id="data.processing.export_value_parameters_data--returns">Returns<a class="headerlink" href="#data.processing.export_value_parameters_data--returns" title="Permanent link">&para;</a></h4>
<p>None
  The function writes multiple CSV files to disk for each available dataset.</p>
<p>This command will generate:
- A separate CSV file for each set of value parameters (e.g., weights, targets, value functions)
- An overall summary CSV file of value parameter metadata
- A cadet-level constraints CSV file (min values per cadet per VP set)
- A global utility matrix CSV (if <code>global_utility</code> is present in a VP set)</p>
<h4 id="data.processing.export_value_parameters_data--notes">Notes<a class="headerlink" href="#data.processing.export_value_parameters_data--notes" title="Permanent link">&para;</a></h4>
<ul>
<li>Value function breakpoints <code>a</code> and values <code>f^hat</code> are stored as comma-separated strings for readability.</li>
<li>Objective weights are scaled to a 0‚Äì100 range and normalized per AFSC.</li>
<li>
<p>The output files use naming conventions like:</p>
<ul>
<li><code>{data_name} {vp_name}.csv</code></li>
<li><code>{data_name} {vp_name} Global Utility.csv</code></li>
<li>These files are versioned if the instance's data version is not <code>"Default"</code>.</li>
</ul>
</li>
</ul>
<h4 id="data.processing.export_value_parameters_data--see-also">See Also<a class="headerlink" href="#data.processing.export_value_parameters_data--see-also" title="Permanent link">&para;</a></h4>
<ul>
<li><a href="../../../afccp/reference/data/processing/#data.processing.import_value_parameters_data"><code>import_value_parameters_data</code></a></li>
<li><a href="../../../afccp/reference/data/processing/#data.processing.initialize_file_information"><code>initialize_file_information</code></a></li>
</ul>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">export_value_parameters_data</span><span class="p">(</span><span class="n">instance</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Export value parameter datasets and related information to CSV files for analysis.</span>

<span class="sd">    This function extracts and exports optimization value parameter sets, global utility matrices (if available),</span>
<span class="sd">    and cadet-specific constraints. It supports multiple value parameter configurations by exporting separate</span>
<span class="sd">    files per set. This facilitates analysis, debugging, or visualization of value-based multi-objective optimization.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    - instance : Instance</span>
<span class="sd">      A configured instance of the CadetCareerProblem class, including:</span>

<span class="sd">        - `vp_dict`: Dictionary of value parameter sets</span>
<span class="sd">        - `value_parameters`: Active value parameter configuration</span>
<span class="sd">        - `parameters`: General instance parameters (e.g., AFSCs, cadets)</span>
<span class="sd">        - `export_paths`: File paths for saving exports</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>
<span class="sd">      The function writes multiple CSV files to disk for each available dataset.</span>

<span class="sd">    This command will generate:</span>
<span class="sd">    - A separate CSV file for each set of value parameters (e.g., weights, targets, value functions)</span>
<span class="sd">    - An overall summary CSV file of value parameter metadata</span>
<span class="sd">    - A cadet-level constraints CSV file (min values per cadet per VP set)</span>
<span class="sd">    - A global utility matrix CSV (if `global_utility` is present in a VP set)</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - Value function breakpoints `a` and values `f^hat` are stored as comma-separated strings for readability.</span>
<span class="sd">    - Objective weights are scaled to a 0‚Äì100 range and normalized per AFSC.</span>
<span class="sd">    - The output files use naming conventions like:</span>

<span class="sd">        - `{data_name} {vp_name}.csv`</span>
<span class="sd">        - `{data_name} {vp_name} Global Utility.csv`</span>
<span class="sd">    - These files are versioned if the instance&#39;s data version is not `&quot;Default&quot;`.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    - [`import_value_parameters_data`](../../../afccp/reference/data/processing/#data.processing.import_value_parameters_data)</span>
<span class="sd">    - [`initialize_file_information`](../../../afccp/reference/data/processing/#data.processing.initialize_file_information)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span>

    <span class="c1"># Error data</span>
    <span class="k">if</span> <span class="n">instance</span><span class="o">.</span><span class="n">vp_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># No value parameters to export!</span>

    <span class="c1"># Determine how we&#39;re going to show merit for context in the Cadet Constraints dataframe</span>
    <span class="n">merit_col</span> <span class="o">=</span> <span class="s2">&quot;merit&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;merit_all&quot;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
        <span class="n">merit_col</span> <span class="o">=</span> <span class="s2">&quot;merit_all&quot;</span>

    <span class="c1"># Initialize dataframes</span>
    <span class="n">vp_cadet_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Cadet&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;cadets&quot;</span><span class="p">],</span> <span class="s2">&quot;Merit&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="n">merit_col</span><span class="p">]})</span>
    <span class="n">vp_overall_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({})</span>

    <span class="c1"># Loop through each set of value parameters</span>
    <span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">vp_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">vp_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
        <span class="n">vp</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">vp_dict</span><span class="p">[</span><span class="n">vp_name</span><span class="p">]</span>

        <span class="c1"># Initialize Value Function breakpoint arrays</span>
        <span class="n">a_strings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">400</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;J&quot;</span><span class="p">]])</span>
        <span class="n">fhat_strings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">400</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;J&quot;</span><span class="p">]])</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][:</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">]]):</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">objective</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objectives&#39;</span><span class="p">]):</span>
                <span class="n">a_string_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]]</span>
                <span class="n">a_strings</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">a_string_list</span><span class="p">)</span>
                <span class="n">fhat_strings_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;f^hat&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]]</span>
                <span class="n">fhat_strings</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fhat_strings_list</span><span class="p">)</span>

        <span class="c1"># Flatten the 2-d arrays to convert them into one long list that is sorted by AFSC and then by objective</span>
        <span class="n">objective_value_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objective_value_min&#39;</span><span class="p">])</span>
        <span class="n">constraint_type</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;constraint_type&#39;</span><span class="p">])</span>
        <span class="n">objective_target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objective_target&#39;</span><span class="p">])</span>
        <span class="n">value_functions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;value_functions&#39;</span><span class="p">])</span>
        <span class="n">breakpoint_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">a_strings</span><span class="p">)</span>
        <span class="n">breakpoint_fhat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">fhat_strings</span><span class="p">)</span>

        <span class="c1"># AFSC objective swing weights</span>
        <span class="n">max_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objective_weight&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objective_weight&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">/</span> <span class="n">max_weights</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;J&quot;</span><span class="p">]])</span>
        <span class="n">objective_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">ow</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

        <span class="c1"># Repeating objectives</span>
        <span class="n">objectives</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objectives&#39;</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">])</span>

        <span class="c1"># Repeating AFSCs</span>
        <span class="n">afscs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;J&quot;</span><span class="p">])))</span>
        <span class="n">afsc_value_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;afsc_value_min&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;J&quot;</span><span class="p">])))</span>

        <span class="c1"># AFSC swing weights</span>
        <span class="n">afsc_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;afsc_weight&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;afsc_weight&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">afsc_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">afsc_weight</span><span class="p">,</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">])</span>

        <span class="c1"># Create the &quot;vp_df&quot;</span>
        <span class="n">vp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AFSC&#39;</span><span class="p">:</span> <span class="n">afscs</span><span class="p">,</span> <span class="s1">&#39;Objective&#39;</span><span class="p">:</span> <span class="n">objectives</span><span class="p">,</span> <span class="s1">&#39;Objective Weight&#39;</span><span class="p">:</span> <span class="n">objective_weight</span><span class="p">,</span>
                              <span class="s1">&#39;Objective Target&#39;</span><span class="p">:</span> <span class="n">objective_target</span><span class="p">,</span> <span class="s1">&#39;AFSC Weight&#39;</span><span class="p">:</span> <span class="n">afsc_weight</span><span class="p">,</span>
                              <span class="s1">&#39;Min Value&#39;</span><span class="p">:</span> <span class="n">afsc_value_min</span><span class="p">,</span> <span class="s1">&#39;Min Objective Value&#39;</span><span class="p">:</span> <span class="n">objective_value_min</span><span class="p">,</span>
                              <span class="s1">&#39;Constraint Type&#39;</span><span class="p">:</span> <span class="n">constraint_type</span><span class="p">,</span> <span class="s1">&#39;Function Breakpoint Measures (a)&#39;</span><span class="p">:</span> <span class="n">breakpoint_a</span><span class="p">,</span>
                              <span class="s1">&#39;Function Breakpoint Values (f^hat)&#39;</span><span class="p">:</span> <span class="n">breakpoint_fhat</span><span class="p">,</span>
                              <span class="s1">&#39;Value Functions&#39;</span><span class="p">:</span> <span class="n">value_functions</span><span class="p">})</span>

        <span class="c1"># Add the minimum value column for this set of value parameters to the cadets df</span>
        <span class="n">vp_cadet_df</span><span class="p">[</span><span class="n">vp_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">vp</span><span class="p">[</span><span class="s2">&quot;cadet_value_min&quot;</span><span class="p">]</span>

        <span class="c1"># Initialize overall vp column dictionary</span>
        <span class="n">overall_vp_columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;VP Name&#39;</span><span class="p">:</span> <span class="n">vp_name</span><span class="p">,</span>
                              <span class="s1">&#39;Cadets Weight&#39;</span><span class="p">:</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;cadets_overall_weight&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;AFSCs Weight&#39;</span><span class="p">:</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;afscs_overall_weight&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;Cadets Min Value&#39;</span><span class="p">:</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;cadets_overall_value_min&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;AFSCs Min Value&#39;</span><span class="p">:</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;afscs_overall_value_min&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;Cadet Weight Function&#39;</span><span class="p">:</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;cadet_weight_function&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;AFSC Weight Function&#39;</span><span class="p">:</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;afsc_weight_function&#39;</span><span class="p">]}</span>

        <span class="c1"># Add the row for this set of value parameters to the overall df</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">overall_vp_columns</span><span class="p">:</span>
            <span class="n">vp_overall_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">v</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">overall_vp_columns</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>

        <span class="c1"># Determine extension of VP file (in case it&#39;s a different version of data)</span>
        <span class="k">if</span> <span class="n">instance</span><span class="o">.</span><span class="n">data_version</span> <span class="o">==</span> <span class="s2">&quot;Default&quot;</span><span class="p">:</span>
            <span class="n">extension</span> <span class="o">=</span> <span class="s2">&quot;.csv&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">extension</span> <span class="o">=</span> <span class="s2">&quot; (&quot;</span> <span class="o">+</span> <span class="n">instance</span><span class="o">.</span><span class="n">data_version</span> <span class="o">+</span> <span class="s2">&quot;).csv&quot;</span>

        <span class="c1"># Export &#39;VP&#39; dataframe</span>
        <span class="n">vp_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="s2">&quot;Model Input&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">instance</span><span class="o">.</span><span class="n">data_name</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">vp_name</span> <span class="o">+</span> <span class="n">extension</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Create &quot;Global Utility&quot; dataframe if it&#39;s in the value parameters</span>
        <span class="k">if</span> <span class="s2">&quot;global_utility&quot;</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">:</span>
            <span class="n">gu_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Cadet&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadets&#39;</span><span class="p">]})</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][:</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]]):</span>
                <span class="n">gu_df</span><span class="p">[</span><span class="n">afsc</span><span class="p">]</span> <span class="o">=</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;global_utility&#39;</span><span class="p">][:,</span> <span class="n">j</span><span class="p">]</span>

            <span class="c1"># Export &quot;Global Utility&quot; dataframe</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">data_name</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">vp_name</span> <span class="o">+</span> <span class="s2">&quot; Global Utility&quot;</span> <span class="o">+</span> <span class="n">extension</span>
            <span class="n">gu_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="s2">&quot;Model Input&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">filename</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Export &#39;Value Parameters&#39; dataframe</span>
    <span class="n">vp_overall_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="s2">&quot;Value Parameters&quot;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Export &#39;Cadets Utility Constraints&#39; dataframe</span>
    <span class="n">vp_cadet_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="s2">&quot;Cadets Utility Constraints&quot;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="data.processing.export_solutions_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">export_solutions_data</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span></code>

<a href="#data.processing.export_solutions_data" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Export cadet-to-AFSC solution assignments to CSV files.</p>
<p>This function exports all available cadet solution assignments (including AFSC, base, and course solutions)
to CSV files for downstream analysis, visualization, or comparison. Each solution is saved as a column in
the exported file, enabling side-by-side comparison of multiple optimization outcomes.</p>
<h4 id="data.processing.export_solutions_data--parameters">Parameters<a class="headerlink" href="#data.processing.export_solutions_data--parameters" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>instance : Instance
    The problem instance containing:</p>
<ul>
<li><code>parameters</code> ‚Äì model parameter dictionary</li>
<li><code>solutions</code> ‚Äì dictionary of cadet-to-AFSC assignments by solution name</li>
<li><code>export_paths</code> ‚Äì dictionary of destination paths for saving outputs</li>
</ul>
</li>
</ul>
<h4 id="data.processing.export_solutions_data--returns">Returns<a class="headerlink" href="#data.processing.export_solutions_data--returns" title="Permanent link">&para;</a></h4>
<p>None
    The function writes 1 to 3 CSV files to disk, depending on available solution components.</p>
<p>This exports:
- <code>Solutions.csv</code>: Main cadet-to-AFSC assignment matrix
- <code>Base Solutions.csv</code>: Optional cadet-to-base assignments, if present
- <code>Course Solutions.csv</code>: Optional cadet-to-course assignments, if present</p>
<h4 id="data.processing.export_solutions_data--notes">Notes<a class="headerlink" href="#data.processing.export_solutions_data--notes" title="Permanent link">&para;</a></h4>
<ul>
<li>Each file contains cadets in the first column and one or more solution columns following.</li>
<li>Solution names (keys from <code>instance.solutions</code>) define the column headers.</li>
<li>The function safely skips missing data (e.g., base or course assignments are only exported if they exist).</li>
<li>Used primarily to track scenario-based solution outputs from multi-run experiments.</li>
</ul>
<h4 id="data.processing.export_solutions_data--see-also">See Also<a class="headerlink" href="#data.processing.export_solutions_data--see-also" title="Permanent link">&para;</a></h4>
<ul>
<li><a href="../../../afccp/reference/data/processing/#data.processing.import_solutions_data"><code>import_solutions_data</code></a></li>
<li><a href="../../../afccp/reference/data/processing/#data.processing.initialize_file_information"><code>initialize_file_information</code></a></li>
</ul>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">export_solutions_data</span><span class="p">(</span><span class="n">instance</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Export cadet-to-AFSC solution assignments to CSV files.</span>

<span class="sd">    This function exports all available cadet solution assignments (including AFSC, base, and course solutions)</span>
<span class="sd">    to CSV files for downstream analysis, visualization, or comparison. Each solution is saved as a column in</span>
<span class="sd">    the exported file, enabling side-by-side comparison of multiple optimization outcomes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    - instance : Instance</span>
<span class="sd">        The problem instance containing:</span>

<span class="sd">        - `parameters` ‚Äì model parameter dictionary</span>
<span class="sd">        - `solutions` ‚Äì dictionary of cadet-to-AFSC assignments by solution name</span>
<span class="sd">        - `export_paths` ‚Äì dictionary of destination paths for saving outputs</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>
<span class="sd">        The function writes 1 to 3 CSV files to disk, depending on available solution components.</span>

<span class="sd">    This exports:</span>
<span class="sd">    - `Solutions.csv`: Main cadet-to-AFSC assignment matrix</span>
<span class="sd">    - `Base Solutions.csv`: Optional cadet-to-base assignments, if present</span>
<span class="sd">    - `Course Solutions.csv`: Optional cadet-to-course assignments, if present</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - Each file contains cadets in the first column and one or more solution columns following.</span>
<span class="sd">    - Solution names (keys from `instance.solutions`) define the column headers.</span>
<span class="sd">    - The function safely skips missing data (e.g., base or course assignments are only exported if they exist).</span>
<span class="sd">    - Used primarily to track scenario-based solution outputs from multi-run experiments.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    - [`import_solutions_data`](../../../afccp/reference/data/processing/#data.processing.import_solutions_data)</span>
<span class="sd">    - [`initialize_file_information`](../../../afccp/reference/data/processing/#data.processing.initialize_file_information)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span>

    <span class="c1"># Error data</span>
    <span class="k">if</span> <span class="n">instance</span><span class="o">.</span><span class="n">solutions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># No solutions to export!</span>

    <span class="c1"># Initialize solutions dataframe</span>
    <span class="n">solutions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Cadet&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;cadets&quot;</span><span class="p">]})</span>

    <span class="c1"># Loop through each solution and add it to the dataframe</span>
    <span class="k">for</span> <span class="n">solution_name</span> <span class="ow">in</span> <span class="n">instance</span><span class="o">.</span><span class="n">solutions</span><span class="p">:</span>
        <span class="n">solutions_df</span><span class="p">[</span><span class="n">solution_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">solution_name</span><span class="p">][</span><span class="s1">&#39;afsc_array&#39;</span><span class="p">]</span>

    <span class="c1"># Export &#39;Solutions&#39; dataframe</span>
    <span class="n">solutions_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="s2">&quot;Solutions&quot;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Initialize solutions dataframe</span>
    <span class="n">extra_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Base Solutions&quot;</span><span class="p">:</span> <span class="s2">&quot;base_array&quot;</span><span class="p">,</span> <span class="s2">&quot;Course Solutions&quot;</span><span class="p">:</span> <span class="s2">&quot;course_array&quot;</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">df_name</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">extra_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

        <span class="c1"># Get list of solutions that have this extra component</span>
        <span class="n">solution_names_found</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">solution_name</span> <span class="ow">in</span> <span class="n">instance</span><span class="o">.</span><span class="n">solutions</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">instance</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">solution_name</span><span class="p">]:</span>
                <span class="n">solution_names_found</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">solution_name</span><span class="p">)</span>

        <span class="c1"># If we have at least one solution with this base or course component, we create this dataframe</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">solution_names_found</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">solutions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Cadet&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;cadets&quot;</span><span class="p">]})</span>

            <span class="c1"># Loop through each solution with this component and add it to the dataframe</span>
            <span class="k">for</span> <span class="n">solution_name</span> <span class="ow">in</span> <span class="n">solution_names_found</span><span class="p">:</span>
                <span class="n">solutions_df</span><span class="p">[</span><span class="n">solution_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">solution_name</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>

            <span class="c1"># Export extra &#39;Solutions&#39; dataframe</span>
            <span class="n">solutions_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="n">df_name</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="data.processing.export_additional_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">export_additional_data</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span></code>

<a href="#data.processing.export_additional_data" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Export additional configuration and metadata to CSV files.</p>
<p>This function exports all supplementary datasets associated with the problem instance, including base
assignments, base preferences, utility scores, training course data, and CASTLE-AFSC mappings. These
datasets are derived from the <code>instance.parameters</code> dictionary and written to disk using paths from
<code>instance.export_paths</code>.</p>
<h4 id="data.processing.export_additional_data--parameters">Parameters<a class="headerlink" href="#data.processing.export_additional_data--parameters" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>instance : Instance
    The problem instance containing:</p>
<ul>
<li><code>parameters</code> ‚Äì dictionary of model inputs and outputs</li>
<li><code>export_paths</code> ‚Äì dictionary of file paths for each dataset</li>
</ul>
</li>
</ul>
<h4 id="data.processing.export_additional_data--returns">Returns<a class="headerlink" href="#data.processing.export_additional_data--returns" title="Permanent link">&para;</a></h4>
<p>None
    Outputs are written to CSV files; no value is returned.</p>
<p>This generates the following (if applicable):
- <code>Bases.csv</code>: Min/max cadet assignments per AFSC at each base
- <code>Bases Preferences.csv</code>: Cadet preferences over bases
- <code>Bases Utility.csv</code>: Cadet utility scores for each base
- <code>Courses.csv</code>: Course-level details per AFSC (min/max/start)
- <code>Castle Input.csv</code>: CASTLE-to-AFPC AFSC mappings with optional value curves</p>
<h4 id="data.processing.export_additional_data--notes">Notes<a class="headerlink" href="#data.processing.export_additional_data--notes" title="Permanent link">&para;</a></h4>
<ul>
<li>The export is conditional: datasets are only written if their associated parameters exist in <code>instance.parameters</code>.</li>
<li>CASTLE-related data (<code>castle_q</code>, <code>castle_afscs_arr</code>, etc.) must be present to trigger <code>Castle Input.csv</code> export.</li>
<li>Base utility and preference matrices are assumed to be cadet-by-base numpy arrays.</li>
</ul>
<h4 id="data.processing.export_additional_data--see-also">See Also<a class="headerlink" href="#data.processing.export_additional_data--see-also" title="Permanent link">&para;</a></h4>
<ul>
<li><a href="../../../afccp/reference/data/processing/#data.processing.import_additional_data"><code>import_additional_data</code></a></li>
<li><a href="../../../afccp/reference/data/processing/#data.processing.initialize_file_information"><code>initialize_file_information</code></a></li>
</ul>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">export_additional_data</span><span class="p">(</span><span class="n">instance</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Export additional configuration and metadata to CSV files.</span>

<span class="sd">    This function exports all supplementary datasets associated with the problem instance, including base</span>
<span class="sd">    assignments, base preferences, utility scores, training course data, and CASTLE-AFSC mappings. These</span>
<span class="sd">    datasets are derived from the `instance.parameters` dictionary and written to disk using paths from</span>
<span class="sd">    `instance.export_paths`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    - instance : Instance</span>
<span class="sd">        The problem instance containing:</span>

<span class="sd">        - `parameters` ‚Äì dictionary of model inputs and outputs</span>
<span class="sd">        - `export_paths` ‚Äì dictionary of file paths for each dataset</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>
<span class="sd">        Outputs are written to CSV files; no value is returned.</span>

<span class="sd">    This generates the following (if applicable):</span>
<span class="sd">    - `Bases.csv`: Min/max cadet assignments per AFSC at each base</span>
<span class="sd">    - `Bases Preferences.csv`: Cadet preferences over bases</span>
<span class="sd">    - `Bases Utility.csv`: Cadet utility scores for each base</span>
<span class="sd">    - `Courses.csv`: Course-level details per AFSC (min/max/start)</span>
<span class="sd">    - `Castle Input.csv`: CASTLE-to-AFPC AFSC mappings with optional value curves</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - The export is conditional: datasets are only written if their associated parameters exist in `instance.parameters`.</span>
<span class="sd">    - CASTLE-related data (`castle_q`, `castle_afscs_arr`, etc.) must be present to trigger `Castle Input.csv` export.</span>
<span class="sd">    - Base utility and preference matrices are assumed to be cadet-by-base numpy arrays.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    - [`import_additional_data`](../../../afccp/reference/data/processing/#data.processing.import_additional_data)</span>
<span class="sd">    - [`initialize_file_information`](../../../afccp/reference/data/processing/#data.processing.initialize_file_information)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span>

    <span class="c1"># See if we can export the &quot;Bases&quot; csv file</span>
    <span class="k">if</span> <span class="s2">&quot;bases&quot;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>

        <span class="c1"># Initialize dataframe</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Base&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;bases&#39;</span><span class="p">]})</span>

        <span class="c1"># Add &quot;minimum&quot; # to assign to each base by AFSC</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]:</span>
            <span class="n">afsc</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
            <span class="n">df</span><span class="p">[</span><span class="n">afsc</span> <span class="o">+</span> <span class="s1">&#39; Min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;base_min&#39;</span><span class="p">][:,</span> <span class="n">j</span><span class="p">]</span>

        <span class="c1"># Add &quot;maximum&quot; # to assign to each base by AFSC</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]:</span>
            <span class="n">afsc</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
            <span class="n">df</span><span class="p">[</span><span class="n">afsc</span> <span class="o">+</span> <span class="s1">&#39; Max&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;base_max&#39;</span><span class="p">][:,</span> <span class="n">j</span><span class="p">]</span>

        <span class="c1"># Export the dataset</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="s2">&quot;Bases&quot;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Export base preferences/utility if applicable</span>
    <span class="k">for</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;b_pref_matrix&#39;</span><span class="p">:</span> <span class="s1">&#39;Bases Preferences&#39;</span><span class="p">,</span> <span class="s1">&#39;base_utility&#39;</span><span class="p">:</span> <span class="s1">&#39;Bases Utility&#39;</span><span class="p">}</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>

            <span class="c1"># Initialize dataframe</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Cadet&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadets&#39;</span><span class="p">]})</span>

            <span class="c1"># Add base columns</span>
            <span class="k">for</span> <span class="n">b</span><span class="p">,</span> <span class="n">base</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;bases&#39;</span><span class="p">]):</span>
                <span class="n">df</span><span class="p">[</span><span class="n">base</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">parameter</span><span class="p">][:,</span> <span class="n">b</span><span class="p">]</span>

            <span class="c1"># Export the dataset</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="n">dataset</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Export training course data if applicable</span>
    <span class="k">if</span> <span class="s1">&#39;courses&#39;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>

        <span class="c1"># Dictionary to translate parameter names to column names</span>
        <span class="n">column_translation</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Course&quot;</span><span class="p">:</span> <span class="s1">&#39;courses&#39;</span><span class="p">,</span> <span class="s1">&#39;Start Date&#39;</span><span class="p">:</span> <span class="s1">&#39;course_start&#39;</span><span class="p">,</span> <span class="s1">&#39;Min&#39;</span><span class="p">:</span> <span class="s1">&#39;course_min&#39;</span><span class="p">,</span> <span class="s1">&#39;Max&#39;</span><span class="p">:</span> <span class="s1">&#39;course_max&#39;</span><span class="p">}</span>

        <span class="c1"># Initialize dictionary of new columns</span>
        <span class="n">new_cols</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;AFSC&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">])]}</span>

        <span class="c1"># Create each column for this dataset</span>
        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">column_translation</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_cols</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">param</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">])]</span>

        <span class="c1"># Create dataframe</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">new_cols</span><span class="p">)</span>

        <span class="c1"># Export the dataframe</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="s1">&#39;Courses&#39;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Export Castle AFSCs data</span>
    <span class="k">if</span> <span class="s1">&#39;castle_afscs_arr&#39;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>

        <span class="c1"># Create dataframe</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AFPC AFSC&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;afpc_afscs_arr&#39;</span><span class="p">],</span>
                           <span class="s1">&#39;CASTLE AFSC&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;castle_afscs_arr&#39;</span><span class="p">]})</span>

        <span class="c1"># Add in value curve data</span>
        <span class="k">if</span> <span class="s1">&#39;castle_q&#39;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;castle_q&#39;</span><span class="p">][</span><span class="s1">&#39;a&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">],</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span> <span class="k">for</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;castle_afscs_arr&#39;</span><span class="p">]]</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;f^hat&#39;</span><span class="p">]</span> <span class="o">=</span> \
                <span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;castle_q&#39;</span><span class="p">][</span><span class="s1">&#39;f^hat&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">],</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span> <span class="k">for</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;castle_afscs_arr&#39;</span><span class="p">]]</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Optimal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;optimal_policy&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">]</span> <span class="k">for</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;castle_afscs_arr&#39;</span><span class="p">]]</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;OTS Count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;ots_counts&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">]</span> <span class="k">for</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;castle_afscs_arr&#39;</span><span class="p">]]</span>

        <span class="c1"># Export the dataframe</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="s1">&#39;Castle Input&#39;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="data.processing.export_solution_results" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">export_solution_results</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">filepath</span><span class="p">)</span></code>

<a href="#data.processing.export_solution_results" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Export a comprehensive Excel workbook of solution results.</p>
<p>This function generates an Excel file containing detailed outputs from a solved cadet-AFSC assignment instance,
including objective values, cadet assignments, constraint violations, and other performance metrics. The resulting
Excel workbook supports deep post-solution analysis and includes conditional formatting for visual clarity.</p>
<h4 id="data.processing.export_solution_results--parameters">Parameters<a class="headerlink" href="#data.processing.export_solution_results--parameters" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>instance : Instance
  An object representing the solved assignment problem. Must contain:</p>
</li>
<li>
<p><code>parameters</code> (dict): Problem data</p>
</li>
<li><code>value_parameters</code> (dict): Objective metadata and weights</li>
<li><code>solution</code> (dict): Final solution output (e.g., assignments, utilities, choice rankings)</li>
<li><code>mdl_p</code> (dict): Metadata including formatting options</li>
<li>filepath : str
  Full path where the Excel file will be saved (e.g., <code>"output/solution_results.xlsx"</code>)</li>
</ul>
<h4 id="data.processing.export_solution_results--returns">Returns<a class="headerlink" href="#data.processing.export_solution_results--returns" title="Permanent link">&para;</a></h4>
<p>None
  Writes an <code>.xlsx</code> file to disk containing multiple sheets of structured solution data.</p>
<h4 id="data.processing.export_solution_results--excel-output-includes">Excel Output Includes<a class="headerlink" href="#data.processing.export_solution_results--excel-output-includes" title="Permanent link">&para;</a></h4>
<ul>
<li>Main: High-level metrics, objective value, choice counts, and performance indicators</li>
<li>Objective Measures: AFSC scores for each weighted objective</li>
<li>Constraint Fails: Constraint violations by AFSC</li>
<li>Objective Values: Weighted performance per AFSC with visual scoring heatmaps</li>
<li>Solution: Per-cadet assignment breakdown with preferences, utilities, base/course matches</li>
<li>X, V, Q (optional): Assignment matrices for AFSCs, bases, and training courses</li>
<li>Lambda, Y (optional): Value function parameters per AFSC and objective</li>
<li>Castle Metrics (if applicable): Metrics for CASTLE-mode AFSCs</li>
<li>Blocking Pairs (if present): Cadet-AFSC blocking violations</li>
</ul>
<h4 id="data.processing.export_solution_results--notes">Notes<a class="headerlink" href="#data.processing.export_solution_results--notes" title="Permanent link">&para;</a></h4>
<ul>
<li>Conditional formatting is applied to highlight preference rankings, merit scores, and match quality.</li>
<li>The function handles presence or absence of optional components (e.g., base matching, training courses).</li>
<li>Top 10 cadet choices and utilities are shown in the Solution tab for deeper preference analysis.</li>
</ul>
<h4 id="data.processing.export_solution_results--see-also">See Also<a class="headerlink" href="#data.processing.export_solution_results--see-also" title="Permanent link">&para;</a></h4>
<ul>
<li><a href="../../../afccp/reference/data/processing/#data.processing.draw_frame_border_outside"><code>draw_frame_border_outside</code></a></li>
</ul>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">export_solution_results</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">filepath</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Export a comprehensive Excel workbook of solution results.</span>

<span class="sd">    This function generates an Excel file containing detailed outputs from a solved cadet-AFSC assignment instance,</span>
<span class="sd">    including objective values, cadet assignments, constraint violations, and other performance metrics. The resulting</span>
<span class="sd">    Excel workbook supports deep post-solution analysis and includes conditional formatting for visual clarity.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    - instance : Instance</span>
<span class="sd">      An object representing the solved assignment problem. Must contain:</span>

<span class="sd">      - `parameters` (dict): Problem data</span>
<span class="sd">      - `value_parameters` (dict): Objective metadata and weights</span>
<span class="sd">      - `solution` (dict): Final solution output (e.g., assignments, utilities, choice rankings)</span>
<span class="sd">      - `mdl_p` (dict): Metadata including formatting options</span>
<span class="sd">    - filepath : str</span>
<span class="sd">      Full path where the Excel file will be saved (e.g., `&quot;output/solution_results.xlsx&quot;`)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>
<span class="sd">      Writes an `.xlsx` file to disk containing multiple sheets of structured solution data.</span>

<span class="sd">    Excel Output Includes</span>
<span class="sd">    ---------------------</span>
<span class="sd">    - Main: High-level metrics, objective value, choice counts, and performance indicators</span>
<span class="sd">    - Objective Measures: AFSC scores for each weighted objective</span>
<span class="sd">    - Constraint Fails: Constraint violations by AFSC</span>
<span class="sd">    - Objective Values: Weighted performance per AFSC with visual scoring heatmaps</span>
<span class="sd">    - Solution: Per-cadet assignment breakdown with preferences, utilities, base/course matches</span>
<span class="sd">    - X, V, Q (optional): Assignment matrices for AFSCs, bases, and training courses</span>
<span class="sd">    - Lambda, Y (optional): Value function parameters per AFSC and objective</span>
<span class="sd">    - Castle Metrics (if applicable): Metrics for CASTLE-mode AFSCs</span>
<span class="sd">    - Blocking Pairs (if present): Cadet-AFSC blocking violations</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - Conditional formatting is applied to highlight preference rankings, merit scores, and match quality.</span>
<span class="sd">    - The function handles presence or absence of optional components (e.g., base matching, training courses).</span>
<span class="sd">    - Top 10 cadet choices and utilities are shown in the Solution tab for deeper preference analysis.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    - [`draw_frame_border_outside`](../../../afccp/reference/data/processing/#data.processing.draw_frame_border_outside)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">solution</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span> <span class="n">instance</span><span class="o">.</span><span class="n">value_parameters</span><span class="p">,</span> <span class="n">instance</span><span class="o">.</span><span class="n">solution</span>
    <span class="n">mdl_p</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">mdl_p</span>

    <span class="c1"># Get list of excel columns in order (&quot;A&quot;, &quot;AB&quot;, etc.)</span>
    <span class="n">alphabet</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span><span class="p">)</span>
    <span class="n">excel_columns</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">alphabet</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">alphabet</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">letter_2</span> <span class="ow">in</span> <span class="n">alphabet</span><span class="p">:</span>
            <span class="n">excel_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">letter</span> <span class="o">+</span> <span class="n">letter_2</span><span class="p">)</span>

    <span class="c1"># Create a Pandas Excel writer using XlsxWriter as the engine.</span>
    <span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;xlsxwriter&#39;</span><span class="p">)</span>

    <span class="c1"># Get the xlsxwriter objects from the dataframe writer object.</span>
    <span class="n">workbook</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">book</span>
    <span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s2">&quot;Main&quot;</span><span class="p">)</span>

    <span class="c1"># Make the background white initially</span>
    <span class="n">white_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;font_color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;font_size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;font_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Calibri&#39;</span><span class="p">})</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
            <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">white_format</span><span class="p">)</span>

    <span class="c1"># Merge cells</span>
    <span class="n">merge_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;font_color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;font_size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;font_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span> <span class="s1">&#39;border_color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="s2">&quot;B2:D2&quot;</span><span class="p">,</span> <span class="s2">&quot;VFT Overall Metrics&quot;</span><span class="p">,</span> <span class="n">merge_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="s2">&quot;F2:G2&quot;</span><span class="p">,</span> <span class="s2">&quot;Additional Metrics&quot;</span><span class="p">,</span> <span class="n">merge_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;I2&#39;</span><span class="p">,</span> <span class="s1">&#39;Preference&#39;</span><span class="p">,</span> <span class="n">merge_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;J2&#39;</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">merge_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;Proportion&#39;</span><span class="p">,</span> <span class="n">merge_format</span><span class="p">)</span>

    <span class="c1"># Objective Value</span>
    <span class="n">obj_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;font_color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span>
                                      <span class="s1">&#39;font_size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;font_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                      <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span> <span class="s1">&#39;border_color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="s2">&quot;C6:D6&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span> <span class="n">obj_format</span><span class="p">)</span>

    <span class="c1"># Other cells</span>
    <span class="n">cell_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;font_color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;font_size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;font_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span> <span class="s1">&#39;border_color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;VFT&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="s1">&#39;Cadets&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="s1">&#39;AFSCs&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B6&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;D3&#39;</span><span class="p">,</span> <span class="s1">&#39;Weight&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>

    <span class="c1"># Basic format</span>
    <span class="n">cell_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;font_color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;font_size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;font_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="s1">&#39;border_color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

    <span class="c1"># Choice Counts</span>
    <span class="n">choice_dict</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;First&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;Second&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;Third&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="s2">&quot;Fourth&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="s2">&quot;Fifth&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="s2">&quot;Sixth&quot;</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="s2">&quot;Seventh&quot;</span><span class="p">,</span>
                   <span class="mi">8</span><span class="p">:</span> <span class="s2">&quot;Eighth&quot;</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="s2">&quot;Ninth&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="s2">&quot;Tenth&quot;</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span> <span class="n">choice_dict</span><span class="p">:</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;J&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">choice</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;cadet_choice_counts&#39;</span><span class="p">][</span><span class="n">choice</span><span class="p">]),</span> <span class="n">cell_format</span><span class="p">)</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;I&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">choice</span><span class="p">),</span> <span class="n">choice_dict</span><span class="p">[</span><span class="n">choice</span><span class="p">],</span> <span class="n">cell_format</span><span class="p">)</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;K&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">choice</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;cadet_choice_counts&#39;</span><span class="p">][</span><span class="n">choice</span><span class="p">]</span> <span class="o">/</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;N^Match&#39;</span><span class="p">],</span> <span class="mi">3</span><span class="p">),</span>
                        <span class="n">cell_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;I&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">choice</span><span class="p">),</span> <span class="s2">&quot;All Others&quot;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;J&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">choice</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;cadet_choice_counts&#39;</span><span class="p">][</span><span class="s1">&#39;All Others&#39;</span><span class="p">]),</span> <span class="n">cell_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;K&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">choice</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;cadet_choice_counts&#39;</span><span class="p">][</span><span class="s2">&quot;All Others&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;N^Match&#39;</span><span class="p">],</span> <span class="mi">3</span><span class="p">),</span>
                    <span class="n">cell_format</span><span class="p">)</span>

    <span class="c1"># Additional solution metrics</span>
    <span class="n">name_metric_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Blocking Pairs&#39;</span><span class="p">:</span> <span class="s1">&#39;num_blocking_pairs&#39;</span><span class="p">,</span> <span class="s1">&#39;Ineligible Cadets&#39;</span><span class="p">:</span> <span class="s1">&#39;num_ineligible&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Unmatched Cadets&#39;</span><span class="p">:</span> <span class="s1">&#39;num_unmatched&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Top 3 Choices (Proportion) for USSF&#39;</span><span class="p">:</span> <span class="s1">&#39;top_3_ussf_count&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Top 3 Choices (Proportion) for USAF&#39;</span><span class="p">:</span> <span class="s1">&#39;top_3_usaf_count&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Top 3 Choices (Proportion) for USAFA&#39;</span><span class="p">:</span> <span class="s1">&#39;top_3_usafa_count&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Top 3 Choices (Proportion) for ROTC&#39;</span><span class="p">:</span> <span class="s1">&#39;top_3_rotc_count&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Top 3 Choices (Proportion) for OTS&#39;</span><span class="p">:</span> <span class="s1">&#39;top_3_ots_count&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Average Cadet Choice&#39;</span><span class="p">:</span> <span class="s1">&#39;average_cadet_choice&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Average Normalized AFSC Score&#39;</span><span class="p">:</span> <span class="s1">&#39;weighted_average_afsc_score&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Average NRL Normalized AFSC Score&#39;</span><span class="p">:</span> <span class="s1">&#39;weighted_average_nrl_afsc_score&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Failed Constraints&#39;</span><span class="p">:</span> <span class="s1">&#39;total_failed_constraints&#39;</span><span class="p">,</span> <span class="s1">&#39;USSF OM&#39;</span><span class="p">:</span> <span class="s1">&#39;ussf_om&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Global Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;z^gu&#39;</span><span class="p">,</span> <span class="s1">&#39;Cadet Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;cadet_utility_overall&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;z^CASTLE&#39;</span><span class="p">:</span> <span class="s1">&#39;z^CASTLE&#39;</span><span class="p">,</span> <span class="s1">&#39;z^CASTLE (Values)&#39;</span><span class="p">:</span> <span class="s1">&#39;z^CASTLE (Values)&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;AFSC Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;afsc_utility_overall&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;USAFA Cadet Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;usafa_cadet_utility&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;ROTC Cadet Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;rotc_cadet_utility&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;OTS Cadet Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;ots_cadet_utility&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;USSF Cadet Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;ussf_cadet_utility&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;USAF Cadet Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;usaf_cadet_utility&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;USSF AFSC Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;ussf_afsc_utility&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;USAF AFSC Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;usaf_afsc_utility&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;OTS Average Cadet Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;OTS Average Cadet Utility&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;OTS Average AFSC Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;OTS Average AFSC Utility&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Average Normalized AFSC Score (USSF)&#39;</span><span class="p">:</span> <span class="s1">&#39;weighted_average_ussf_afsc_score&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Average Normalized AFSC Score (USAF)&#39;</span><span class="p">:</span> <span class="s1">&#39;weighted_average_usaf_afsc_score&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;USAFA USSF Cadets / USAFA USSF PGL&#39;</span><span class="p">:</span> <span class="s1">&#39;ussf_usafa_pgl_target&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;ROTC USSF Cadets / ROTC USSF PGL&#39;</span><span class="p">:</span> <span class="s1">&#39;ussf_rotc_pgl_target&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Cadets Successfully Constrained to Accessions Group / Total Fixed Accession Group Slots&#39;</span><span class="p">:</span>
                            <span class="s1">&#39;constrained_acc_grp_target&#39;</span><span class="p">,</span>
                        <span class="s2">&quot;Cadets Successfully Constrained to AFSC / Total Fixed AFSC Slots&quot;</span><span class="p">:</span>
                            <span class="s1">&#39;cadets_fixed_correctly&#39;</span><span class="p">,</span>
                        <span class="s2">&quot;Cadets Successfully Reserved to AFSC / Total Reserved AFSC Slots&quot;</span><span class="p">:</span>
                            <span class="s1">&#39;cadets_reserved_correctly&#39;</span><span class="p">,</span>
                        <span class="s2">&quot;Successful Alternate List Scenarios / Total Possible Alternate List Scenarios&quot;</span><span class="p">:</span>
                            <span class="s1">&#39;alternate_list_metric&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;OTS &quot;Must Match&quot; Candidates / Total Matched OTS Candidates&#39;</span><span class="p">:</span> <span class="s1">&#39;matched_out_of_must_match&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;OTS Candidates receiving an AFSC they selected &#39;</span><span class="p">:</span> <span class="s1">&#39;OTS Selected Pref Count&#39;</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">acc_grp</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs_acc_grp&#39;</span><span class="p">]:</span>
        <span class="n">name_metric_dict</span><span class="p">[</span><span class="n">acc_grp</span> <span class="o">+</span> <span class="s2">&quot; Racial Simpson Index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;simpson_index_&#39;</span> <span class="o">+</span> <span class="n">acc_grp</span>

    <span class="c1"># Add these metrics into excel</span>
    <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">name_metric_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
        <span class="k">if</span> <span class="n">name_metric_dict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">:</span>

            <span class="c1"># Sometimes we can&#39;t write in a value for a solution metric that is incomplete</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;F&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">r</span><span class="p">),</span> <span class="n">name</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;G&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">r</span><span class="p">),</span> <span class="n">solution</span><span class="p">[</span><span class="n">name_metric_dict</span><span class="p">[</span><span class="n">name</span><span class="p">]],</span> <span class="n">cell_format</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>

    <span class="c1"># VFT Metrics</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;cadets_overall_value&#39;</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span> <span class="n">cell_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C5&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;afscs_overall_value&#39;</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span> <span class="n">cell_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;D4&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;cadets_overall_weight&#39;</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span> <span class="n">cell_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;D5&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;afscs_overall_weight&#39;</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span> <span class="n">cell_format</span><span class="p">)</span>

    <span class="c1"># Draw bigger borders</span>
    <span class="n">draw_frame_border_outside</span><span class="p">(</span><span class="n">workbook</span><span class="p">,</span> <span class="n">worksheet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">draw_frame_border_outside</span><span class="p">(</span><span class="n">workbook</span><span class="p">,</span> <span class="n">worksheet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">name_metric_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">draw_frame_border_outside</span><span class="p">(</span><span class="n">workbook</span><span class="p">,</span> <span class="n">worksheet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Adjust Column Widths</span>
    <span class="n">column_widths</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mf">1.50</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mf">1.50</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mf">1.50</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">12</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">column_widths</span><span class="p">:</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">column_widths</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">export_results_dfs</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This nested function is here to export all other dataframes</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Get the xlsxwriter worksheet object.</span>
        <span class="n">workbook</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">book</span>

        <span class="c1"># AFSC Objective measures dataframe</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AFSC&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][:</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]]})</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">objective</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objectives&#39;</span><span class="p">]):</span>
            <span class="n">df</span><span class="p">[</span><span class="n">objective</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;objective_measure&#39;</span><span class="p">][:,</span> <span class="n">k</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Convert the dataframe to an XlsxWriter Excel object.</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Objective Measures&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Add Castle Data if it exists</span>
        <span class="k">if</span> <span class="s1">&#39;castle_q&#39;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
            <span class="n">castle_afscs</span> <span class="o">=</span> <span class="p">[</span><span class="n">afsc</span> <span class="k">for</span> <span class="n">afsc</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^CASTLE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
            <span class="n">castle_counts</span> <span class="o">=</span> <span class="p">[</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;castle_counts&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">]</span> <span class="k">for</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="n">castle_afscs</span><span class="p">]</span>
            <span class="n">castle_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;castle_v&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">]</span> <span class="k">for</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="n">castle_afscs</span><span class="p">]</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AFSC&#39;</span><span class="p">:</span> <span class="n">castle_afscs</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">:</span> <span class="n">castle_counts</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="n">castle_values</span><span class="p">})</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Castle Metrics&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># AFSC Constraint Fail dataframe</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AFSC&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][:</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]]})</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">objective</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objectives&#39;</span><span class="p">]):</span>
            <span class="n">df</span><span class="p">[</span><span class="n">objective</span><span class="p">]</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;objective_constraint_fail&#39;</span><span class="p">][:,</span> <span class="n">k</span><span class="p">]</span>

        <span class="c1"># Convert the dataframe to an XlsxWriter Excel object.</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Constraint Fails&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># AFSC Objective values dataframe</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AFSC&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][:</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]]})</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">objective</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objectives&#39;</span><span class="p">]):</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]))</span>
            <span class="n">values</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="n">np</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;J^A&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;objective_value&#39;</span><span class="p">][</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;J^A&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">k</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>

            <span class="n">df</span><span class="p">[</span><span class="n">objective</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>

        <span class="c1"># Convert the dataframe to an XlsxWriter Excel object.</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Objective Values&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Get the xlsxwriter worksheet object.</span>
        <span class="n">worksheet</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="s2">&quot;Objective Values&quot;</span><span class="p">]</span>

        <span class="c1"># Add a percent number format</span>
        <span class="n">percent_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s2">&quot;num_format&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0%&quot;</span><span class="p">})</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">percent_format</span><span class="p">)</span>

        <span class="c1"># Conditional formatting to highlight which objectives were met/not met</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s2">&quot;B2:&quot;</span> <span class="o">+</span> <span class="n">excel_columns</span><span class="p">[</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;3_color_scale&quot;</span><span class="p">})</span>

        <span class="c1"># Solution Dataframe</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Cadet&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadets&#39;</span><span class="p">]})</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;USAFA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;usafa&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Merit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;merit&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Matched AFSC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;afsc_array&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;base_array&quot;</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Matched Base&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;base_array&#39;</span><span class="p">]</span>
            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Matched Course&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;course_array&#39;</span><span class="p">]</span>
            <span class="n">col_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Base Choice&#39;</span><span class="p">:</span> <span class="s1">&#39;base_choice&#39;</span><span class="p">,</span> <span class="s1">&#39;Cadet State&#39;</span><span class="p">:</span> <span class="s1">&#39;cadet_state_achieved&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;State Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;state_utility_used&#39;</span><span class="p">,</span> <span class="s1">&#39;Cadet Value&#39;</span><span class="p">:</span> <span class="s1">&#39;cadet_value_achieved&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;AFSC Weight&#39;</span><span class="p">:</span> <span class="s1">&#39;afsc_weight_used&#39;</span><span class="p">,</span> <span class="s1">&#39;Base Weight&#39;</span><span class="p">:</span> <span class="s1">&#39;base_weight_used&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Course Weight&#39;</span><span class="p">:</span> <span class="s1">&#39;course_weight_used&#39;</span><span class="p">,</span> <span class="s1">&#39;Base Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;base_utility_achieved&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Course Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;course_utility_achieved&#39;</span><span class="p">}</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">col_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="n">val</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Cadet Choice&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;cadet_choice&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;AFSC Choice&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;afsc_choice&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Cadet Utility&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;cadet_utility_achieved&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;AFSC Utility&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;afsc_utility_achieved&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Global Utility&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;global_utility_achieved&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Matched Deg Tier&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>  <span class="c1"># &quot;U&quot; for unmatched cadets</span>
            <span class="n">p</span><span class="p">[</span><span class="s1">&#39;qual&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;j_array&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span> <span class="k">if</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;j_array&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;U&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]]</span>

        <span class="c1"># Rated Reserves/Matches/Alternates</span>
        <span class="k">for</span> <span class="n">s_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Rated Matches&#39;</span><span class="p">,</span> <span class="s1">&#39;Rated Reserves&#39;</span><span class="p">,</span> <span class="s1">&#39;Rated Alternates (Hard)&#39;</span><span class="p">,</span> <span class="s1">&#39;Rated Alternates (Soft)&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">s_name</span> <span class="ow">in</span> <span class="n">instance</span><span class="o">.</span><span class="n">solutions</span><span class="p">:</span>
                <span class="n">df</span><span class="p">[</span><span class="n">s_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">s_name</span><span class="p">][</span><span class="s1">&#39;afsc_array&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">df</span><span class="p">[</span><span class="n">s_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;*&quot;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]]</span>

        <span class="c1"># Rated Rankings</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^Rated&#39;</span><span class="p">]:</span>
            <span class="n">df</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; Rank&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;a_pref_matrix&#39;</span><span class="p">][:,</span> <span class="n">j</span><span class="p">]</span>

        <span class="c1"># Add the cadet&#39;s top 10 choices for more information!</span>
        <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">],</span> <span class="mi">10</span><span class="p">)):</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Choice &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">choice</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;c_preferences&#39;</span><span class="p">][:,</span> <span class="n">choice</span><span class="p">]</span>

        <span class="c1"># Capture preference columns</span>
        <span class="n">preference_columns</span> <span class="o">=</span> <span class="n">excel_columns</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">],</span> <span class="mi">10</span><span class="p">):</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)]</span>

        <span class="c1"># Add the cadet&#39;s top 10 utilities for more information!</span>
        <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">],</span> <span class="mi">10</span><span class="p">)):</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Utility &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">choice</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]:</span>

                <span class="c1"># Might run out of utilities</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadet_preferences&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">choice</span><span class="p">:</span>
                    <span class="n">j</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadet_preferences&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">choice</span><span class="p">]</span>
                    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Utility &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">choice</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadet_utility&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>

        <span class="c1"># Convert the dataframe to an XlsxWriter Excel object.</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Solution&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">startrow</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Get the xlsxwriter worksheet object.</span>
        <span class="n">worksheet</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="s2">&quot;Solution&quot;</span><span class="p">]</span>

        <span class="c1"># Add additional formatting to top row</span>
        <span class="n">header_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">})</span>
        <span class="k">for</span> <span class="n">col_num</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
            <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">col_num</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">header_format</span><span class="p">)</span>

        <span class="c1"># Get numpy array of df columns</span>
        <span class="n">df_columns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

        <span class="c1"># Conditional Formatting on preferences</span>
        <span class="n">cadet_choice_col</span> <span class="o">=</span> <span class="n">excel_columns</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df_columns</span> <span class="o">==</span> <span class="s1">&#39;Cadet Choice&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">preference_columns</span><span class="p">):</span>
            <span class="n">format1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;choice_colors&#39;</span><span class="p">][</span><span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]})</span>
            <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="s2">&quot;2:&quot;</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                                         <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;D2&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format1</span>
                                          <span class="p">})</span>
            <span class="c1"># Cadet Choice Column</span>
            <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cadet_choice_col</span> <span class="o">+</span> <span class="s2">&quot;2:&quot;</span> <span class="o">+</span> <span class="n">cadet_choice_col</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                                         <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                                          <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format1</span>
                                          <span class="p">})</span>

        <span class="c1"># Freeze top row</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">freeze_panes</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Add filter to headers</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">autofilter</span><span class="p">(</span><span class="s1">&#39;A1:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">excel_columns</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

        <span class="c1"># Replace unassigned base values</span>
        <span class="k">if</span> <span class="s1">&#39;Base Choice&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span>
            <span class="n">cell_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({})</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;Base Choice&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">letters</span> <span class="o">=</span> <span class="p">[</span><span class="n">excel_columns</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df_columns</span> <span class="o">==</span> <span class="n">col</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span>
                               <span class="p">[</span><span class="s1">&#39;Base Weight&#39;</span><span class="p">,</span> <span class="s1">&#39;Base Choice&#39;</span><span class="p">,</span> <span class="s1">&#39;Base Utility&#39;</span><span class="p">]]</span>
                    <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">letters</span><span class="p">:</span>
                        <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">letter</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>

        <span class="c1"># Small values good (1, 2, 3, 4, ...) Conditional Formatting</span>
        <span class="n">sv_excel_cols</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;AFSC Choice&#39;</span><span class="p">,</span> <span class="s1">&#39;Base Choice&#39;</span><span class="p">,</span> <span class="s1">&#39;Cadet State&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span>
                <span class="n">sv_excel_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">excel_columns</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df_columns</span> <span class="o">==</span> <span class="n">col</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">sv_excel_cols</span><span class="p">:</span>
            <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span>
                <span class="n">c</span> <span class="o">+</span> <span class="s2">&quot;2:&quot;</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;3_color_scale&#39;</span><span class="p">,</span> <span class="s1">&#39;min_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#63be7b&#39;</span><span class="p">,</span>
                                                 <span class="s1">&#39;mid_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#ffeb84&#39;</span><span class="p">,</span> <span class="s1">&#39;max_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#f8696b&#39;</span><span class="p">})</span>

        <span class="c1"># Large values good (1, ...,  0) Conditional Formatting</span>
        <span class="n">lv_excel_cols</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Merit&#39;</span><span class="p">,</span> <span class="s1">&#39;Cadet Utility&#39;</span><span class="p">,</span> <span class="s1">&#39;AFSC Utility&#39;</span><span class="p">,</span> <span class="s1">&#39;Global Utility&#39;</span><span class="p">,</span> <span class="s1">&#39;Base Utility&#39;</span><span class="p">,</span> <span class="s1">&#39;Course Utility&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;State Utility&#39;</span><span class="p">,</span> <span class="s1">&#39;Cadet Value&#39;</span><span class="p">,</span> <span class="s1">&#39;Cadet Value (Pyomo)&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span>
                <span class="n">lv_excel_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">excel_columns</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df_columns</span> <span class="o">==</span> <span class="n">col</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">lv_excel_cols</span><span class="p">:</span>
            <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="s2">&quot;2:&quot;</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;3_color_scale&quot;</span><span class="p">})</span>

        <span class="c1"># &quot;All Others&quot; for the choice column</span>
        <span class="n">format1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;all_other_choice_colors&#39;</span><span class="p">]})</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cadet_choice_col</span> <span class="o">+</span> <span class="s2">&quot;2:&quot;</span> <span class="o">+</span> <span class="n">cadet_choice_col</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                                     <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format1</span><span class="p">})</span>

        <span class="c1"># Add a percent number format to certain columns</span>
        <span class="n">percent_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Merit&#39;</span><span class="p">,</span> <span class="s1">&#39;State Utility&#39;</span><span class="p">,</span> <span class="s1">&#39;Cadet Value&#39;</span><span class="p">,</span> <span class="s1">&#39;AFSC Weight&#39;</span><span class="p">,</span> <span class="s1">&#39;Base Weight&#39;</span><span class="p">,</span> <span class="s1">&#39;Course Weight&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Base Utility&#39;</span><span class="p">,</span> <span class="s1">&#39;Course Utility&#39;</span><span class="p">,</span> <span class="s1">&#39;Cadet Utility&#39;</span><span class="p">,</span> <span class="s1">&#39;AFSC Utility&#39;</span><span class="p">,</span> <span class="s1">&#39;Global Utility&#39;</span><span class="p">]</span>
        <span class="n">percent_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s2">&quot;num_format&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0%&quot;</span><span class="p">})</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">percent_cols</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_columns</span><span class="p">:</span>
                <span class="n">c_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df_columns</span> <span class="o">==</span> <span class="n">col</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="n">c_num</span><span class="p">,</span> <span class="n">c_num</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">percent_format</span><span class="p">)</span>

        <span class="c1"># Solution/X Matrix</span>
        <span class="k">if</span> <span class="s1">&#39;x&#39;</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Cadet&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadets&#39;</span><span class="p">]})</span>
            <span class="n">df</span><span class="p">[</span><span class="n">instance</span><span class="o">.</span><span class="n">solution_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;afsc_array&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][:</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]]):</span>
                <span class="n">df</span><span class="p">[</span><span class="n">afsc</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">][:,</span> <span class="n">j</span><span class="p">]</span>

            <span class="c1"># Convert the dataframe to an XlsxWriter Excel object.</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Base Matrix</span>
        <span class="k">if</span> <span class="s1">&#39;v&#39;</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Cadet&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadets&#39;</span><span class="p">]})</span>
            <span class="n">df</span><span class="p">[</span><span class="n">instance</span><span class="o">.</span><span class="n">solution_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;base_array&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">b</span><span class="p">,</span> <span class="n">base</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;bases&#39;</span><span class="p">][:</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">]]):</span>
                <span class="n">df</span><span class="p">[</span><span class="n">base</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">][:,</span> <span class="n">b</span><span class="p">]</span>

            <span class="c1"># Convert the dataframe to an XlsxWriter Excel object.</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Training Matrix</span>
        <span class="k">if</span> <span class="s1">&#39;q&#39;</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">:</span>

            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Cadet&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadets&#39;</span><span class="p">]})</span>
            <span class="n">df</span><span class="p">[</span><span class="n">instance</span><span class="o">.</span><span class="n">solution_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;course_array&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][:</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]]):</span>
                <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">course</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;courses&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]):</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">afsc</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">course</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;q&#39;</span><span class="p">][:,</span> <span class="n">j</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span>

            <span class="c1"># Convert the dataframe to an XlsxWriter Excel object.</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Value Function Matrices</span>
        <span class="k">if</span> <span class="s1">&#39;lambda&#39;</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">:</span>

            <span class="n">afsc_arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">afsc</span> <span class="k">for</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][:</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;K&#39;</span><span class="p">]]</span>
            <span class="n">objective_arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">objective</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">objective</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objectives&#39;</span><span class="p">]]</span>

            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AFSC&#39;</span><span class="p">:</span> <span class="n">afsc_arr</span><span class="p">,</span> <span class="s1">&#39;Objective&#39;</span><span class="p">:</span> <span class="n">objective_arr</span><span class="p">})</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;r^max&#39;</span><span class="p">]):</span>
                <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;lambda&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;K&#39;</span><span class="p">]]</span>
                <span class="n">df</span><span class="p">[</span><span class="s1">&#39;l_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span>  <span class="n">arr</span>

            <span class="c1"># Convert the dataframe to an XlsxWriter Excel object.</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Lambda&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AFSC&#39;</span><span class="p">:</span> <span class="n">afsc_arr</span><span class="p">,</span> <span class="s1">&#39;Objective&#39;</span><span class="p">:</span> <span class="n">objective_arr</span><span class="p">})</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;r^max&#39;</span><span class="p">]):</span>
                <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;K&#39;</span><span class="p">]]</span>
                <span class="n">df</span><span class="p">[</span><span class="s1">&#39;y_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">arr</span>

            <span class="c1"># Convert the dataframe to an XlsxWriter Excel object.</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Blocking Pairs</span>
        <span class="k">if</span> <span class="s1">&#39;blocking_pairs&#39;</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">:</span>

            <span class="c1"># Create &quot;blocking pairs&quot; dataframe and export it to excel</span>
            <span class="n">blocking_cadets</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="nb">tuple</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;blocking_pairs&#39;</span><span class="p">]]</span>
            <span class="n">blocking_afscs</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][</span><span class="nb">tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="nb">tuple</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;blocking_pairs&#39;</span><span class="p">]]</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Blocking Cadet&#39;</span><span class="p">:</span> <span class="n">blocking_cadets</span><span class="p">,</span> <span class="s1">&#39;Blocking AFSC&#39;</span><span class="p">:</span> <span class="n">blocking_afscs</span><span class="p">})</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Blocking Pairs&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Close the workbook</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">export_results_dfs</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="data.processing.draw_frame_border_outside" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">draw_frame_border_outside</span><span class="p">(</span><span class="n">workbook</span><span class="p">,</span> <span class="n">worksheet</span><span class="p">,</span> <span class="n">first_row</span><span class="p">,</span> <span class="n">first_col</span><span class="p">,</span> <span class="n">rows_count</span><span class="p">,</span> <span class="n">cols_count</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#0000FF&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></code>

<a href="#data.processing.draw_frame_border_outside" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Draws an outer border around a rectangular cell range using conditional formatting.</p>
<ul>
<li>Applies a frame to the specified region starting at (first_row, first_col) with size (rows_count x cols_count)</li>
<li>Border color and width are customizable</li>
<li>Assumes 0-based indexing and adjusts if row/column values are less than 1</li>
</ul>
<h4 id="data.processing.draw_frame_border_outside--parameters">Parameters<a class="headerlink" href="#data.processing.draw_frame_border_outside--parameters" title="Permanent link">&para;</a></h4>
<ul>
<li>workbook : xlsxwriter.Workbook</li>
<li>worksheet : xlsxwriter.Worksheet</li>
<li>first_row : int</li>
<li>first_col : int</li>
<li>rows_count : int</li>
<li>cols_count : int</li>
<li>color : str, default '#0000FF'</li>
<li>width : int, default 2</li>
</ul>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span>
<span class="normal">2124</span>
<span class="normal">2125</span>
<span class="normal">2126</span>
<span class="normal">2127</span>
<span class="normal">2128</span>
<span class="normal">2129</span>
<span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span>
<span class="normal">2136</span>
<span class="normal">2137</span>
<span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span>
<span class="normal">2141</span>
<span class="normal">2142</span>
<span class="normal">2143</span>
<span class="normal">2144</span>
<span class="normal">2145</span>
<span class="normal">2146</span>
<span class="normal">2147</span>
<span class="normal">2148</span>
<span class="normal">2149</span>
<span class="normal">2150</span>
<span class="normal">2151</span>
<span class="normal">2152</span>
<span class="normal">2153</span>
<span class="normal">2154</span>
<span class="normal">2155</span>
<span class="normal">2156</span>
<span class="normal">2157</span>
<span class="normal">2158</span>
<span class="normal">2159</span>
<span class="normal">2160</span>
<span class="normal">2161</span>
<span class="normal">2162</span>
<span class="normal">2163</span>
<span class="normal">2164</span>
<span class="normal">2165</span>
<span class="normal">2166</span>
<span class="normal">2167</span>
<span class="normal">2168</span>
<span class="normal">2169</span>
<span class="normal">2170</span>
<span class="normal">2171</span>
<span class="normal">2172</span>
<span class="normal">2173</span>
<span class="normal">2174</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">draw_frame_border_outside</span><span class="p">(</span><span class="n">workbook</span><span class="p">,</span> <span class="n">worksheet</span><span class="p">,</span> <span class="n">first_row</span><span class="p">,</span> <span class="n">first_col</span><span class="p">,</span> <span class="n">rows_count</span><span class="p">,</span> <span class="n">cols_count</span><span class="p">,</span>
                              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#0000FF&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draws an outer border around a rectangular cell range using conditional formatting.</span>

<span class="sd">    - Applies a frame to the specified region starting at (first_row, first_col) with size (rows_count x cols_count)</span>
<span class="sd">    - Border color and width are customizable</span>
<span class="sd">    - Assumes 0-based indexing and adjusts if row/column values are less than 1</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    - workbook : xlsxwriter.Workbook</span>
<span class="sd">    - worksheet : xlsxwriter.Worksheet</span>
<span class="sd">    - first_row : int</span>
<span class="sd">    - first_col : int</span>
<span class="sd">    - rows_count : int</span>
<span class="sd">    - cols_count : int</span>
<span class="sd">    - color : str, default &#39;#0000FF&#39;</span>
<span class="sd">    - width : int, default 2</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># verify type of data passed in</span>
    <span class="k">if</span> <span class="n">first_row</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">first_row</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">first_col</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">first_col</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">cols_count</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">cols_count</span><span class="p">)</span>
    <span class="n">rows_count</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rows_count</span><span class="p">)</span>

    <span class="c1"># top left corner</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">first_row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">first_col</span><span class="p">,</span>
                                 <span class="n">first_row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">first_col</span><span class="p">,</span>
                                 <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;formula&#39;</span><span class="p">,</span> <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;True&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bottom&#39;</span><span class="p">:</span> <span class="n">width</span><span class="p">,</span> <span class="s1">&#39;border_color&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">})})</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">first_row</span><span class="p">,</span> <span class="n">first_col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                                 <span class="n">first_row</span><span class="p">,</span> <span class="n">first_col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                                 <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;formula&#39;</span><span class="p">,</span> <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;True&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;right&#39;</span><span class="p">:</span> <span class="n">width</span><span class="p">,</span> <span class="s1">&#39;border_color&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">})})</span>
    <span class="c1"># top right corner</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">first_row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">first_col</span> <span class="o">+</span> <span class="n">cols_count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                                 <span class="n">first_row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">first_col</span> <span class="o">+</span> <span class="n">cols_count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                                 <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;formula&#39;</span><span class="p">,</span> <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;True&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bottom&#39;</span><span class="p">:</span> <span class="n">width</span><span class="p">,</span> <span class="s1">&#39;border_color&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">})})</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">first_row</span><span class="p">,</span> <span class="n">first_col</span> <span class="o">+</span> <span class="n">cols_count</span><span class="p">,</span>
                                 <span class="n">first_row</span><span class="p">,</span> <span class="n">first_col</span> <span class="o">+</span> <span class="n">cols_count</span><span class="p">,</span>
                                 <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;formula&#39;</span><span class="p">,</span> <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;True&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="n">width</span><span class="p">,</span> <span class="s1">&#39;border_color&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">})})</span>
    <span class="c1"># bottom left corner</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">first_row</span> <span class="o">+</span> <span class="n">rows_count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">first_col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                                 <span class="n">first_row</span> <span class="o">+</span> <span class="n">rows_count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">first_col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                                 <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;formula&#39;</span><span class="p">,</span> <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;True&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;right&#39;</span><span class="p">:</span> <span class="n">width</span><span class="p">,</span> <span class="s1">&#39;border_color&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">})})</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">first_row</span> <span class="o">+</span> <span class="n">rows_count</span><span class="p">,</span> <span class="n">first_col</span><span class="p">,</span>
                                 <span class="n">first_row</span> <span class="o">+</span> <span class="n">rows_count</span><span class="p">,</span> <span class="n">first_col</span><span class="p">,</span>
                                 <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;formula&#39;</span><span class="p">,</span> <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;True&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="n">width</span><span class="p">,</span> <span class="s1">&#39;border_color&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">})})</span>
    <span class="c1"># bottom right corner</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">first_row</span> <span class="o">+</span> <span class="n">rows_count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">first_col</span> <span class="o">+</span> <span class="n">cols_count</span><span class="p">,</span>
                                 <span class="n">first_row</span> <span class="o">+</span> <span class="n">rows_count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">first_col</span> <span class="o">+</span> <span class="n">cols_count</span><span class="p">,</span>
                                 <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;formula&#39;</span><span class="p">,</span> <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;True&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="n">width</span><span class="p">,</span> <span class="s1">&#39;border_color&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">})})</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">first_row</span> <span class="o">+</span> <span class="n">rows_count</span><span class="p">,</span> <span class="n">first_col</span> <span class="o">+</span> <span class="n">cols_count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                                 <span class="n">first_row</span> <span class="o">+</span> <span class="n">rows_count</span><span class="p">,</span> <span class="n">first_col</span> <span class="o">+</span> <span class="n">cols_count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                                 <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;formula&#39;</span><span class="p">,</span> <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;True&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="n">width</span><span class="p">,</span> <span class="s1">&#39;border_color&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">})})</span>
    <span class="c1"># top</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">first_row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">first_col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                                 <span class="n">first_row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">first_col</span> <span class="o">+</span> <span class="n">cols_count</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span>
                                 <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;formula&#39;</span><span class="p">,</span> <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;True&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bottom&#39;</span><span class="p">:</span> <span class="n">width</span><span class="p">,</span> <span class="s1">&#39;border_color&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">})})</span>
    <span class="c1"># left</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">first_row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">first_col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                                 <span class="n">first_row</span> <span class="o">+</span> <span class="n">rows_count</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">first_col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                                 <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;formula&#39;</span><span class="p">,</span> <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;True&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;right&#39;</span><span class="p">:</span> <span class="n">width</span><span class="p">,</span> <span class="s1">&#39;border_color&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">})})</span>
    <span class="c1"># bottom</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">first_row</span> <span class="o">+</span> <span class="n">rows_count</span><span class="p">,</span> <span class="n">first_col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                                 <span class="n">first_row</span> <span class="o">+</span> <span class="n">rows_count</span><span class="p">,</span> <span class="n">first_col</span> <span class="o">+</span> <span class="n">cols_count</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span>
                                 <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;formula&#39;</span><span class="p">,</span> <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;True&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="n">width</span><span class="p">,</span> <span class="s1">&#39;border_color&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">})})</span>
    <span class="c1"># right</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">first_row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">first_col</span> <span class="o">+</span> <span class="n">cols_count</span><span class="p">,</span>
                                 <span class="n">first_row</span> <span class="o">+</span> <span class="n">rows_count</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">first_col</span> <span class="o">+</span> <span class="n">cols_count</span><span class="p">,</span>
                                 <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;formula&#39;</span><span class="p">,</span> <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;True&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="n">width</span><span class="p">,</span> <span class="s1">&#39;border_color&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">})})</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://gitlab.com/path-to-your-repo" target="_blank" rel="noopener" title="gitlab.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/input/tex/extensions/bm.js"></script>
      
    
  </body>
</html>