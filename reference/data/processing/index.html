
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://gitlab.stitches.mil.gitlab.io/reference/data/processing/">
      
      
      
      
      <link rel="icon" href="../../../images/logos/afccp_logo_favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Processing - Air Force Cadet Career Problem</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#data.processing" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Air Force Cadet Career Problem" class="md-header__button md-logo" aria-label="Air Force Cadet Career Problem" data-md-component="logo">
      
  <img src="../../../images/logos/afccp_logo_and_text_light.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Air Force Cadet Career Problem
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Processing
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  üè† Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../getting-started/" class="md-tabs__link">
          
  
  
  üöÄ Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../user-guide/" class="md-tabs__link">
        
  
  
    
  
  User Guide

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../developer-guide/" class="md-tabs__link">
        
  
  
    
  
  üß† Developer Guide

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../__init__/" class="md-tabs__link">
          
  
  
  üìä Data

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../__init__/" class="md-tabs__link">
          
  
  
  üìà Solutions

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../__init__/" class="md-tabs__link">
          
  
  
  Visualizations

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../references/references.md" class="md-tabs__link">
        
  
  
    
  
  üìö References

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../faq/" class="md-tabs__link">
        
  
  
    
  
  ‚ùì FAQs

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../help/" class="md-tabs__link">
        
  
  
    
  
  üÜò Help & Support

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Air Force Cadet Career Problem" class="md-nav__button md-logo" aria-label="Air Force Cadet Career Problem" data-md-component="logo">
      
  <img src="../../../images/logos/afccp_logo_and_text_light.png" alt="logo">

    </a>
    Air Force Cadet Career Problem
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üè† Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üöÄ Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            üöÄ Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üìÑ Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üõ†Ô∏è Install Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            üõ†Ô∏è Install Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation Instructions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer-checklist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Developer Checklist
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üß† Developer Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üìä Data
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            üìä Data
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../__init__/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üìà Solutions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            üìà Solutions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../__init__/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Visualizations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Visualizations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../__init__/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/references.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üìö References
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ‚ùì FAQs
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../help/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üÜò Help & Support
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Processing</h1>

<div class="doc doc-object doc-module">



<h2 id="data.processing" class="doc doc-heading">
            <code>data.processing</code>


</h2>

    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="data.processing.initialize_file_information" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">initialize_file_information</span><span class="p">(</span><span class="n">data_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the file paths for importing and exporting the data files for a given data instance.</p>
<p>Parameters:
data_name (str): The name of the data instance.
data_version (str): The version of the data instance.</p>
<p>Returns:
Tuple[Dict[str, str], Dict[str, str]]: A tuple containing two dictionaries. The first dictionary contains
the file paths for importing the necessary data files, and the second dictionary contains the file paths
for exporting the data files.</p>
<p>The function checks for the existence of the data instance folder in the 'instances' directory. If the
folder does not exist, it is created. The function also creates any sub-folders that do not already exist.</p>
<p>The file paths are determined by checking the sub-folders for the necessary data files. If the data version
is 'Default', the function imports and exports the files from the default sub-folders. If the data version is
specified, the function checks if the sub-folder with that version exists. If it does not, the function
imports the files from the default sub-folders and exports them to the specified version sub-folder. If the
sub-folder with the specified version already exists, the function imports and exports the files from that
sub-folder.</p>
<p>The function returns two dictionaries containing the file paths for importing and exporting the data files.
The keys in the dictionaries are the names of the data files, and the values are the corresponding file paths.</p>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">initialize_file_information</span><span class="p">(</span><span class="n">data_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the file paths for importing and exporting the data files for a given data instance.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    data_name (str): The name of the data instance.</span>
<span class="sd">    data_version (str): The version of the data instance.</span>

<span class="sd">    Returns:</span>
<span class="sd">    Tuple[Dict[str, str], Dict[str, str]]: A tuple containing two dictionaries. The first dictionary contains</span>
<span class="sd">    the file paths for importing the necessary data files, and the second dictionary contains the file paths</span>
<span class="sd">    for exporting the data files.</span>

<span class="sd">    The function checks for the existence of the data instance folder in the &#39;instances&#39; directory. If the</span>
<span class="sd">    folder does not exist, it is created. The function also creates any sub-folders that do not already exist.</span>

<span class="sd">    The file paths are determined by checking the sub-folders for the necessary data files. If the data version</span>
<span class="sd">    is &#39;Default&#39;, the function imports and exports the files from the default sub-folders. If the data version is</span>
<span class="sd">    specified, the function checks if the sub-folder with that version exists. If it does not, the function</span>
<span class="sd">    imports the files from the default sub-folders and exports them to the specified version sub-folder. If the</span>
<span class="sd">    sub-folder with the specified version already exists, the function imports and exports the files from that</span>
<span class="sd">    sub-folder.</span>

<span class="sd">    The function returns two dictionaries containing the file paths for importing and exporting the data files.</span>
<span class="sd">    The keys in the dictionaries are the names of the data files, and the values are the corresponding file paths.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># If we don&#39;t already have the instance folder, we make it now</span>
    <span class="n">instance_path</span> <span class="o">=</span> <span class="s2">&quot;instances/&quot;</span> <span class="o">+</span> <span class="n">data_name</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
    <span class="k">if</span> <span class="n">data_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">afccp</span><span class="o">.</span><span class="n">globals</span><span class="o">.</span><span class="n">instances_available</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">instance_path</span><span class="p">)</span>
    <span class="n">instance_folder</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">instance_path</span><span class="p">))</span>

    <span class="c1"># Valid files/folders</span>
    <span class="n">sub_folders</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Original &amp; Supplemental&quot;</span><span class="p">,</span> <span class="s2">&quot;Combined Data&quot;</span><span class="p">,</span> <span class="s2">&quot;CFMs&quot;</span><span class="p">,</span> <span class="s2">&quot;Model Input&quot;</span><span class="p">,</span> <span class="s2">&quot;Analysis &amp; Results&quot;</span><span class="p">]</span>
    <span class="n">sub_folder_files</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Model Input&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Cadets&quot;</span><span class="p">,</span> <span class="s2">&quot;Cadets Preferences&quot;</span><span class="p">,</span> <span class="s2">&quot;Cadets Utility&quot;</span><span class="p">,</span> <span class="s2">&quot;Cadets Utility Constraints&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Cadets Utility (Final)&quot;</span><span class="p">,</span> <span class="s2">&quot;AFSCs&quot;</span><span class="p">,</span> <span class="s2">&quot;AFSCs Preferences&quot;</span><span class="p">,</span> <span class="s2">&quot;AFSCs Utility&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Value Parameters&quot;</span><span class="p">,</span> <span class="s2">&quot;Goal Programming&quot;</span><span class="p">,</span> <span class="s2">&quot;ROTC Rated Interest&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;ROTC Rated OM&quot;</span><span class="p">,</span> <span class="s2">&quot;USAFA Rated OM&quot;</span><span class="p">,</span> <span class="s2">&quot;OTS Rated OM&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Bases&quot;</span><span class="p">,</span> <span class="s2">&quot;Bases Preferences&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Bases Utility&quot;</span><span class="p">,</span> <span class="s2">&quot;Courses&quot;</span><span class="p">,</span> <span class="s2">&quot;Cadets Selected&quot;</span><span class="p">,</span> <span class="s2">&quot;AFSCs Buckets&quot;</span><span class="p">,</span>
                                        <span class="s1">&#39;Castle Input&#39;</span><span class="p">],</span>
                        <span class="s2">&quot;Analysis &amp; Results&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Solutions&quot;</span><span class="p">,</span> <span class="s2">&quot;Base Solutions&quot;</span><span class="p">,</span> <span class="s2">&quot;Course Solutions&quot;</span><span class="p">]}</span>

    <span class="c1"># Loop through each sub-folder in the above list and determine the filepaths for the various files</span>
    <span class="n">import_filepaths</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">export_filepaths</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sub_folder</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sub_folders</span><span class="p">):</span>

        <span class="c1"># Sub-Folder with the number: &quot;4. Model Input&quot; for example</span>
        <span class="n">numbered_sub_folder</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;. &quot;</span> <span class="o">+</span> <span class="n">sub_folder</span>

        <span class="c1"># All the sub-folders that have this numbered sub-folder</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">instance_folder</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flatnonzero</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">defchararray</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">instance_folder</span><span class="p">,</span> <span class="n">numbered_sub_folder</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">sub_folder_individuals</span> <span class="o">=</span> <span class="n">instance_folder</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sub_folder_individuals</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># If this is the &quot;default version&quot;, we already know what the sub-folder has to be</span>
        <span class="k">if</span> <span class="n">data_version</span> <span class="o">==</span> <span class="s2">&quot;Default&quot;</span><span class="p">:</span>
            <span class="n">import_sub_folder</span> <span class="o">=</span> <span class="n">numbered_sub_folder</span>
            <span class="n">export_sub_folder</span> <span class="o">=</span> <span class="n">numbered_sub_folder</span>

            <span class="c1"># If we don&#39;t currently have this sub-folder, we make it (New instance file)</span>
            <span class="k">if</span> <span class="n">numbered_sub_folder</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sub_folder_individuals</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">instance_path</span> <span class="o">+</span> <span class="n">numbered_sub_folder</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>

        <span class="c1"># If the data version was specified, we have to check if it has the specific folder or not</span>
        <span class="k">else</span><span class="p">:</span>

            <span class="c1"># If the version folder is not there, we import from the default but will export to the data version folder</span>
            <span class="n">version_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flatnonzero</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">defchararray</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">sub_folder_individuals</span><span class="p">,</span> <span class="n">data_version</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">version_indices</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">import_sub_folder</span> <span class="o">=</span> <span class="n">numbered_sub_folder</span>
                <span class="n">export_sub_folder</span> <span class="o">=</span> <span class="n">numbered_sub_folder</span> <span class="o">+</span> <span class="s2">&quot; (&quot;</span> <span class="o">+</span> <span class="n">data_version</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>

                <span class="c1"># We will only ever export specific version data to these sub-folders</span>
                <span class="k">if</span> <span class="n">sub_folder</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Model Input&quot;</span><span class="p">,</span> <span class="s2">&quot;Analysis &amp; Results&quot;</span><span class="p">]:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">instance_path</span> <span class="o">+</span> <span class="n">export_sub_folder</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>

            <span class="c1"># We already have the version folder</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">import_sub_folder</span> <span class="o">=</span> <span class="n">sub_folder_individuals</span><span class="p">[</span><span class="n">version_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="n">export_sub_folder</span> <span class="o">=</span> <span class="n">sub_folder_individuals</span><span class="p">[</span><span class="n">version_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

        <span class="c1"># If this is one of the sub-folders we can import/export to/from</span>
        <span class="k">if</span> <span class="n">sub_folder</span> <span class="ow">in</span> <span class="n">sub_folder_files</span><span class="p">:</span>

            <span class="c1"># Get sub folder paths</span>
            <span class="n">import_sub_folder_path</span> <span class="o">=</span> <span class="n">instance_path</span> <span class="o">+</span> <span class="n">import_sub_folder</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
            <span class="n">export_sub_folder_path</span> <span class="o">=</span> <span class="n">instance_path</span> <span class="o">+</span> <span class="n">export_sub_folder</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>

            <span class="c1"># Add generic file-paths for this sub-folder</span>
            <span class="n">export_filepaths</span><span class="p">[</span><span class="n">sub_folder</span><span class="p">]</span> <span class="o">=</span> <span class="n">export_sub_folder_path</span>
            <span class="n">import_filepaths</span><span class="p">[</span><span class="n">sub_folder</span><span class="p">]</span> <span class="o">=</span> <span class="n">import_sub_folder_path</span>

            <span class="c1"># Loop through each file listed above in the &quot;sub_folder_files&quot; for this sub-folder</span>
            <span class="n">sub_folder_files_available</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">import_sub_folder_path</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">sub_folder_files</span><span class="p">[</span><span class="n">sub_folder</span><span class="p">]:</span>

                <span class="c1"># Create the name of the file</span>
                <span class="k">if</span> <span class="n">data_version</span> <span class="o">==</span> <span class="s2">&quot;Default&quot;</span><span class="p">:</span>
                    <span class="n">filename</span> <span class="o">=</span> <span class="n">data_name</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">file</span> <span class="o">+</span> <span class="s2">&quot;.csv&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">filename</span> <span class="o">=</span> <span class="n">data_name</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">file</span> <span class="o">+</span> <span class="s2">&quot; (&quot;</span> <span class="o">+</span> <span class="n">data_version</span> <span class="o">+</span> <span class="s2">&quot;).csv&quot;</span>

                <span class="c1"># Get the path that we would export this file to</span>
                <span class="n">export_filepaths</span><span class="p">[</span><span class="n">file</span><span class="p">]</span> <span class="o">=</span> <span class="n">export_sub_folder_path</span> <span class="o">+</span> <span class="n">filename</span>

                <span class="c1"># If we already have this file in the &quot;import path&quot;, we add it to that filepath dictionary</span>
                <span class="k">if</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">sub_folder_files_available</span><span class="p">:</span>
                    <span class="n">import_filepaths</span><span class="p">[</span><span class="n">file</span><span class="p">]</span> <span class="o">=</span> <span class="n">import_sub_folder_path</span> <span class="o">+</span> <span class="n">filename</span>
                <span class="k">elif</span> <span class="n">data_version</span> <span class="o">!=</span> <span class="s2">&quot;Default&quot;</span> <span class="ow">and</span> <span class="n">data_name</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">file</span> <span class="o">+</span> <span class="s2">&quot;.csv&quot;</span> <span class="ow">in</span> <span class="n">sub_folder_files_available</span><span class="p">:</span>
                    <span class="n">import_filepaths</span><span class="p">[</span><span class="n">file</span><span class="p">]</span> <span class="o">=</span> <span class="n">import_sub_folder_path</span> <span class="o">+</span> <span class="n">data_name</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">file</span> <span class="o">+</span> <span class="s2">&quot;.csv&quot;</span>

    <span class="c1"># If we don&#39;t have one of the Analysis &amp; Results &quot;sub-sub folders&quot;, we make it</span>
    <span class="k">for</span> <span class="n">sub_sub_folder</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Data Charts&quot;</span><span class="p">,</span> <span class="s2">&quot;Results Charts&quot;</span><span class="p">,</span> <span class="s2">&quot;Cadet Board&quot;</span><span class="p">,</span> <span class="s1">&#39;Value Functions&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">sub_sub_folder</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">export_filepaths</span><span class="p">[</span><span class="s2">&quot;Analysis &amp; Results&quot;</span><span class="p">]):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">export_filepaths</span><span class="p">[</span><span class="s2">&quot;Analysis &amp; Results&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">sub_sub_folder</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>

    <span class="c1"># Return the information</span>
    <span class="k">return</span> <span class="n">import_filepaths</span><span class="p">,</span> <span class="n">export_filepaths</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="data.processing.import_afscs_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">import_afscs_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Imports the 'AFSCs' csv file and updates the instance parameters dictionary with the values from the file.</p>
<p>Args:
    import_filepaths (dict): A dictionary of filepaths containing the location of the 'AFSCs' csv file.
    parameters (dict): A dictionary of instance parameters to update.</p>
<p>Returns:
    dict: The updated instance parameters.</p>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">import_afscs_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Imports the &#39;AFSCs&#39; csv file and updates the instance parameters dictionary with the values from the file.</span>

<span class="sd">    Args:</span>
<span class="sd">        import_filepaths (dict): A dictionary of filepaths containing the location of the &#39;AFSCs&#39; csv file.</span>
<span class="sd">        parameters (dict): A dictionary of instance parameters to update.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: The updated instance parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">parameters</span>

    <span class="c1"># Import &#39;AFSCs&#39; dataframe</span>
    <span class="n">afscs_df</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">globals</span><span class="o">.</span><span class="n">import_csv_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">[</span><span class="s2">&quot;AFSCs&quot;</span><span class="p">])</span>

    <span class="c1"># Remove &quot;nans&quot;</span>
    <span class="n">afscs_df</span> <span class="o">=</span> <span class="n">afscs_df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">afscs_df</span> <span class="o">=</span> <span class="n">afscs_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="c1"># Initialize dictionary translating &#39;AFSCs&#39; df columns to their parameter counterparts</span>
    <span class="n">afsc_columns_to_parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;AFSC&quot;</span><span class="p">:</span> <span class="s2">&quot;afscs&quot;</span><span class="p">,</span> <span class="s2">&quot;Accessions Group&quot;</span><span class="p">:</span> <span class="s2">&quot;acc_grp&quot;</span><span class="p">,</span> <span class="s2">&quot;STEM&quot;</span><span class="p">:</span> <span class="s1">&#39;afscs_stem&#39;</span><span class="p">,</span>
                                  <span class="s2">&quot;USAFA Target&quot;</span><span class="p">:</span> <span class="s2">&quot;usafa_quota&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;ROTC Target&quot;</span><span class="p">:</span> <span class="s2">&quot;rotc_quota&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;OTS Target&quot;</span><span class="p">:</span> <span class="s2">&quot;ots_quota&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;PGL Target&quot;</span><span class="p">:</span> <span class="s2">&quot;pgl&quot;</span><span class="p">,</span> <span class="s2">&quot;Estimated&quot;</span><span class="p">:</span> <span class="s2">&quot;quota_e&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;Desired&quot;</span><span class="p">:</span> <span class="s2">&quot;quota_d&quot;</span><span class="p">,</span> <span class="s2">&quot;Min&quot;</span><span class="p">:</span> <span class="s2">&quot;quota_min&quot;</span><span class="p">,</span> <span class="s2">&quot;Max&quot;</span><span class="p">:</span> <span class="s2">&quot;quota_max&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;Assign Base&quot;</span><span class="p">:</span> <span class="s1">&#39;afsc_assign_base&#39;</span><span class="p">,</span> <span class="s1">&#39;Num Courses&#39;</span><span class="p">:</span> <span class="s1">&#39;T&#39;</span><span class="p">}</span>

    <span class="c1"># Loop through each column in the &#39;AFSCs&#39; dataframe to put it into the p dictionary</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">afscs_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

        <span class="c1"># If the column is an instance parameter, we load it in as a numpy array</span>
        <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">afsc_columns_to_parameters</span><span class="p">:</span>
            <span class="n">p_name</span> <span class="o">=</span> <span class="n">afsc_columns_to_parameters</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
            <span class="n">p</span><span class="p">[</span><span class="n">p_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">afscs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">col</span><span class="p">])</span>

    <span class="c1"># Number of AFSCs</span>
    <span class="n">p</span><span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;afscs&quot;</span><span class="p">])</span>

    <span class="c1"># Add an &quot;*&quot; to the list of AFSCs to be considered the &quot;Unmatched AFSC&quot;</span>
    <span class="n">p</span><span class="p">[</span><span class="s2">&quot;afscs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;afscs&quot;</span><span class="p">],</span> <span class="s2">&quot;*&quot;</span><span class="p">))</span>

    <span class="c1"># Get the degree tier information from the AFSCs</span>
    <span class="k">if</span> <span class="s2">&quot;Deg Tier 1&quot;</span> <span class="ow">in</span> <span class="n">afscs_df</span><span class="p">:</span>
        <span class="n">p</span><span class="p">[</span><span class="s2">&quot;Deg Tiers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">afscs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;Deg Tier 1&quot;</span><span class="p">:</span> <span class="s2">&quot;Deg Tier 4&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

    <span class="c1"># Return parameters dictionary</span>
    <span class="k">return</span> <span class="n">p</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="data.processing.import_cadets_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">import_cadets_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Imports data from the "Cadets" csv file and updates the instance parameters dictionary with relevant information.</p>
<p>Args:
import_filepaths (dict): A dictionary with the names and paths of the csv files to import. The "Cadets" file should be included.
parameters (dict): A dictionary of instance parameters to be updated.</p>
<p>Returns:
dict: The updated instance parameters dictionary.</p>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">import_cadets_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Imports data from the &quot;Cadets&quot; csv file and updates the instance parameters dictionary with relevant information.</span>

<span class="sd">    Args:</span>
<span class="sd">    import_filepaths (dict): A dictionary with the names and paths of the csv files to import. The &quot;Cadets&quot; file should be included.</span>
<span class="sd">    parameters (dict): A dictionary of instance parameters to be updated.</span>

<span class="sd">    Returns:</span>
<span class="sd">    dict: The updated instance parameters dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">parameters</span>

    <span class="c1"># Import &#39;Cadets&#39; dataframe</span>
    <span class="n">cadets_df</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">globals</span><span class="o">.</span><span class="n">import_csv_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">[</span><span class="s2">&quot;Cadets&quot;</span><span class="p">])</span>

    <span class="c1"># Initialize dictionary translating &#39;AFSCs&#39; df columns to their parameter counterparts</span>
    <span class="n">cadet_columns_to_parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Cadet&quot;</span><span class="p">:</span> <span class="s2">&quot;cadets&quot;</span><span class="p">,</span> <span class="s1">&#39;Male&#39;</span><span class="p">:</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="s1">&#39;Minority&#39;</span><span class="p">:</span> <span class="s1">&#39;minority&#39;</span><span class="p">,</span> <span class="s1">&#39;Race&#39;</span><span class="p">:</span> <span class="s1">&#39;race&#39;</span><span class="p">,</span>
                                   <span class="s2">&quot;Ethnicity&quot;</span><span class="p">:</span> <span class="s2">&quot;ethnicity&quot;</span><span class="p">,</span> <span class="s1">&#39;USAFA&#39;</span><span class="p">:</span> <span class="s1">&#39;usafa&#39;</span><span class="p">,</span> <span class="s1">&#39;SOC&#39;</span><span class="p">:</span> <span class="s1">&#39;soc&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;ASC1&#39;</span><span class="p">:</span> <span class="s1">&#39;asc1&#39;</span><span class="p">,</span> <span class="s1">&#39;ASC2&#39;</span><span class="p">:</span> <span class="s1">&#39;asc2&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;CIP1&#39;</span><span class="p">:</span> <span class="s1">&#39;cip1&#39;</span><span class="p">,</span> <span class="s1">&#39;CIP2&#39;</span><span class="p">:</span> <span class="s1">&#39;cip2&#39;</span><span class="p">,</span> <span class="s1">&#39;Merit&#39;</span><span class="p">:</span> <span class="s1">&#39;merit&#39;</span><span class="p">,</span> <span class="s1">&#39;Real Merit&#39;</span><span class="p">:</span> <span class="s1">&#39;merit_all&#39;</span><span class="p">,</span>
                                   <span class="s2">&quot;Assigned&quot;</span><span class="p">:</span> <span class="s2">&quot;assigned&quot;</span><span class="p">,</span> <span class="s2">&quot;STEM&quot;</span><span class="p">:</span> <span class="s2">&quot;stem&quot;</span><span class="p">,</span> <span class="s2">&quot;Accessions Group&quot;</span><span class="p">:</span> <span class="s2">&quot;acc_grp_constraint&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;SF OM&quot;</span><span class="p">:</span> <span class="s2">&quot;sf_om&quot;</span><span class="p">,</span> <span class="s1">&#39;Start Date&#39;</span><span class="p">:</span> <span class="s1">&#39;training_start&#39;</span><span class="p">,</span> <span class="s1">&#39;Start Pref&#39;</span><span class="p">:</span> <span class="s1">&#39;training_preferences&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;Base Threshold&#39;</span><span class="p">:</span> <span class="s1">&#39;base_threshold&#39;</span><span class="p">,</span> <span class="s1">&#39;Course Threshold&#39;</span><span class="p">:</span> <span class="s1">&#39;training_threshold&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;AFSC Weight&#39;</span><span class="p">:</span> <span class="s1">&#39;weight_afsc&#39;</span><span class="p">,</span> <span class="s1">&#39;Base Weight&#39;</span><span class="p">:</span> <span class="s1">&#39;weight_base&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;Course Weight&#39;</span><span class="p">:</span> <span class="s1">&#39;weight_course&#39;</span><span class="p">,</span> <span class="s1">&#39;Least Desired AFSC&#39;</span><span class="p">:</span> <span class="s1">&#39;last_afsc&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;Second Least Desired AFSCs&#39;</span><span class="p">:</span> <span class="s1">&#39;second_to_last_afscs&#39;</span><span class="p">}</span>

    <span class="c1"># Loop through each column in the &#39;Cadets&#39; dataframe to put it into the p dictionary</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cadets_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

        <span class="c1"># Weird characters showing up</span>
        <span class="k">if</span> <span class="s2">&quot;√Ø¬ª¬ø&quot;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">:</span>
            <span class="n">col_name</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;√Ø¬ª¬ø&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">col_name</span> <span class="o">=</span> <span class="n">col</span>

        <span class="c1"># If the column is an instance parameter, we load it in as a numpy array</span>
        <span class="k">if</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="n">cadet_columns_to_parameters</span><span class="p">:</span>
            <span class="n">p_name</span> <span class="o">=</span> <span class="n">cadet_columns_to_parameters</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span>
            <span class="n">p</span><span class="p">[</span><span class="n">p_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cadets_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">col</span><span class="p">])</span>

    <span class="c1"># Number of Cadets</span>
    <span class="n">p</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;cadets&quot;</span><span class="p">])</span>

    <span class="c1"># Get qual matrix information</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">adjustments</span><span class="o">.</span><span class="n">gather_degree_tier_qual_matrix</span><span class="p">(</span><span class="n">cadets_df</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

    <span class="c1"># Number of cadet preference choices available and number of utilities available</span>
    <span class="n">p</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cadets_df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s1">&#39;Pref_&#39;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">])</span>
    <span class="n">p</span><span class="p">[</span><span class="s2">&quot;num_util&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>

        <span class="c1"># Get the preferences and utilities columns from the cadets dataframe</span>
        <span class="n">p</span><span class="p">[</span><span class="s2">&quot;c_preferences&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cadets_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;Pref_1&quot;</span><span class="p">:</span> <span class="s2">&quot;Pref_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">])])</span>
        <span class="n">p</span><span class="p">[</span><span class="s2">&quot;c_utilities&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cadets_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;Util_1&quot;</span><span class="p">:</span> <span class="s2">&quot;Util_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;num_util&quot;</span><span class="p">])])</span>

    <span class="c1"># Determine which SOCs are in this instance</span>
    <span class="k">if</span> <span class="s1">&#39;soc&#39;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
        <span class="n">unique_socs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;soc&#39;</span><span class="p">])</span>  <span class="c1"># Get unique list of SOCs</span>

        <span class="c1"># This just gets the SOCs in the right order</span>
        <span class="n">soc_options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;USAFA&#39;</span><span class="p">,</span> <span class="s1">&#39;ROTC&#39;</span><span class="p">,</span> <span class="s1">&#39;OTS&#39;</span><span class="p">]</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;SOCs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">soc</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">soc</span> <span class="ow">in</span> <span class="n">soc_options</span> <span class="k">if</span> <span class="n">soc</span> <span class="ow">in</span> <span class="n">unique_socs</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">soc</span> <span class="ow">in</span> <span class="n">unique_socs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">soc</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">soc_options</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;SOC </span><span class="si">{</span><span class="n">soc</span><span class="si">}</span><span class="s1"> not recognized as valid SOC option! At least one cadet has it.&#39;</span><span class="p">)</span>

    <span class="c1"># Return parameters dictionary</span>
    <span class="k">return</span> <span class="n">p</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="data.processing.import_afsc_cadet_matrices_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">import_afsc_cadet_matrices_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Imports additional  data (if available) for cadets and AFSCs, and adds the relevant information to the
input dictionary of parameters.</p>
<p>Parameters:
import_filepaths (dict): A dictionary containing the filepaths of the csv files to be imported.
    - Required keys: 'Cadets Utility', 'Cadets Preferences', 'AFSCs Utility', 'AFSCs Preferences' (if available)
parameters (dict): A dictionary containing the initial input parameters for the model.
    - Required keys: 'afscs', 'N', 'M', 'num_util', 'P'</p>
<p>Returns:
dict: The updated dictionary of parameters.</p>
<p>Raises:
ValueError: If there is no cadet utility data provided, which is required.</p>
<p>Note:
The function expects that the 'AFSCs' and 'Cadets' csv files have already been imported.</p>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">import_afsc_cadet_matrices_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Imports additional  data (if available) for cadets and AFSCs, and adds the relevant information to the</span>
<span class="sd">    input dictionary of parameters.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    import_filepaths (dict): A dictionary containing the filepaths of the csv files to be imported.</span>
<span class="sd">        - Required keys: &#39;Cadets Utility&#39;, &#39;Cadets Preferences&#39;, &#39;AFSCs Utility&#39;, &#39;AFSCs Preferences&#39; (if available)</span>
<span class="sd">    parameters (dict): A dictionary containing the initial input parameters for the model.</span>
<span class="sd">        - Required keys: &#39;afscs&#39;, &#39;N&#39;, &#39;M&#39;, &#39;num_util&#39;, &#39;P&#39;</span>

<span class="sd">    Returns:</span>
<span class="sd">    dict: The updated dictionary of parameters.</span>

<span class="sd">    Raises:</span>
<span class="sd">    ValueError: If there is no cadet utility data provided, which is required.</span>

<span class="sd">    Note:</span>
<span class="sd">    The function expects that the &#39;AFSCs&#39; and &#39;Cadets&#39; csv files have already been imported.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">parameters</span>

    <span class="c1"># Loop through the potential additional dataframes and import them if we have them</span>
    <span class="n">datasets</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Cadets Utility&quot;</span><span class="p">,</span> <span class="s2">&quot;Cadets Preferences&quot;</span><span class="p">,</span> <span class="s2">&quot;AFSCs Utility&quot;</span><span class="p">,</span> <span class="s2">&quot;AFSCs Preferences&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;ROTC Rated Interest&quot;</span><span class="p">,</span> <span class="s2">&quot;ROTC Rated OM&quot;</span><span class="p">,</span> <span class="s2">&quot;USAFA Rated OM&quot;</span><span class="p">,</span> <span class="s2">&quot;OTS Rated OM&quot;</span><span class="p">,</span> <span class="s1">&#39;Cadets Utility (Final)&#39;</span><span class="p">,</span>
                    <span class="s2">&quot;Cadets Selected&quot;</span><span class="p">,</span> <span class="s2">&quot;AFSCs Buckets&quot;</span><span class="p">]:</span>

        <span class="c1"># If we have the dataset, import it</span>
        <span class="k">if</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">import_filepaths</span><span class="p">:</span>
            <span class="n">datasets</span><span class="p">[</span><span class="n">dataset</span><span class="p">]</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">globals</span><span class="o">.</span><span class="n">import_csv_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">[</span><span class="n">dataset</span><span class="p">])</span>

    <span class="c1"># First and last AFSC (for collecting matrices from dataframes)</span>
    <span class="n">afsc_1</span><span class="p">,</span> <span class="n">afsc_M</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;afscs&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;afscs&quot;</span><span class="p">][</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Load in extra dataframes</span>
    <span class="k">for</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;Cadets Selected&#39;</span><span class="p">:</span> <span class="s1">&#39;c_selected_matrix&#39;</span><span class="p">,</span> <span class="s1">&#39;AFSCs Buckets&#39;</span><span class="p">:</span> <span class="s1">&#39;a_bucket_matrix&#39;</span><span class="p">}</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>
            <span class="n">p</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="n">dataset</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">afsc_1</span><span class="p">:</span> <span class="n">afsc_M</span><span class="p">])</span>

    <span class="c1"># Determine how we incorporate the original cadets&#39; utility matrix</span>
    <span class="k">if</span> <span class="s2">&quot;Cadets Utility&quot;</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>  <span class="c1"># Load in the matrix directly</span>
        <span class="n">p</span><span class="p">[</span><span class="s2">&quot;utility&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;Cadets Utility&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">afsc_1</span><span class="p">:</span> <span class="n">afsc_M</span><span class="p">])</span>
    <span class="k">elif</span> <span class="s2">&quot;c_utilities&quot;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>  <span class="c1"># Create the matrix using the columns</span>

        <span class="c1"># Create utility matrix (numpy array NxM) from the utility/preference column information</span>
        <span class="n">p</span><span class="p">[</span><span class="s2">&quot;utility&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">]])</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">]):</span>
            <span class="k">for</span> <span class="n">util</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;num_util&#39;</span><span class="p">]):</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;c_preferences&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">util</span><span class="p">]</span> <span class="o">==</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;afscs&quot;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">p</span><span class="p">[</span><span class="s1">&#39;utility&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;c_utilities&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">util</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error. No cadet utility data provided which is required.&quot;</span><span class="p">)</span>

    <span class="c1"># Cadets &quot;Real&quot; Utility (after aggregating it with their ordinal rankings)</span>
    <span class="k">if</span> <span class="s1">&#39;Cadets Utility (Final)&#39;</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>  <span class="c1"># Load in the cadet utility matrix</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadet_utility&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;Cadets Utility (Final)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">afsc_1</span><span class="p">:</span> <span class="n">afsc_M</span><span class="p">])</span>

    <span class="c1"># Determine how we incorporate the cadets&#39; preferences dataframe</span>
    <span class="k">if</span> <span class="s2">&quot;Cadets Preferences&quot;</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>  <span class="c1"># Load in the preferences dataframe directly</span>
        <span class="n">p</span><span class="p">[</span><span class="s2">&quot;c_pref_matrix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;Cadets Preferences&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">afsc_1</span><span class="p">:</span> <span class="n">afsc_M</span><span class="p">])</span>
    <span class="k">elif</span> <span class="s2">&quot;c_preferences&quot;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>  <span class="c1"># Create the preferences dataframe using the columns</span>

        <span class="c1"># Create cadet preferences dataframe (numpy array NxM) from the preference column information</span>
        <span class="n">p</span><span class="p">[</span><span class="s2">&quot;c_pref_matrix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">]])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">]):</span>
            <span class="k">for</span> <span class="n">util</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">]):</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;c_preferences&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">util</span><span class="p">]</span> <span class="o">==</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;afscs&quot;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">p</span><span class="p">[</span><span class="s1">&#39;c_pref_matrix&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">util</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># 1 is first choice (NOT 0)</span>

    <span class="c1"># AFSC preferences and utilities are not required initial data elements (Depending on how we solve, they may be)</span>
    <span class="k">if</span> <span class="s2">&quot;AFSCs Utility&quot;</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>  <span class="c1"># Load in the AFSC utility matrix</span>
        <span class="n">p</span><span class="p">[</span><span class="s2">&quot;afsc_utility&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;AFSCs Utility&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">afsc_1</span><span class="p">:</span> <span class="n">afsc_M</span><span class="p">])</span>
    <span class="k">if</span> <span class="s2">&quot;AFSCs Preferences&quot;</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>  <span class="c1"># Load in the AFSC preferences dataframe</span>
        <span class="n">p</span><span class="p">[</span><span class="s2">&quot;a_pref_matrix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;AFSCs Preferences&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">afsc_1</span><span class="p">:</span> <span class="n">afsc_M</span><span class="p">])</span>

    <span class="c1"># All USAFA Cadets</span>
    <span class="n">p</span><span class="p">[</span><span class="s1">&#39;usafa_cadets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;usafa&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Rated dataframes</span>
    <span class="k">if</span> <span class="s2">&quot;ROTC Rated Interest&quot;</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>
        <span class="n">r_afscs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;ROTC Rated Interest&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;rr_interest_matrix&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;ROTC Rated Interest&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">r_afscs</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">r_afscs</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">r_afscs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]])</span>
    <span class="k">if</span> <span class="s2">&quot;ROTC Rated OM&quot;</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>
        <span class="n">r_afscs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;ROTC Rated OM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;rr_om_matrix&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;ROTC Rated OM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">r_afscs</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">r_afscs</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">r_afscs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]])</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;rr_om_cadets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;ROTC Rated OM&#39;</span><span class="p">][</span><span class="s1">&#39;Cadet&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="s2">&quot;USAFA Rated OM&quot;</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>
        <span class="n">r_afscs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;USAFA Rated OM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;ur_om_matrix&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;USAFA Rated OM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">r_afscs</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">r_afscs</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">r_afscs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]])</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;ur_om_cadets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;USAFA Rated OM&#39;</span><span class="p">][</span><span class="s1">&#39;Cadet&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="s2">&quot;OTS Rated OM&quot;</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>
        <span class="n">r_afscs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;OTS Rated OM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;or_om_matrix&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;OTS Rated OM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">r_afscs</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">r_afscs</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">r_afscs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]])</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;or_om_cadets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;OTS Rated OM&#39;</span><span class="p">][</span><span class="s1">&#39;Cadet&#39;</span><span class="p">])</span>

    <span class="c1"># Return dictionary of parameters</span>
    <span class="k">return</span> <span class="n">p</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="data.processing.import_value_parameters_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">import_value_parameters_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">num_breakpoints</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Imports the data pertaining to the value parameters of the model.</p>
<p>Args:
    import_filepaths (dict): A dictionary of file paths to import.
        Required keys: "Model Input", "Value Parameters".
        Optional key: "Cadets Utility Constraints".
    parameters (dict): A dictionary of parameters for the model.
    num_breakpoints (int): The number of breakpoints to use for value functions.</p>
<p>Returns:
    dict: A dictionary containing the value parameters for the model.</p>
<p>Raises:
    FileNotFoundError: If a file path in import_filepaths is invalid.</p>
<p>The "value parameters" refer to the weights, values, and constraints applied to the VFT model that by in large
the analyst determines. The function loads the following data:
    - A dataframe of cadet utility constraints (if present).
    - A dataframe of value parameters that describes sets of weights, values, and constraints for the VFT model.
    - A dataframe for each set of value parameters, specifying weights, values, and constraints for the VFT model.
The function returns a dictionary of value parameters, containing the following keys:
    - 'O': The number of AFSC objectives.
    - 'afscs_overall_weight': The weight for the AFSCs component.
    - 'cadets_overall_weight': The weight for the cadets component.
    - 'cadet_weight_function': The type of function used to calculate cadet weights.
    - 'afsc_weight_function': The type of function used to calculate AFSC weights.
    - 'cadets_overall_value_min': The minimum value for the cadets component.
    - 'afscs_overall_value_min': The minimum value for the AFSCs component.
    - 'M': The number of AFSCs.
    - 'afsc_value_min': An array of minimum AFSC values.
    - 'cadet_value_min': An array of minimum cadet values.
    - 'objective_value_min': A 2D array of minimum objective values.
    - 'value_functions': A 2D array of value functions for each AFSC objective.
    - 'constraint_type': A 2D array specifying the type of constraint for each objective and AFSC.
    - 'a': A nested list of breakpoints for each AFSC objective.
    - 'objective_target': A 2D array of target values for each objective and AFSC.
    - 'f^hat': A nested list of breakpoint values for each objective and AFSC.
    - 'objective_weight': A 2D array of weights for each objective and AFSC.
    - 'afsc_weight': An array of weights for each AFSC.
    - 'objectives': An array of AFSC objectives.
    - 'K^A': A dictionary of weights for the cadets component.</p>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">import_value_parameters_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">num_breakpoints</span><span class="o">=</span><span class="mi">24</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Imports the data pertaining to the value parameters of the model.</span>

<span class="sd">    Args:</span>
<span class="sd">        import_filepaths (dict): A dictionary of file paths to import.</span>
<span class="sd">            Required keys: &quot;Model Input&quot;, &quot;Value Parameters&quot;.</span>
<span class="sd">            Optional key: &quot;Cadets Utility Constraints&quot;.</span>
<span class="sd">        parameters (dict): A dictionary of parameters for the model.</span>
<span class="sd">        num_breakpoints (int): The number of breakpoints to use for value functions.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing the value parameters for the model.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: If a file path in import_filepaths is invalid.</span>

<span class="sd">    The &quot;value parameters&quot; refer to the weights, values, and constraints applied to the VFT model that by in large</span>
<span class="sd">    the analyst determines. The function loads the following data:</span>
<span class="sd">        - A dataframe of cadet utility constraints (if present).</span>
<span class="sd">        - A dataframe of value parameters that describes sets of weights, values, and constraints for the VFT model.</span>
<span class="sd">        - A dataframe for each set of value parameters, specifying weights, values, and constraints for the VFT model.</span>
<span class="sd">    The function returns a dictionary of value parameters, containing the following keys:</span>
<span class="sd">        - &#39;O&#39;: The number of AFSC objectives.</span>
<span class="sd">        - &#39;afscs_overall_weight&#39;: The weight for the AFSCs component.</span>
<span class="sd">        - &#39;cadets_overall_weight&#39;: The weight for the cadets component.</span>
<span class="sd">        - &#39;cadet_weight_function&#39;: The type of function used to calculate cadet weights.</span>
<span class="sd">        - &#39;afsc_weight_function&#39;: The type of function used to calculate AFSC weights.</span>
<span class="sd">        - &#39;cadets_overall_value_min&#39;: The minimum value for the cadets component.</span>
<span class="sd">        - &#39;afscs_overall_value_min&#39;: The minimum value for the AFSCs component.</span>
<span class="sd">        - &#39;M&#39;: The number of AFSCs.</span>
<span class="sd">        - &#39;afsc_value_min&#39;: An array of minimum AFSC values.</span>
<span class="sd">        - &#39;cadet_value_min&#39;: An array of minimum cadet values.</span>
<span class="sd">        - &#39;objective_value_min&#39;: A 2D array of minimum objective values.</span>
<span class="sd">        - &#39;value_functions&#39;: A 2D array of value functions for each AFSC objective.</span>
<span class="sd">        - &#39;constraint_type&#39;: A 2D array specifying the type of constraint for each objective and AFSC.</span>
<span class="sd">        - &#39;a&#39;: A nested list of breakpoints for each AFSC objective.</span>
<span class="sd">        - &#39;objective_target&#39;: A 2D array of target values for each objective and AFSC.</span>
<span class="sd">        - &#39;f^hat&#39;: A nested list of breakpoint values for each objective and AFSC.</span>
<span class="sd">        - &#39;objective_weight&#39;: A 2D array of weights for each objective and AFSC.</span>
<span class="sd">        - &#39;afsc_weight&#39;: An array of weights for each AFSC.</span>
<span class="sd">        - &#39;objectives&#39;: An array of AFSC objectives.</span>
<span class="sd">        - &#39;K^A&#39;: A dictionary of weights for the cadets component.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">parameters</span>
    <span class="n">afccp_vp</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># Reduce the module name so it fits on one line</span>

    <span class="c1"># Import the cadets utility constraints dataframe if we have it.</span>
    <span class="k">if</span> <span class="s2">&quot;Cadets Utility Constraints&quot;</span> <span class="ow">in</span> <span class="n">import_filepaths</span><span class="p">:</span>
        <span class="n">vp_cadet_df</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">globals</span><span class="o">.</span><span class="n">import_csv_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">[</span><span class="s2">&quot;Cadets Utility Constraints&quot;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vp_cadet_df</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Import the &quot;Value Parameters&quot; dataframe if we have it. If we don&#39;t, the &quot;vp_dict&quot; will be &quot;None&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;Value Parameters&quot;</span> <span class="ow">in</span> <span class="n">import_filepaths</span><span class="p">:</span>
        <span class="n">overall_vp_df</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">globals</span><span class="o">.</span><span class="n">import_csv_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">[</span><span class="s2">&quot;Value Parameters&quot;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># Nothing more we can do now (No &quot;Value Parameters&quot; determined yet for this instance)</span>

    <span class="c1"># Information about the sets of value parameters listed in the &quot;Value Parameters&quot; dataframe</span>
    <span class="n">vp_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">overall_vp_df</span><span class="p">[</span><span class="s1">&#39;VP Name&#39;</span><span class="p">])</span>
    <span class="n">num_vps</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vp_names</span><span class="p">)</span>
    <span class="n">vp_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_vps</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>  <span class="c1"># Initially all weighted at 100%</span>
    <span class="k">if</span> <span class="s1">&#39;VP Weight&#39;</span> <span class="ow">in</span> <span class="n">overall_vp_df</span><span class="p">:</span>
        <span class="n">vp_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">overall_vp_df</span><span class="p">[</span><span class="s1">&#39;VP Weight&#39;</span><span class="p">])</span>

    <span class="c1"># Determine the filenames for the sets of value parameters (VP, VP_2, etc.)</span>
    <span class="n">vp_files</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">[</span><span class="s2">&quot;Model Input&quot;</span><span class="p">]):</span>
        <span class="k">if</span> <span class="s2">&quot;.csv&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">check_vp</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">check_vp</span> <span class="ow">in</span> <span class="n">vp_names</span> <span class="ow">and</span> <span class="s2">&quot;Utility&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>  <span class="c1"># Don&#39;t want VP Global Utility included here</span>
            <span class="n">vp_files</span><span class="p">[</span><span class="n">check_vp</span><span class="p">]</span> <span class="o">=</span> <span class="n">file</span>

    <span class="c1"># Loop through each set of value parameters and load it into the dictionary</span>
    <span class="n">vp_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">vp_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vp_names</span><span class="p">):</span>

        <span class="c1"># Only load in the set of value parameters if we have it</span>
        <span class="k">if</span> <span class="n">vp_name</span> <span class="ow">in</span> <span class="n">vp_files</span><span class="p">:</span>
            <span class="n">filepath</span> <span class="o">=</span> <span class="n">import_filepaths</span><span class="p">[</span><span class="s2">&quot;Model Input&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">vp_files</span><span class="p">[</span><span class="n">vp_name</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING. Value Parameter set &#39;&quot;</span> <span class="o">+</span> <span class="n">vp_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; listed in the &#39;Value Parameters&#39; dataframe but does&quot;</span>
                                                               <span class="s2">&quot; not have its own dataframe (.csv) in &#39;Model Inputs&#39;.&quot;</span><span class="p">)</span>
            <span class="k">continue</span>  <span class="c1"># Skip this set of value parameters</span>

        <span class="c1"># Load value parameter set dataframe</span>
        <span class="n">vp_df</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">globals</span><span class="o">.</span><span class="n">import_csv_data</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
        <span class="n">M</span><span class="p">,</span> <span class="n">O</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vp_df</span><span class="p">)</span> <span class="o">/</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">])</span>  <span class="c1"># Number of AFSCs (M) and number of AFSC objectives (O)</span>

        <span class="c1"># Initialize value parameters dictionary</span>
        <span class="n">value_parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="n">O</span><span class="p">,</span> <span class="s2">&quot;afscs_overall_weight&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">overall_vp_df</span><span class="p">[</span><span class="s1">&#39;AFSCs Weight&#39;</span><span class="p">])[</span><span class="n">v</span><span class="p">],</span>
                            <span class="s2">&quot;cadets_overall_weight&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">overall_vp_df</span><span class="p">[</span><span class="s1">&#39;Cadets Weight&#39;</span><span class="p">])[</span><span class="n">v</span><span class="p">],</span>
                            <span class="s2">&quot;cadet_weight_function&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">overall_vp_df</span><span class="p">[</span><span class="s1">&#39;Cadet Weight Function&#39;</span><span class="p">])[</span><span class="n">v</span><span class="p">],</span>
                            <span class="s2">&quot;afsc_weight_function&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">overall_vp_df</span><span class="p">[</span><span class="s1">&#39;AFSC Weight Function&#39;</span><span class="p">])[</span><span class="n">v</span><span class="p">],</span>
                            <span class="s2">&quot;cadets_overall_value_min&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">overall_vp_df</span><span class="p">[</span><span class="s1">&#39;Cadets Min Value&#39;</span><span class="p">])[</span><span class="n">v</span><span class="p">],</span>
                            <span class="s2">&quot;afscs_overall_value_min&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">overall_vp_df</span><span class="p">[</span><span class="s1">&#39;AFSCs Min Value&#39;</span><span class="p">])[</span><span class="n">v</span><span class="p">],</span> <span class="s2">&quot;M&quot;</span><span class="p">:</span> <span class="n">M</span><span class="p">,</span>
                            <span class="s2">&quot;afsc_value_min&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">M</span><span class="p">),</span> <span class="s1">&#39;cadet_value_min&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]),</span>
                            <span class="s2">&quot;objective_value_min&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">20</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">O</span><span class="p">)]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">)]),</span>
                            <span class="s2">&quot;value_functions&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">200</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">O</span><span class="p">)]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">)]),</span>
                            <span class="s2">&quot;constraint_type&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">M</span><span class="p">,</span> <span class="n">O</span><span class="p">]),</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">O</span><span class="p">)]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">)],</span>
                            <span class="s2">&quot;objective_target&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">M</span><span class="p">,</span> <span class="n">O</span><span class="p">]),</span> <span class="s1">&#39;f^hat&#39;</span><span class="p">:</span> <span class="p">[[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">O</span><span class="p">)]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">)],</span>
                            <span class="s2">&quot;objective_weight&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">M</span><span class="p">,</span> <span class="n">O</span><span class="p">]),</span> <span class="s2">&quot;afsc_weight&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">M</span><span class="p">),</span>
                            <span class="s1">&#39;objectives&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vp_df</span><span class="p">)</span> <span class="o">/</span> <span class="n">M</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Objective&#39;</span><span class="p">]),</span> <span class="s2">&quot;K^A&quot;</span><span class="p">:</span> <span class="p">{},</span>
                            <span class="s1">&#39;num_breakpoints&#39;</span><span class="p">:</span> <span class="n">num_breakpoints</span><span class="p">}</span>

        <span class="c1"># If we have constraints specified for cadet utility</span>
        <span class="k">if</span> <span class="n">vp_cadet_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">value_parameters</span><span class="p">[</span><span class="s2">&quot;cadet_value_min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vp_cadet_df</span><span class="p">[</span><span class="n">vp_name</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

        <span class="c1"># Determine weights on cadets</span>
        <span class="k">if</span> <span class="s1">&#39;merit_all&#39;</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
            <span class="n">value_parameters</span><span class="p">[</span><span class="s1">&#39;cadet_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">afccp_vp</span><span class="o">.</span><span class="n">cadet_weight_function</span><span class="p">(</span>
                <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;merit_all&#39;</span><span class="p">],</span> <span class="n">func</span><span class="o">=</span><span class="n">value_parameters</span><span class="p">[</span><span class="s1">&#39;cadet_weight_function&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value_parameters</span><span class="p">[</span><span class="s1">&#39;cadet_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">afccp_vp</span><span class="o">.</span><span class="n">cadet_weight_function</span><span class="p">(</span>
                <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;merit&#39;</span><span class="p">],</span> <span class="n">func</span><span class="o">=</span><span class="n">value_parameters</span><span class="p">[</span><span class="s1">&#39;cadet_weight_function&#39;</span><span class="p">])</span>

        <span class="c1"># Load in value parameter data for each AFSC</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;J&quot;</span><span class="p">]:</span>  <span class="c1"># These are Os (Ohs) not 0s (zeros)</span>
            <span class="n">value_parameters</span><span class="p">[</span><span class="s2">&quot;objective_target&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span><span class="p">:(</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span> <span class="o">+</span> <span class="n">O</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Objective Target&#39;</span><span class="p">])</span>

            <span class="c1"># Force objective weights to sum to 1. K^A is the set of objectives that have non-zero weights for each AFSC</span>
            <span class="n">objective_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span><span class="p">:(</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span> <span class="o">+</span> <span class="n">O</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Objective Weight&#39;</span><span class="p">])</span>
            <span class="n">value_parameters</span><span class="p">[</span><span class="s2">&quot;objective_weight&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">objective_weights</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">objective_weights</span><span class="p">)</span>
            <span class="n">value_parameters</span><span class="p">[</span><span class="s1">&#39;K^A&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">value_parameters</span><span class="p">[</span><span class="s1">&#39;objective_weight&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

            <span class="n">value_parameters</span><span class="p">[</span><span class="s2">&quot;objective_value_min&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span><span class="p">:(</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span> <span class="o">+</span> <span class="n">O</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
                                                                     <span class="s1">&#39;Min Objective Value&#39;</span><span class="p">])</span>
            <span class="n">value_parameters</span><span class="p">[</span><span class="s2">&quot;constraint_type&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span><span class="p">:(</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span> <span class="o">+</span> <span class="n">O</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Constraint Type&#39;</span><span class="p">])</span>
            <span class="n">value_parameters</span><span class="p">[</span><span class="s2">&quot;value_functions&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span><span class="p">:(</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span> <span class="o">+</span> <span class="n">O</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Value Functions&#39;</span><span class="p">])</span>
            <span class="n">value_parameters</span><span class="p">[</span><span class="s2">&quot;afsc_weight&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">vp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span><span class="p">,</span> <span class="s2">&quot;AFSC Weight&quot;</span><span class="p">]</span>
            <span class="n">value_parameters</span><span class="p">[</span><span class="s2">&quot;afsc_value_min&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">vp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span><span class="p">,</span> <span class="s2">&quot;Min Value&quot;</span><span class="p">]</span>
            <span class="n">cadets</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;I^E&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>  <span class="c1"># Indices of cadets that are eligible for this AFSC</span>

            <span class="c1"># Loop through each objective for this AFSC</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">objective</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">value_parameters</span><span class="p">[</span><span class="s1">&#39;objectives&#39;</span><span class="p">]):</span>

                <span class="c1"># Refactored column names</span>
                <span class="k">if</span> <span class="s1">&#39;Function Breakpoints&#39;</span> <span class="ow">in</span> <span class="n">vp_df</span><span class="p">:</span>
                    <span class="n">measure_col_name</span> <span class="o">=</span> <span class="s1">&#39;Function Breakpoints&#39;</span>
                    <span class="n">value_col_name</span> <span class="o">=</span> <span class="s1">&#39;Function Breakpoint Values&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">measure_col_name</span> <span class="o">=</span> <span class="s1">&#39;Function Breakpoint Measures (a)&#39;</span>
                    <span class="n">value_col_name</span> <span class="o">=</span> <span class="s1">&#39;Function Breakpoint Values (f^hat)&#39;</span>

                <span class="c1"># We import the functions directly from the breakpoints</span>
                <span class="k">if</span> <span class="n">num_breakpoints</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">a_string</span> <span class="o">=</span> <span class="n">vp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span> <span class="n">measure_col_name</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">a_string</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
                        <span class="n">value_parameters</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a_string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>
                    <span class="n">fhat_string</span> <span class="o">=</span> <span class="n">vp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="n">O</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span> <span class="n">value_col_name</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">fhat_string</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
                        <span class="n">value_parameters</span><span class="p">[</span><span class="s1">&#39;f^hat&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fhat_string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>

                <span class="c1"># Recreate the functions from the vf strings</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">vf_string</span> <span class="o">=</span> <span class="n">value_parameters</span><span class="p">[</span><span class="s2">&quot;value_functions&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">vf_string</span> <span class="o">!=</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">objective</span> <span class="o">==</span> <span class="s1">&#39;Merit&#39;</span><span class="p">:</span>
                            <span class="n">actual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;merit&#39;</span><span class="p">][</span><span class="n">cadets</span><span class="p">])</span>
                        <span class="k">elif</span> <span class="n">objective</span> <span class="o">==</span> <span class="s1">&#39;USAFA Proportion&#39;</span><span class="p">:</span>
                            <span class="n">actual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;usafa&#39;</span><span class="p">][</span><span class="n">cadets</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">actual</span> <span class="o">=</span> <span class="kc">None</span>

                        <span class="c1"># Adjust target information for the &quot;Combined Quota&quot; objective</span>
                        <span class="k">if</span> <span class="n">objective</span> <span class="o">==</span> <span class="s1">&#39;Combined Quota&#39;</span><span class="p">:</span>
                            <span class="n">minimum</span><span class="p">,</span> <span class="n">maximum</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;quota_min&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;quota_max&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                            <span class="n">target</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;quota_d&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>  <span class="c1"># Desired number of cadets</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">minimum</span><span class="p">,</span> <span class="n">maximum</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">value_parameters</span><span class="p">[</span><span class="s1">&#39;objective_target&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>

                        <span class="c1"># Construct the value function (get the breakpoint coordinates)</span>
                        <span class="n">segment_dict</span> <span class="o">=</span> <span class="n">afccp_vp</span><span class="o">.</span><span class="n">create_segment_dict_from_string</span><span class="p">(</span>
                            <span class="n">vf_string</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">actual</span><span class="o">=</span><span class="n">actual</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="n">maximum</span><span class="p">,</span> <span class="n">minimum</span><span class="o">=</span><span class="n">minimum</span><span class="p">)</span>
                        <span class="n">value_parameters</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">value_parameters</span><span class="p">[</span><span class="s1">&#39;f^hat&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">afccp_vp</span><span class="o">.</span><span class="n">value_function_builder</span><span class="p">(</span>
                            <span class="n">segment_dict</span><span class="p">,</span> <span class="n">num_breakpoints</span><span class="o">=</span><span class="n">num_breakpoints</span><span class="p">)</span>

        <span class="c1"># Force AFSC weights to sum to 1</span>
        <span class="n">value_parameters</span><span class="p">[</span><span class="s2">&quot;afsc_weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value_parameters</span><span class="p">[</span><span class="s2">&quot;afsc_weight&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">value_parameters</span><span class="p">[</span><span class="s2">&quot;afsc_weight&quot;</span><span class="p">])</span>

        <span class="c1"># &quot;Condense&quot; the value functions by removing unnecessary zeros</span>
        <span class="n">value_parameters</span> <span class="o">=</span> <span class="n">afccp_vp</span><span class="o">.</span><span class="n">condense_value_functions</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">value_parameters</span><span class="p">)</span>

        <span class="c1"># Add indexed sets and subsets of AFSCs and AFSC objectives</span>
        <span class="n">value_parameters</span> <span class="o">=</span> <span class="n">afccp_vp</span><span class="o">.</span><span class="n">value_parameters_sets_additions</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">value_parameters</span><span class="p">)</span>

        <span class="c1"># Save the value parameters to the dictionary</span>
        <span class="n">vp_dict</span><span class="p">[</span><span class="n">vp_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">value_parameters</span><span class="p">)</span>
        <span class="n">vp_dict</span><span class="p">[</span><span class="n">vp_name</span><span class="p">][</span><span class="s1">&#39;vp_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vp_weights</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
        <span class="n">vp_dict</span><span class="p">[</span><span class="n">vp_name</span><span class="p">][</span><span class="s1">&#39;vp_local_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vp_weights</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">vp_weights</span><span class="p">)</span>

    <span class="c1"># Return the dictionary of value parameter sets</span>
    <span class="k">return</span> <span class="n">vp_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="data.processing.import_solutions_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">import_solutions_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>This function takes in the names of the files (and paths) to import, as well as a dictionary of parameters (p)
and then imports the "Solutions" dataframe. A dictionary of solutions is then returned.</p>
<p>Args:
    import_filepaths (dict): A dictionary of file names (and paths) to import.
    parameters (dict): A dictionary of parameters needed for the function to run.</p>
<p>Returns:
    dict: A dictionary of solutions for the given parameters.</p>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">import_solutions_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function takes in the names of the files (and paths) to import, as well as a dictionary of parameters (p)</span>
<span class="sd">    and then imports the &quot;Solutions&quot; dataframe. A dictionary of solutions is then returned.</span>

<span class="sd">    Args:</span>
<span class="sd">        import_filepaths (dict): A dictionary of file names (and paths) to import.</span>
<span class="sd">        parameters (dict): A dictionary of parameters needed for the function to run.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary of solutions for the given parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">parameters</span>

    <span class="c1"># Import the &quot;Solutions&quot; dataframe if we have it. If we don&#39;t, the &quot;solutions_dict&quot; will be &quot;None&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;Solutions&quot;</span> <span class="ow">in</span> <span class="n">import_filepaths</span><span class="p">:</span>
        <span class="n">solutions_df</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">globals</span><span class="o">.</span><span class="n">import_csv_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">[</span><span class="s2">&quot;Solutions&quot;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># Nothing more we can do now (No solutions determined yet for this instance)</span>

    <span class="c1"># Get list of solution names</span>
    <span class="n">solution_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">solutions_df</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="c1"># Loop through each solution, convert to a numpy array of AFSC indices, and then add it to the dictionary</span>
    <span class="n">solutions</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">solution_name</span> <span class="ow">in</span> <span class="n">solution_names</span><span class="p">:</span>

        <span class="c1"># Convert solution of AFSC names to indices and then save it to the dictionary</span>
        <span class="n">afsc_solution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">solutions_df</span><span class="p">[</span><span class="n">solution_name</span><span class="p">])</span>  <span class="c1"># [&quot;15A&quot;, &quot;14N&quot;, &quot;17X&quot;, ...]</span>
        <span class="n">solution</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;j_array&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">afsc</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="n">afsc_solution</span><span class="p">]),</span> <span class="c1"># [3, 2, 5, ...]</span>
                    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">solution_name</span><span class="p">,</span> <span class="s1">&#39;afsc_array&#39;</span><span class="p">:</span> <span class="n">afsc_solution</span><span class="p">}</span>
        <span class="n">solutions</span><span class="p">[</span><span class="n">solution_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span>

    <span class="c1"># If we have this extra component</span>
    <span class="k">if</span> <span class="s1">&#39;Base Solutions&#39;</span> <span class="ow">in</span> <span class="n">import_filepaths</span><span class="p">:</span>
        <span class="n">solutions_df</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">globals</span><span class="o">.</span><span class="n">import_csv_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">[</span><span class="s1">&#39;Base Solutions&#39;</span><span class="p">])</span>

        <span class="c1"># Get list of solution names</span>
        <span class="n">solution_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">solutions_df</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">1</span><span class="p">:]</span>

        <span class="c1"># Loop through each solution in this dataframe and add the base assignments</span>
        <span class="k">for</span> <span class="n">solution_name</span> <span class="ow">in</span> <span class="n">solution_names</span><span class="p">:</span>
            <span class="n">base_solution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">solutions_df</span><span class="p">[</span><span class="n">solution_name</span><span class="p">])</span>
            <span class="n">solutions</span><span class="p">[</span><span class="n">solution_name</span><span class="p">][</span><span class="s1">&#39;base_array&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">base_solution</span>
            <span class="n">solutions</span><span class="p">[</span><span class="n">solution_name</span><span class="p">][</span><span class="s1">&#39;b_array&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;bases&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">base</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">base</span> <span class="ow">in</span> <span class="n">base_solution</span> <span class="k">else</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">base</span> <span class="ow">in</span> <span class="n">base_solution</span><span class="p">])</span>

    <span class="c1"># If we have this extra component</span>
    <span class="k">if</span> <span class="s1">&#39;Course Solutions&#39;</span> <span class="ow">in</span> <span class="n">import_filepaths</span><span class="p">:</span>
        <span class="n">solutions_df</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">globals</span><span class="o">.</span><span class="n">import_csv_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">[</span><span class="s1">&#39;Course Solutions&#39;</span><span class="p">])</span>

        <span class="c1"># Get list of solution names</span>
        <span class="n">solution_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">solutions_df</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">1</span><span class="p">:]</span>

        <span class="c1"># Loop through each solution in this dataframe and add the course assignments</span>
        <span class="k">for</span> <span class="n">solution_name</span> <span class="ow">in</span> <span class="n">solution_names</span><span class="p">:</span>
            <span class="n">course_solution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">solutions_df</span><span class="p">[</span><span class="n">solution_name</span><span class="p">])</span>
            <span class="n">solutions</span><span class="p">[</span><span class="n">solution_name</span><span class="p">][</span><span class="s1">&#39;course_array&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">course_solution</span>
            <span class="n">c_array</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">course</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">course_solution</span><span class="p">):</span>
                <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="n">course</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;courses&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]:</span>
                        <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;courses&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">course</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">c_array</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">j</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
                        <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">break</span>

                <span class="c1"># This shouldn&#39;t happen!</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Course &#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">course</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39; not valid for cadet&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                    <span class="n">c_array</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="n">solutions</span><span class="p">[</span><span class="n">solution_name</span><span class="p">][</span><span class="s1">&#39;c_array&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">c_array</span><span class="p">)</span>

    <span class="c1"># Return the dictionary of solutions</span>
    <span class="k">return</span> <span class="n">solutions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="data.processing.import_additional_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">import_additional_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Imports additional csv files and updates the instance parameters dictionary with the values from the file.
    Extra datasets: "Bases.csv"
Args:
    import_filepaths (dict): A dictionary of filepaths containing the location of the additional csv files.
    parameters (dict): A dictionary of instance parameters to update.</p>
<p>Returns:
    dict: The updated instance parameters.</p>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">import_additional_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Imports additional csv files and updates the instance parameters dictionary with the values from the file.</span>
<span class="sd">        Extra datasets: &quot;Bases.csv&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        import_filepaths (dict): A dictionary of filepaths containing the location of the additional csv files.</span>
<span class="sd">        parameters (dict): A dictionary of instance parameters to update.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: The updated instance parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">parameters</span>

    <span class="c1"># Loop through the potential additional dataframes and import them if we have them</span>
    <span class="n">datasets</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Bases&quot;</span><span class="p">,</span> <span class="s2">&quot;Bases Preferences&quot;</span><span class="p">,</span> <span class="s2">&quot;Bases Utility&quot;</span><span class="p">,</span> <span class="s2">&quot;Courses&quot;</span><span class="p">,</span> <span class="s2">&quot;Castle Input&quot;</span><span class="p">]:</span>

        <span class="c1"># If we have the dataset, import it</span>
        <span class="k">if</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">import_filepaths</span><span class="p">:</span>
            <span class="n">datasets</span><span class="p">[</span><span class="n">dataset</span><span class="p">]</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">globals</span><span class="o">.</span><span class="n">import_csv_data</span><span class="p">(</span><span class="n">import_filepaths</span><span class="p">[</span><span class="n">dataset</span><span class="p">])</span>

    <span class="c1"># First and last AFSC (for collecting matrices from dataframes)</span>
    <span class="n">afsc_1</span><span class="p">,</span> <span class="n">afsc_M</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;afscs&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;afscs&quot;</span><span class="p">][</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Extract data from &quot;Bases.csv&quot; if applicable</span>
    <span class="k">if</span> <span class="s2">&quot;Bases&quot;</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;bases&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;Bases&quot;</span><span class="p">][</span><span class="s2">&quot;Base&quot;</span><span class="p">])</span>  <span class="c1"># Set of bases (names)</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;bases&#39;</span><span class="p">])</span>  <span class="c1"># Number of bases (S for &quot;Station&quot;)</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;base_min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;Bases&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">afsc_1</span> <span class="o">+</span> <span class="s2">&quot; Min&quot;</span><span class="p">:</span> <span class="n">afsc_M</span> <span class="o">+</span> <span class="s2">&quot; Min&quot;</span><span class="p">])</span>  <span class="c1"># Minimum base # by AFSC</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;base_max&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;Bases&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">afsc_1</span> <span class="o">+</span> <span class="s2">&quot; Max&quot;</span><span class="p">:</span> <span class="n">afsc_M</span> <span class="o">+</span> <span class="s2">&quot; Max&quot;</span><span class="p">])</span>  <span class="c1"># Maximum base # by AFSC</span>

    <span class="c1"># Extract data from &quot;Base Preferences.csv&quot; and &quot;Base Utility.csv&quot; if applicable</span>
    <span class="k">for</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;b_pref_matrix&#39;</span><span class="p">:</span> <span class="s1">&#39;Bases Preferences&#39;</span><span class="p">,</span> <span class="s1">&#39;base_utility&#39;</span><span class="p">:</span> <span class="s1">&#39;Bases Utility&#39;</span><span class="p">}</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>
            <span class="n">base_1</span><span class="p">,</span> <span class="n">base_S</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;bases&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;bases&#39;</span><span class="p">][</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">p</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="n">dataset</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">base_1</span><span class="p">:</span> <span class="n">base_S</span><span class="p">])</span>

    <span class="c1"># Extract data from &quot;Courses.csv&quot; if applicable</span>
    <span class="k">if</span> <span class="s2">&quot;Courses&quot;</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>

        <span class="c1"># Need a dictionary of indices of courses that apply to each AFSC</span>
        <span class="n">afscs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;Courses&quot;</span><span class="p">][</span><span class="s2">&quot;AFSC&quot;</span><span class="p">])</span>
        <span class="n">afsc_courses</span> <span class="o">=</span> <span class="p">{</span><span class="n">j</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">afscs</span> <span class="o">==</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">])}</span>

        <span class="c1"># Dictionary to translate parameter names to column names</span>
        <span class="n">column_translation</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Course&quot;</span><span class="p">:</span> <span class="s1">&#39;courses&#39;</span><span class="p">,</span> <span class="s1">&#39;Start Date&#39;</span><span class="p">:</span> <span class="s1">&#39;course_start&#39;</span><span class="p">,</span> <span class="s1">&#39;Min&#39;</span><span class="p">:</span> <span class="s1">&#39;course_min&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;Max&#39;</span><span class="p">:</span> <span class="s1">&#39;course_max&#39;</span><span class="p">}</span>

        <span class="c1"># Get each parameter from the columns of this dataset</span>
        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">column_translation</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;Courses&#39;</span><span class="p">][</span><span class="n">col</span><span class="p">])</span>  <span class="c1"># Convert dataframe column to numpy array</span>
            <span class="n">p</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">j</span><span class="p">:</span> <span class="n">arr</span><span class="p">[</span><span class="n">afsc_courses</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">])}</span>

    <span class="c1"># Extract data from &quot;Castle Input.csv&quot; if applicable</span>
    <span class="k">if</span> <span class="s2">&quot;Castle Input&quot;</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>

        <span class="c1"># Load in AFSC arrays</span>
        <span class="n">castle_afscs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;Castle Input&#39;</span><span class="p">][</span><span class="s1">&#39;CASTLE AFSC&#39;</span><span class="p">])</span>
        <span class="n">afpc_afscs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;Castle Input&#39;</span><span class="p">][</span><span class="s1">&#39;AFPC AFSC&#39;</span><span class="p">])</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;castle_afscs_arr&#39;</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;afpc_afscs_arr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">castle_afscs</span><span class="p">,</span> <span class="n">afpc_afscs</span>

        <span class="c1"># Create dictionary of CASTLE AFSCs -&gt; AFPC AFSCs (account for groupings)</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;castle_afscs&#39;</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^CASTLE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">castle_afsc</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">castle_afscs</span><span class="p">):</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">castle_afscs</span> <span class="o">==</span> <span class="n">castle_afsc</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">p</span><span class="p">[</span><span class="s1">&#39;castle_afscs&#39;</span><span class="p">][</span><span class="n">castle_afsc</span><span class="p">]</span> <span class="o">=</span> <span class="n">afpc_afscs</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
            <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^CASTLE&#39;</span><span class="p">][</span><span class="n">castle_afsc</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">afsc</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="n">afpc_afscs</span><span class="p">[</span><span class="n">indices</span><span class="p">]])</span>

        <span class="c1"># Initialize OTS counts and optimal policy dictionary</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;ots_counts&#39;</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;optimal_policy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>

        <span class="c1"># Load in &quot;q&quot; dictionary information if it exists</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;Castle Input&#39;</span><span class="p">]</span>  <span class="c1"># Shorthand</span>
        <span class="k">if</span> <span class="s1">&#39;a&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">q</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;f^hat&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="p">{}}</span>
            <span class="k">for</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">castle_afscs</span><span class="p">):</span>
                <span class="n">row</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;CASTLE AFSC&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">afsc</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                <span class="c1"># Add OTS count information and optimal policy information for this AFSC</span>
                <span class="n">p</span><span class="p">[</span><span class="s1">&#39;ots_counts&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;OTS Count&#39;</span><span class="p">]</span>
                <span class="n">p</span><span class="p">[</span><span class="s1">&#39;optimal_policy&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Optimal&#39;</span><span class="p">]</span>

                <span class="c1"># Load breakpoint coordinates into q dictionary</span>
                <span class="n">a_str</span><span class="p">,</span> <span class="n">f_hat_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]),</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;f^hat&#39;</span><span class="p">])</span>
                <span class="n">q</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)])</span>
                <span class="n">q</span><span class="p">[</span><span class="s1">&#39;f^hat&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">f_hat_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)])</span>

                <span class="c1"># Save additional information to q dictionary</span>
                <span class="n">q</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">]))</span>
                <span class="n">p</span><span class="p">[</span><span class="s1">&#39;castle_q&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">q</span>  <span class="c1"># Save to parameters dictionary</span>

    <span class="c1"># Return parameters dictionary</span>
    <span class="k">return</span> <span class="n">p</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="data.processing.export_afscs_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">export_afscs_data</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>This function takes an Instance object as an argument, which contains the AFSC data to be exported.
It creates a dictionary of columns to be included in the "AFSCs" csv file by translating AFSC parameters
to their corresponding column names in the file. The function then creates a dataframe using these columns
and exports it as a csv file to the path specified in the export_paths attribute of the Instance object.</p>
<p>Args:
    instance (Instance): An Instance object containing the AFSC data to export.</p>
<p>Returns:
    None</p>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">export_afscs_data</span><span class="p">(</span><span class="n">instance</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function takes an Instance object as an argument, which contains the AFSC data to be exported.</span>
<span class="sd">    It creates a dictionary of columns to be included in the &quot;AFSCs&quot; csv file by translating AFSC parameters</span>
<span class="sd">    to their corresponding column names in the file. The function then creates a dataframe using these columns</span>
<span class="sd">    and exports it as a csv file to the path specified in the export_paths attribute of the Instance object.</span>

<span class="sd">    Args:</span>
<span class="sd">        instance (Instance): An Instance object containing the AFSC data to export.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span>

    <span class="c1"># Initialize dictionary translating AFSC parameters to their &quot;AFSCs&quot; df column counterparts</span>
    <span class="n">afsc_parameters_to_columns</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;afscs&quot;</span><span class="p">:</span> <span class="s2">&quot;AFSC&quot;</span><span class="p">,</span> <span class="s2">&quot;acc_grp&quot;</span><span class="p">:</span> <span class="s2">&quot;Accessions Group&quot;</span><span class="p">,</span> <span class="s2">&quot;afscs_stem&quot;</span><span class="p">:</span> <span class="s2">&quot;STEM&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;usafa_quota&quot;</span><span class="p">:</span> <span class="s2">&quot;USAFA Target&quot;</span><span class="p">,</span> <span class="s2">&quot;rotc_quota&quot;</span><span class="p">:</span> <span class="s2">&quot;ROTC Target&quot;</span><span class="p">,</span> <span class="s1">&#39;ots_quota&#39;</span><span class="p">:</span> <span class="s1">&#39;OTS Target&#39;</span><span class="p">,</span>
                                  <span class="s2">&quot;pgl&quot;</span><span class="p">:</span> <span class="s2">&quot;PGL Target&quot;</span><span class="p">,</span> <span class="s2">&quot;quota_e&quot;</span><span class="p">:</span> <span class="s2">&quot;Estimated&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;quota_d&quot;</span><span class="p">:</span> <span class="s2">&quot;Desired&quot;</span><span class="p">,</span> <span class="s2">&quot;quota_min&quot;</span><span class="p">:</span> <span class="s2">&quot;Min&quot;</span><span class="p">,</span> <span class="s2">&quot;quota_max&quot;</span><span class="p">:</span> <span class="s2">&quot;Max&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;afsc_assign_base&quot;</span><span class="p">:</span> <span class="s1">&#39;Assign Base&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="s1">&#39;Num Courses&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;usafa_eligible_count&#39;</span><span class="p">:</span> <span class="s1">&#39;USAFA Eligible&#39;</span><span class="p">,</span> <span class="s1">&#39;rotc_eligible_count&#39;</span><span class="p">:</span> <span class="s1">&#39;ROTC Eligible&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;ots_eligible_count&#39;</span><span class="p">:</span> <span class="s2">&quot;OTS Eligible&quot;</span><span class="p">}</span>

    <span class="c1"># Loop through each parameter in the translation dictionary to create dictionary of &quot;AFSCs&quot; columns</span>
    <span class="n">afscs_columns</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">afsc_parameters_to_columns</span><span class="p">:</span>

        <span class="c1"># If we have the parameter, create the column</span>
        <span class="k">if</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
            <span class="n">col_name</span> <span class="o">=</span> <span class="n">afsc_parameters_to_columns</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span>
            <span class="n">afscs_columns</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">parameter</span><span class="p">][:</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">]]</span>  <span class="c1"># Don&#39;t want to include the *!</span>

    <span class="c1"># Create the degree tier columns</span>
    <span class="k">if</span> <span class="s2">&quot;Deg Tiers&quot;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">afscs_columns</span><span class="p">[</span><span class="s2">&quot;Deg Tier &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;Deg Tiers&quot;</span><span class="p">][:,</span> <span class="n">t</span><span class="p">]</span>

    <span class="c1"># Degree Tier Counts</span>
    <span class="k">if</span> <span class="s2">&quot;Tier 1&quot;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I^D&#39;</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">]:</span>
            <span class="n">afscs_columns</span><span class="p">[</span><span class="s1">&#39;Deg Tier &#39;</span> <span class="o">+</span> <span class="n">t</span> <span class="o">+</span> <span class="s1">&#39; Count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;I^D&#39;</span><span class="p">][</span><span class="s1">&#39;Tier &#39;</span> <span class="o">+</span> <span class="n">t</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]]</span>

    <span class="c1"># Preference Counts</span>
    <span class="k">if</span> <span class="s1">&#39;Choice Count&#39;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;Choice Count&#39;</span><span class="p">]:</span>
            <span class="n">afscs_columns</span><span class="p">[</span><span class="s1">&#39;Choice &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">choice</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;Choice Count&#39;</span><span class="p">][</span><span class="n">choice</span><span class="p">]</span>

    <span class="c1"># Create dataframe</span>
    <span class="n">afscs_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">afscs_columns</span><span class="p">)</span>

    <span class="c1"># Export &#39;AFSCs&#39; dataframe</span>
    <span class="n">afscs_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="s2">&quot;AFSCs&quot;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="data.processing.export_cadets_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">export_cadets_data</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Export the "Cadets" csv by taking in the names of the files (and paths) to export, as well as a dictionary of
parameters (p). The function first translates 'AFSCs' df columns to their parameter counterparts and creates
the corresponding 'Cadets' dataframe column. If cadet preference/utility columns and qualification matrix
exist in the input parameters, they will be added to the 'Cadets' dataframe. Finally, the function exports the
'Cadets' dataframe to a csv file.</p>
<p>Args:
- instance: an instance of the CadetCareerProblem class</p>
<p>Returns: None</p>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">export_cadets_data</span><span class="p">(</span><span class="n">instance</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Export the &quot;Cadets&quot; csv by taking in the names of the files (and paths) to export, as well as a dictionary of</span>
<span class="sd">    parameters (p). The function first translates &#39;AFSCs&#39; df columns to their parameter counterparts and creates</span>
<span class="sd">    the corresponding &#39;Cadets&#39; dataframe column. If cadet preference/utility columns and qualification matrix</span>
<span class="sd">    exist in the input parameters, they will be added to the &#39;Cadets&#39; dataframe. Finally, the function exports the</span>
<span class="sd">    &#39;Cadets&#39; dataframe to a csv file.</span>

<span class="sd">    Args:</span>
<span class="sd">    - instance: an instance of the CadetCareerProblem class</span>

<span class="sd">    Returns: None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span>

    <span class="c1"># Initialize dictionary translating &#39;AFSCs&#39; df columns to their parameter counterparts</span>
    <span class="n">cadet_parameters_to_columns</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cadets&quot;</span><span class="p">:</span> <span class="s2">&quot;Cadet&quot;</span><span class="p">,</span> <span class="s2">&quot;assigned&quot;</span><span class="p">:</span> <span class="s2">&quot;Assigned&quot;</span><span class="p">,</span> <span class="s2">&quot;acc_grp_constraint&quot;</span><span class="p">:</span> <span class="s2">&quot;Accessions Group&quot;</span><span class="p">,</span>
                                   <span class="s1">&#39;training_start&#39;</span><span class="p">:</span> <span class="s1">&#39;Start Date&#39;</span><span class="p">,</span> <span class="s1">&#39;training_preferences&#39;</span><span class="p">:</span> <span class="s1">&#39;Start Pref&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;base_threshold&#39;</span><span class="p">:</span> <span class="s1">&#39;Base Threshold&#39;</span><span class="p">,</span> <span class="s1">&#39;training_threshold&#39;</span><span class="p">:</span> <span class="s1">&#39;Course Threshold&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;weight_afsc&#39;</span><span class="p">:</span> <span class="s1">&#39;AFSC Weight&#39;</span><span class="p">,</span> <span class="s1">&#39;weight_base&#39;</span><span class="p">:</span> <span class="s1">&#39;Base Weight&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;weight_course&#39;</span><span class="p">:</span> <span class="s1">&#39;Course Weight&#39;</span><span class="p">,</span>
                                   <span class="s2">&quot;sf_om&quot;</span><span class="p">:</span> <span class="s2">&quot;SF OM&quot;</span><span class="p">,</span> <span class="s1">&#39;usafa&#39;</span><span class="p">:</span> <span class="s1">&#39;USAFA&#39;</span><span class="p">,</span> <span class="s1">&#39;soc&#39;</span><span class="p">:</span> <span class="s1">&#39;SOC&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;male&#39;</span><span class="p">:</span> <span class="s1">&#39;Male&#39;</span><span class="p">,</span> <span class="s1">&#39;minority&#39;</span><span class="p">:</span> <span class="s1">&#39;Minority&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;race&#39;</span><span class="p">:</span> <span class="s1">&#39;Race&#39;</span><span class="p">,</span> <span class="s2">&quot;ethnicity&quot;</span><span class="p">:</span> <span class="s2">&quot;Ethnicity&quot;</span><span class="p">,</span> <span class="s1">&#39;asc1&#39;</span><span class="p">:</span> <span class="s1">&#39;ASC1&#39;</span><span class="p">,</span> <span class="s1">&#39;asc2&#39;</span><span class="p">:</span> <span class="s1">&#39;ASC2&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;stem&#39;</span><span class="p">:</span> <span class="s1">&#39;STEM&#39;</span><span class="p">,</span> <span class="s1">&#39;cip1&#39;</span><span class="p">:</span> <span class="s1">&#39;CIP1&#39;</span><span class="p">,</span> <span class="s1">&#39;cip2&#39;</span><span class="p">:</span> <span class="s1">&#39;CIP2&#39;</span><span class="p">,</span> <span class="s1">&#39;merit&#39;</span><span class="p">:</span> <span class="s1">&#39;Merit&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;merit_all&#39;</span><span class="p">:</span> <span class="s1">&#39;Real Merit&#39;</span><span class="p">,</span> <span class="s1">&#39;last_afsc&#39;</span><span class="p">:</span> <span class="s1">&#39;Least Desired AFSC&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;second_to_last_afscs&#39;</span><span class="p">:</span> <span class="s1">&#39;Second Least Desired AFSCs&#39;</span><span class="p">}</span>

    <span class="c1"># Loop through each parameter in the translation dictionary to get &quot;Cadets&quot; dataframe column counterpart</span>
    <span class="n">cadets_columns</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">cadet_parameters_to_columns</span><span class="p">:</span>

        <span class="c1"># If we have the parameter, we create its column</span>
        <span class="k">if</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
            <span class="n">col_name</span> <span class="o">=</span> <span class="n">cadet_parameters_to_columns</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span>
            <span class="n">cadets_columns</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span>

    <span class="c1"># If we had the cadet preference/utility columns before, we&#39;ll add them back in</span>
    <span class="k">if</span> <span class="s2">&quot;c_preferences&quot;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>

        <span class="c1"># Add utility columns</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;num_util&quot;</span><span class="p">]):</span>
            <span class="n">cadets_columns</span><span class="p">[</span><span class="s2">&quot;Util_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;c_utilities&quot;</span><span class="p">][:,</span> <span class="n">c</span><span class="p">]</span>

        <span class="c1"># Add preference columns</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">]):</span>
            <span class="n">cadets_columns</span><span class="p">[</span><span class="s2">&quot;Pref_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;c_preferences&quot;</span><span class="p">][:,</span> <span class="n">c</span><span class="p">]</span>

    <span class="c1"># If we have the qual matrix, we add that here</span>
    <span class="k">if</span> <span class="s2">&quot;qual&quot;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>

        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;afscs&quot;</span><span class="p">][:</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">]]):</span>
            <span class="n">cadets_columns</span><span class="p">[</span><span class="s2">&quot;qual_&quot;</span> <span class="o">+</span> <span class="n">afsc</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;qual&#39;</span><span class="p">][:,</span> <span class="n">j</span><span class="p">]</span>

    <span class="c1"># Create dataframe</span>
    <span class="n">cadets_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cadets_columns</span><span class="p">)</span>

    <span class="c1"># Export &#39;Cadets&#39; dataframe</span>
    <span class="n">cadets_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="s2">&quot;Cadets&quot;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="data.processing.export_afsc_cadet_matrices_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">export_afsc_cadet_matrices_data</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Exports the preferences dataframes if they exist in the instance's parameters dictionary.</p>
<p>Parameters:
instance (Instance): An Instance object containing the parameters dictionary and export paths.</p>
<p>Returns:
None</p>
<p>For each potential dataset to export, if it exists in the instance's parameters dictionary, a new dataframe is constructed
and exported to the corresponding file path. The potential datasets are:
- "Cadets Utility": A matrix of the utility values that each cadet assigns to each AFSC.
- "Cadets Preferences": A matrix of the preferences of each cadet for each AFSC, derived from the utility values.
- "AFSCs Utility": A matrix of the utility values that each AFSC assigns to each cadet.
- "AFSCs Preferences": A matrix of the preferences of each AFSC for each cadet, derived from the utility values.</p>
<p>Each dataframe has the cadets in the first column and the AFSCs in the remaining columns. The values in each cell
correspond to the utility or preference value of the cadet or AFSC for that particular AFSC or cadet.</p>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">export_afsc_cadet_matrices_data</span><span class="p">(</span><span class="n">instance</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Exports the preferences dataframes if they exist in the instance&#39;s parameters dictionary.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    instance (Instance): An Instance object containing the parameters dictionary and export paths.</span>

<span class="sd">    Returns:</span>
<span class="sd">    None</span>

<span class="sd">    For each potential dataset to export, if it exists in the instance&#39;s parameters dictionary, a new dataframe is constructed</span>
<span class="sd">    and exported to the corresponding file path. The potential datasets are:</span>
<span class="sd">    - &quot;Cadets Utility&quot;: A matrix of the utility values that each cadet assigns to each AFSC.</span>
<span class="sd">    - &quot;Cadets Preferences&quot;: A matrix of the preferences of each cadet for each AFSC, derived from the utility values.</span>
<span class="sd">    - &quot;AFSCs Utility&quot;: A matrix of the utility values that each AFSC assigns to each cadet.</span>
<span class="sd">    - &quot;AFSCs Preferences&quot;: A matrix of the preferences of each AFSC for each cadet, derived from the utility values.</span>

<span class="sd">    Each dataframe has the cadets in the first column and the AFSCs in the remaining columns. The values in each cell</span>
<span class="sd">    correspond to the utility or preference value of the cadet or AFSC for that particular AFSC or cadet.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">vp</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span> <span class="n">instance</span><span class="o">.</span><span class="n">value_parameters</span>

    <span class="c1"># Dataset name translations</span>
    <span class="n">parameter_trans_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;utility&quot;</span><span class="p">:</span> <span class="s2">&quot;Cadets Utility&quot;</span><span class="p">,</span> <span class="s2">&quot;c_pref_matrix&quot;</span><span class="p">:</span> <span class="s2">&quot;Cadets Preferences&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;afsc_utility&quot;</span><span class="p">:</span> <span class="s2">&quot;AFSCs Utility&quot;</span><span class="p">,</span> <span class="s2">&quot;a_pref_matrix&quot;</span><span class="p">:</span> <span class="s2">&quot;AFSCs Preferences&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;rr_interest_matrix&quot;</span><span class="p">:</span> <span class="s2">&quot;ROTC Rated Interest&quot;</span><span class="p">,</span> <span class="s2">&quot;rr_om_matrix&quot;</span><span class="p">:</span> <span class="s2">&quot;ROTC Rated OM&quot;</span><span class="p">,</span>
                            <span class="s1">&#39;ur_om_matrix&#39;</span><span class="p">:</span> <span class="s1">&#39;USAFA Rated OM&#39;</span><span class="p">,</span> <span class="s1">&#39;or_om_matrix&#39;</span><span class="p">:</span> <span class="s1">&#39;OTS Rated OM&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;cadet_utility&#39;</span><span class="p">:</span> <span class="s1">&#39;Cadets Utility (Final)&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;c_selected_matrix&#39;</span><span class="p">:</span> <span class="s1">&#39;Cadets Selected&#39;</span><span class="p">,</span> <span class="s1">&#39;a_bucket_matrix&#39;</span><span class="p">:</span> <span class="s1">&#39;AFSCs Buckets&#39;</span>
                            <span class="p">}</span>

    <span class="c1"># Get all rated AFSCs</span>
    <span class="n">all_rated_afscs</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^Rated&#39;</span><span class="p">]]</span>

    <span class="c1"># Loop through each potential dataset to export</span>
    <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">parameter_trans_dict</span><span class="p">:</span>

        <span class="c1"># If we have this dataset, we export it</span>
        <span class="k">if</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
            <span class="n">dataset</span> <span class="o">=</span> <span class="n">parameter_trans_dict</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span>

            <span class="c1"># Construct the dataframe</span>
            <span class="k">if</span> <span class="s1">&#39;ROTC&#39;</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">:</span>
                <span class="n">cadet_indices</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;Rated Cadets&quot;</span><span class="p">][</span><span class="s1">&#39;rotc&#39;</span><span class="p">]</span>
                <span class="n">pref_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Cadet&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadets&#39;</span><span class="p">][</span><span class="n">cadet_indices</span><span class="p">]})</span>
                <span class="n">afscs</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">determine_soc_rated_afscs</span><span class="p">(</span>
                    <span class="n">soc</span><span class="o">=</span><span class="s1">&#39;rotc&#39;</span><span class="p">,</span> <span class="n">all_rated_afscs</span><span class="o">=</span><span class="n">all_rated_afscs</span><span class="p">)</span>
            <span class="k">elif</span> <span class="s1">&#39;USAFA&#39;</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">:</span>
                <span class="n">cadet_indices</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;Rated Cadets&quot;</span><span class="p">][</span><span class="s1">&#39;usafa&#39;</span><span class="p">]</span>
                <span class="n">pref_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Cadet&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadets&#39;</span><span class="p">][</span><span class="n">cadet_indices</span><span class="p">]})</span>
                <span class="n">afscs</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">determine_soc_rated_afscs</span><span class="p">(</span>
                    <span class="n">soc</span><span class="o">=</span><span class="s1">&#39;usafa&#39;</span><span class="p">,</span> <span class="n">all_rated_afscs</span><span class="o">=</span><span class="n">all_rated_afscs</span><span class="p">)</span>
            <span class="k">elif</span> <span class="s1">&#39;OTS&#39;</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">:</span>
                <span class="n">cadet_indices</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;Rated Cadets&quot;</span><span class="p">][</span><span class="s1">&#39;ots&#39;</span><span class="p">]</span>
                <span class="n">pref_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Cadet&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadets&#39;</span><span class="p">][</span><span class="n">cadet_indices</span><span class="p">]})</span>
                <span class="n">afscs</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">determine_soc_rated_afscs</span><span class="p">(</span>
                    <span class="n">soc</span><span class="o">=</span><span class="s1">&#39;ots&#39;</span><span class="p">,</span> <span class="n">all_rated_afscs</span><span class="o">=</span><span class="n">all_rated_afscs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pref_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Cadet&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;cadets&quot;</span><span class="p">]})</span>
                <span class="n">afscs</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;afscs&quot;</span><span class="p">][:</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">]]</span>

            <span class="c1"># Add the AFSC columns</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">afscs</span><span class="p">):</span>
                <span class="n">pref_df</span><span class="p">[</span><span class="n">afsc</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">parameter</span><span class="p">][:,</span> <span class="n">j</span><span class="p">]</span>

            <span class="c1"># Export the dataset</span>
            <span class="n">pref_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="n">dataset</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="data.processing.export_value_parameters_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">export_value_parameters_data</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Export value parameter datasets and related information to CSV files for analysis.</p>
<p>This function exports various value parameter datasets to separate CSV files. It provides detailed information
about value parameters and constraint data for further analysis.</p>
<p>Args:
    instance (object): An object containing problem instance and value parameter data.</p>
<p>Returns:
    None</p>
<p>Details:
- Value parameters (VP) define optimization settings and constraints. This function extracts and exports different
  aspects of the VP data.</p>
<ul>
<li>
<p>Value Parameters CSVs:</p>
<ul>
<li>For each set of value parameters, this function exports a CSV file containing detailed information about
  objective weights, objectives, breakpoint measures (a), breakpoint values (f^hat), and value functions.</li>
<li>These CSVs provide insights into the parameters used in the optimization process.</li>
</ul>
</li>
<li>
<p>Global Utility CSVs (if applicable):</p>
<ul>
<li>If global utility data is included in the value parameters, this function exports a CSV containing global
  utility values for each cadet and AFSC.</li>
<li>This additional dataset is useful for assessing the global utility aspect of the optimization solution.</li>
</ul>
</li>
<li>
<p>Cadet Utility Constraints CSV:</p>
<ul>
<li>This CSV file contains information about minimum value settings for cadets.</li>
<li>It helps understand the constraints and preferences applied to individual cadets.</li>
</ul>
</li>
<li>
<p>Overall Value Parameters CSV:</p>
<ul>
<li>A summary CSV is generated, providing an overview of overall value parameters for different VP sets.</li>
<li>It includes information on weights, minimum values, weight functions, and other key parameters.</li>
</ul>
</li>
</ul>
<p>The exported CSV files are saved with informative names and extensions to distinguish between different versions
of data. The function assumes that the 'instance' object contains the required data and file paths for export.
```</p>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">export_value_parameters_data</span><span class="p">(</span><span class="n">instance</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Export value parameter datasets and related information to CSV files for analysis.</span>

<span class="sd">    This function exports various value parameter datasets to separate CSV files. It provides detailed information</span>
<span class="sd">    about value parameters and constraint data for further analysis.</span>

<span class="sd">    Args:</span>
<span class="sd">        instance (object): An object containing problem instance and value parameter data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    Details:</span>
<span class="sd">    - Value parameters (VP) define optimization settings and constraints. This function extracts and exports different</span>
<span class="sd">      aspects of the VP data.</span>

<span class="sd">    - Value Parameters CSVs:</span>
<span class="sd">        - For each set of value parameters, this function exports a CSV file containing detailed information about</span>
<span class="sd">          objective weights, objectives, breakpoint measures (a), breakpoint values (f^hat), and value functions.</span>
<span class="sd">        - These CSVs provide insights into the parameters used in the optimization process.</span>

<span class="sd">    - Global Utility CSVs (if applicable):</span>
<span class="sd">        - If global utility data is included in the value parameters, this function exports a CSV containing global</span>
<span class="sd">          utility values for each cadet and AFSC.</span>
<span class="sd">        - This additional dataset is useful for assessing the global utility aspect of the optimization solution.</span>

<span class="sd">    - Cadet Utility Constraints CSV:</span>
<span class="sd">        - This CSV file contains information about minimum value settings for cadets.</span>
<span class="sd">        - It helps understand the constraints and preferences applied to individual cadets.</span>

<span class="sd">    - Overall Value Parameters CSV:</span>
<span class="sd">        - A summary CSV is generated, providing an overview of overall value parameters for different VP sets.</span>
<span class="sd">        - It includes information on weights, minimum values, weight functions, and other key parameters.</span>

<span class="sd">    The exported CSV files are saved with informative names and extensions to distinguish between different versions</span>
<span class="sd">    of data. The function assumes that the &#39;instance&#39; object contains the required data and file paths for export.</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span>

    <span class="c1"># Error data</span>
    <span class="k">if</span> <span class="n">instance</span><span class="o">.</span><span class="n">vp_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># No value parameters to export!</span>

    <span class="c1"># Determine how we&#39;re going to show merit for context in the Cadet Constraints dataframe</span>
    <span class="n">merit_col</span> <span class="o">=</span> <span class="s2">&quot;merit&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;merit_all&quot;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
        <span class="n">merit_col</span> <span class="o">=</span> <span class="s2">&quot;merit_all&quot;</span>

    <span class="c1"># Initialize dataframes</span>
    <span class="n">vp_cadet_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Cadet&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;cadets&quot;</span><span class="p">],</span> <span class="s2">&quot;Merit&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="n">merit_col</span><span class="p">]})</span>
    <span class="n">vp_overall_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({})</span>

    <span class="c1"># Loop through each set of value parameters</span>
    <span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">vp_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">vp_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
        <span class="n">vp</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">vp_dict</span><span class="p">[</span><span class="n">vp_name</span><span class="p">]</span>

        <span class="c1"># Initialize Value Function breakpoint arrays</span>
        <span class="n">a_strings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">400</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;J&quot;</span><span class="p">]])</span>
        <span class="n">fhat_strings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">400</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;J&quot;</span><span class="p">]])</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][:</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">]]):</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">objective</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objectives&#39;</span><span class="p">]):</span>
                <span class="n">a_string_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]]</span>
                <span class="n">a_strings</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">a_string_list</span><span class="p">)</span>
                <span class="n">fhat_strings_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;f^hat&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]]</span>
                <span class="n">fhat_strings</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fhat_strings_list</span><span class="p">)</span>

        <span class="c1"># Flatten the 2-d arrays to convert them into one long list that is sorted by AFSC and then by objective</span>
        <span class="n">objective_value_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objective_value_min&#39;</span><span class="p">])</span>
        <span class="n">constraint_type</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;constraint_type&#39;</span><span class="p">])</span>
        <span class="n">objective_target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objective_target&#39;</span><span class="p">])</span>
        <span class="n">value_functions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;value_functions&#39;</span><span class="p">])</span>
        <span class="n">breakpoint_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">a_strings</span><span class="p">)</span>
        <span class="n">breakpoint_fhat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">fhat_strings</span><span class="p">)</span>

        <span class="c1"># AFSC objective swing weights</span>
        <span class="n">max_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objective_weight&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objective_weight&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">/</span> <span class="n">max_weights</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;J&quot;</span><span class="p">]])</span>
        <span class="n">objective_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">ow</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

        <span class="c1"># Repeating objectives</span>
        <span class="n">objectives</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objectives&#39;</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">])</span>

        <span class="c1"># Repeating AFSCs</span>
        <span class="n">afscs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;J&quot;</span><span class="p">])))</span>
        <span class="n">afsc_value_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;afsc_value_min&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;J&quot;</span><span class="p">])))</span>

        <span class="c1"># AFSC swing weights</span>
        <span class="n">afsc_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;afsc_weight&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;afsc_weight&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">afsc_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">afsc_weight</span><span class="p">,</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">])</span>

        <span class="c1"># Create the &quot;vp_df&quot;</span>
        <span class="n">vp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AFSC&#39;</span><span class="p">:</span> <span class="n">afscs</span><span class="p">,</span> <span class="s1">&#39;Objective&#39;</span><span class="p">:</span> <span class="n">objectives</span><span class="p">,</span> <span class="s1">&#39;Objective Weight&#39;</span><span class="p">:</span> <span class="n">objective_weight</span><span class="p">,</span>
                              <span class="s1">&#39;Objective Target&#39;</span><span class="p">:</span> <span class="n">objective_target</span><span class="p">,</span> <span class="s1">&#39;AFSC Weight&#39;</span><span class="p">:</span> <span class="n">afsc_weight</span><span class="p">,</span>
                              <span class="s1">&#39;Min Value&#39;</span><span class="p">:</span> <span class="n">afsc_value_min</span><span class="p">,</span> <span class="s1">&#39;Min Objective Value&#39;</span><span class="p">:</span> <span class="n">objective_value_min</span><span class="p">,</span>
                              <span class="s1">&#39;Constraint Type&#39;</span><span class="p">:</span> <span class="n">constraint_type</span><span class="p">,</span> <span class="s1">&#39;Function Breakpoint Measures (a)&#39;</span><span class="p">:</span> <span class="n">breakpoint_a</span><span class="p">,</span>
                              <span class="s1">&#39;Function Breakpoint Values (f^hat)&#39;</span><span class="p">:</span> <span class="n">breakpoint_fhat</span><span class="p">,</span>
                              <span class="s1">&#39;Value Functions&#39;</span><span class="p">:</span> <span class="n">value_functions</span><span class="p">})</span>

        <span class="c1"># Add the minimum value column for this set of value parameters to the cadets df</span>
        <span class="n">vp_cadet_df</span><span class="p">[</span><span class="n">vp_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">vp</span><span class="p">[</span><span class="s2">&quot;cadet_value_min&quot;</span><span class="p">]</span>

        <span class="c1"># Initialize overall vp column dictionary</span>
        <span class="n">overall_vp_columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;VP Name&#39;</span><span class="p">:</span> <span class="n">vp_name</span><span class="p">,</span>
                              <span class="s1">&#39;Cadets Weight&#39;</span><span class="p">:</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;cadets_overall_weight&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;AFSCs Weight&#39;</span><span class="p">:</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;afscs_overall_weight&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;Cadets Min Value&#39;</span><span class="p">:</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;cadets_overall_value_min&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;AFSCs Min Value&#39;</span><span class="p">:</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;afscs_overall_value_min&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;Cadet Weight Function&#39;</span><span class="p">:</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;cadet_weight_function&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;AFSC Weight Function&#39;</span><span class="p">:</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;afsc_weight_function&#39;</span><span class="p">]}</span>

        <span class="c1"># Add the row for this set of value parameters to the overall df</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">overall_vp_columns</span><span class="p">:</span>
            <span class="n">vp_overall_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">v</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">overall_vp_columns</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>

        <span class="c1"># Determine extension of VP file (in case it&#39;s a different version of data)</span>
        <span class="k">if</span> <span class="n">instance</span><span class="o">.</span><span class="n">data_version</span> <span class="o">==</span> <span class="s2">&quot;Default&quot;</span><span class="p">:</span>
            <span class="n">extension</span> <span class="o">=</span> <span class="s2">&quot;.csv&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">extension</span> <span class="o">=</span> <span class="s2">&quot; (&quot;</span> <span class="o">+</span> <span class="n">instance</span><span class="o">.</span><span class="n">data_version</span> <span class="o">+</span> <span class="s2">&quot;).csv&quot;</span>

        <span class="c1"># Export &#39;VP&#39; dataframe</span>
        <span class="n">vp_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="s2">&quot;Model Input&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">instance</span><span class="o">.</span><span class="n">data_name</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">vp_name</span> <span class="o">+</span> <span class="n">extension</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Create &quot;Global Utility&quot; dataframe if it&#39;s in the value parameters</span>
        <span class="k">if</span> <span class="s2">&quot;global_utility&quot;</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">:</span>
            <span class="n">gu_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Cadet&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadets&#39;</span><span class="p">]})</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][:</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]]):</span>
                <span class="n">gu_df</span><span class="p">[</span><span class="n">afsc</span><span class="p">]</span> <span class="o">=</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;global_utility&#39;</span><span class="p">][:,</span> <span class="n">j</span><span class="p">]</span>

            <span class="c1"># Export &quot;Global Utility&quot; dataframe</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">data_name</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">vp_name</span> <span class="o">+</span> <span class="s2">&quot; Global Utility&quot;</span> <span class="o">+</span> <span class="n">extension</span>
            <span class="n">gu_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="s2">&quot;Model Input&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">filename</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Export &#39;Value Parameters&#39; dataframe</span>
    <span class="n">vp_overall_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="s2">&quot;Value Parameters&quot;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Export &#39;Cadets Utility Constraints&#39; dataframe</span>
    <span class="n">vp_cadet_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="s2">&quot;Cadets Utility Constraints&quot;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="data.processing.export_solutions_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">export_solutions_data</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Export solutions data to a CSV file for analysis.</p>
<p>This function exports the solutions generated by the optimization process to a CSV file. Each solution is
represented as a column in the CSV, providing detailed information about the assignment of cadets to AFSCs
for different scenarios or optimization runs.</p>
<p>Args:
    instance (object): An object containing problem instance and solution data.</p>
<p>Returns:
    None</p>
<p>Details:
- This function creates a solutions dataframe with each column representing a different solution. It includes
  data about the assignment of cadets to AFSCs for each scenario.</p>
<ul>
<li>
<p>The exported CSV file is saved with an informative name, which typically corresponds to the specific scenario
  or optimization run being documented.</p>
</li>
<li>
<p>The function assumes that the 'instance' object contains the required data and file paths for export.
```</p>
</li>
</ul>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">export_solutions_data</span><span class="p">(</span><span class="n">instance</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Export solutions data to a CSV file for analysis.</span>

<span class="sd">    This function exports the solutions generated by the optimization process to a CSV file. Each solution is</span>
<span class="sd">    represented as a column in the CSV, providing detailed information about the assignment of cadets to AFSCs</span>
<span class="sd">    for different scenarios or optimization runs.</span>

<span class="sd">    Args:</span>
<span class="sd">        instance (object): An object containing problem instance and solution data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    Details:</span>
<span class="sd">    - This function creates a solutions dataframe with each column representing a different solution. It includes</span>
<span class="sd">      data about the assignment of cadets to AFSCs for each scenario.</span>

<span class="sd">    - The exported CSV file is saved with an informative name, which typically corresponds to the specific scenario</span>
<span class="sd">      or optimization run being documented.</span>

<span class="sd">    - The function assumes that the &#39;instance&#39; object contains the required data and file paths for export.</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span>

    <span class="c1"># Error data</span>
    <span class="k">if</span> <span class="n">instance</span><span class="o">.</span><span class="n">solutions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># No solutions to export!</span>

    <span class="c1"># Initialize solutions dataframe</span>
    <span class="n">solutions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Cadet&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;cadets&quot;</span><span class="p">]})</span>

    <span class="c1"># Loop through each solution and add it to the dataframe</span>
    <span class="k">for</span> <span class="n">solution_name</span> <span class="ow">in</span> <span class="n">instance</span><span class="o">.</span><span class="n">solutions</span><span class="p">:</span>
        <span class="n">solutions_df</span><span class="p">[</span><span class="n">solution_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">solution_name</span><span class="p">][</span><span class="s1">&#39;afsc_array&#39;</span><span class="p">]</span>

    <span class="c1"># Export &#39;Solutions&#39; dataframe</span>
    <span class="n">solutions_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="s2">&quot;Solutions&quot;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Initialize solutions dataframe</span>
    <span class="n">extra_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Base Solutions&quot;</span><span class="p">:</span> <span class="s2">&quot;base_array&quot;</span><span class="p">,</span> <span class="s2">&quot;Course Solutions&quot;</span><span class="p">:</span> <span class="s2">&quot;course_array&quot;</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">df_name</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">extra_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

        <span class="c1"># Get list of solutions that have this extra component</span>
        <span class="n">solution_names_found</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">solution_name</span> <span class="ow">in</span> <span class="n">instance</span><span class="o">.</span><span class="n">solutions</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">instance</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">solution_name</span><span class="p">]:</span>
                <span class="n">solution_names_found</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">solution_name</span><span class="p">)</span>

        <span class="c1"># If we have at least one solution with this base or course component, we create this dataframe</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">solution_names_found</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">solutions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Cadet&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;cadets&quot;</span><span class="p">]})</span>

            <span class="c1"># Loop through each solution with this component and add it to the dataframe</span>
            <span class="k">for</span> <span class="n">solution_name</span> <span class="ow">in</span> <span class="n">solution_names_found</span><span class="p">:</span>
                <span class="n">solutions_df</span><span class="p">[</span><span class="n">solution_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">solution_name</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>

            <span class="c1"># Export extra &#39;Solutions&#39; dataframe</span>
            <span class="n">solutions_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="n">df_name</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="data.processing.export_additional_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">export_additional_data</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>This function takes an Instance object as an argument, which contains the additional data to be exported.
It creates a dictionary of columns to be included in the additional csv files by translating the parameters
to their corresponding column names in the file. The function then creates a dataframe using these columns
and exports it as a csv file to the path specified in the export_paths attribute of the Instance object.</p>
<p>Args:
    instance (Instance): An Instance object containing the additional data to export.</p>
<p>Returns:
    None</p>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">export_additional_data</span><span class="p">(</span><span class="n">instance</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function takes an Instance object as an argument, which contains the additional data to be exported.</span>
<span class="sd">    It creates a dictionary of columns to be included in the additional csv files by translating the parameters</span>
<span class="sd">    to their corresponding column names in the file. The function then creates a dataframe using these columns</span>
<span class="sd">    and exports it as a csv file to the path specified in the export_paths attribute of the Instance object.</span>

<span class="sd">    Args:</span>
<span class="sd">        instance (Instance): An Instance object containing the additional data to export.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span>

    <span class="c1"># See if we can export the &quot;Bases&quot; csv file</span>
    <span class="k">if</span> <span class="s2">&quot;bases&quot;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>

        <span class="c1"># Initialize dataframe</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Base&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;bases&#39;</span><span class="p">]})</span>

        <span class="c1"># Add &quot;minimum&quot; # to assign to each base by AFSC</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]:</span>
            <span class="n">afsc</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
            <span class="n">df</span><span class="p">[</span><span class="n">afsc</span> <span class="o">+</span> <span class="s1">&#39; Min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;base_min&#39;</span><span class="p">][:,</span> <span class="n">j</span><span class="p">]</span>

        <span class="c1"># Add &quot;maximum&quot; # to assign to each base by AFSC</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]:</span>
            <span class="n">afsc</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
            <span class="n">df</span><span class="p">[</span><span class="n">afsc</span> <span class="o">+</span> <span class="s1">&#39; Max&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;base_max&#39;</span><span class="p">][:,</span> <span class="n">j</span><span class="p">]</span>

        <span class="c1"># Export the dataset</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="s2">&quot;Bases&quot;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Export base preferences/utility if applicable</span>
    <span class="k">for</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;b_pref_matrix&#39;</span><span class="p">:</span> <span class="s1">&#39;Bases Preferences&#39;</span><span class="p">,</span> <span class="s1">&#39;base_utility&#39;</span><span class="p">:</span> <span class="s1">&#39;Bases Utility&#39;</span><span class="p">}</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>

            <span class="c1"># Initialize dataframe</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Cadet&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadets&#39;</span><span class="p">]})</span>

            <span class="c1"># Add base columns</span>
            <span class="k">for</span> <span class="n">b</span><span class="p">,</span> <span class="n">base</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;bases&#39;</span><span class="p">]):</span>
                <span class="n">df</span><span class="p">[</span><span class="n">base</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">parameter</span><span class="p">][:,</span> <span class="n">b</span><span class="p">]</span>

            <span class="c1"># Export the dataset</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="n">dataset</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Export training course data if applicable</span>
    <span class="k">if</span> <span class="s1">&#39;courses&#39;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>

        <span class="c1"># Dictionary to translate parameter names to column names</span>
        <span class="n">column_translation</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Course&quot;</span><span class="p">:</span> <span class="s1">&#39;courses&#39;</span><span class="p">,</span> <span class="s1">&#39;Start Date&#39;</span><span class="p">:</span> <span class="s1">&#39;course_start&#39;</span><span class="p">,</span> <span class="s1">&#39;Min&#39;</span><span class="p">:</span> <span class="s1">&#39;course_min&#39;</span><span class="p">,</span> <span class="s1">&#39;Max&#39;</span><span class="p">:</span> <span class="s1">&#39;course_max&#39;</span><span class="p">}</span>

        <span class="c1"># Initialize dictionary of new columns</span>
        <span class="n">new_cols</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;AFSC&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">])]}</span>

        <span class="c1"># Create each column for this dataset</span>
        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">column_translation</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_cols</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">param</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">])]</span>

        <span class="c1"># Create dataframe</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">new_cols</span><span class="p">)</span>

        <span class="c1"># Export the dataframe</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="s1">&#39;Courses&#39;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Export Castle AFSCs data</span>
    <span class="k">if</span> <span class="s1">&#39;castle_afscs_arr&#39;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>

        <span class="c1"># Create dataframe</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AFPC AFSC&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;afpc_afscs_arr&#39;</span><span class="p">],</span>
                           <span class="s1">&#39;CASTLE AFSC&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;castle_afscs_arr&#39;</span><span class="p">]})</span>

        <span class="c1"># Add in value curve data</span>
        <span class="k">if</span> <span class="s1">&#39;castle_q&#39;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;castle_q&#39;</span><span class="p">][</span><span class="s1">&#39;a&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">],</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span> <span class="k">for</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;castle_afscs_arr&#39;</span><span class="p">]]</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;f^hat&#39;</span><span class="p">]</span> <span class="o">=</span> \
                <span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;castle_q&#39;</span><span class="p">][</span><span class="s1">&#39;f^hat&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">],</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span> <span class="k">for</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;castle_afscs_arr&#39;</span><span class="p">]]</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Optimal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;optimal_policy&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">]</span> <span class="k">for</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;castle_afscs_arr&#39;</span><span class="p">]]</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;OTS Count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;ots_counts&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">]</span> <span class="k">for</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;castle_afscs_arr&#39;</span><span class="p">]]</span>

        <span class="c1"># Export the dataframe</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="s1">&#39;Castle Input&#39;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="data.processing.export_solution_results_excel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">export_solution_results_excel</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">filepath</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Export a solution and associated metrics to an Excel file for detailed analysis.</p>
<p>This function exports a comprehensive set of solution metrics, objective values, and constraints, along with detailed
solution information, to an Excel file. The exported file serves as a valuable resource for in-depth analysis of
optimization results.</p>
<p>Args:
    instance (object): An object containing problem instance and solution data.
    filepath (str): The path where the Excel file will be saved.</p>
<p>Returns:
    None</p>
<p>Details:
- The exported Excel file contains multiple sheets, each providing specific information about the optimization
  solution.</p>
<ul>
<li>
<p>"Main" Sheet:</p>
<ul>
<li>Displays overall metrics such as the value of the objective function (z).</li>
<li>Lists key metrics related to cadet preferences and choices, including choice counts and proportions.</li>
<li>Provides additional metrics relevant to the optimization problem, constraints, and objectives.</li>
</ul>
</li>
<li>
<p>"Objective Measures" Sheet:</p>
<ul>
<li>Presents objective measures for each AFSC (Air Force Specialty Code) in the optimization problem.</li>
<li>Helps in evaluating how well the solution aligns with each objective.</li>
</ul>
</li>
<li>
<p>"Constraint Fails" Sheet:</p>
<ul>
<li>Displays the number of constraint violations for each AFSC based on various optimization objectives.</li>
<li>Identifies where constraints are not met.</li>
</ul>
</li>
<li>
<p>"Objective Values" Sheet:</p>
<ul>
<li>Lists the values achieved for each AFSC for all objectives.</li>
<li>Highlights the performance of AFSCs with conditional formatting.</li>
</ul>
</li>
<li>
<p>"Solution" Sheet:</p>
<ul>
<li>Provides detailed information on each cadet's assignment, including matched AFSCs and preferences.</li>
<li>Shows merit, cadet choice, AFSC choice, cadet utility, and AFSC utility.</li>
<li>Includes information about rated cadet assignments and AFSC rankings.</li>
</ul>
</li>
<li>
<p>"X" Sheet (Optional):</p>
<ul>
<li>Displays the assignment matrix (X matrix) for cadets and AFSCs.</li>
<li>Shows the assignment status for each combination.</li>
</ul>
</li>
</ul>
<p>The function expects an 'instance' object to contain relevant data, including problem parameters, solution data,
and value parameters. The Excel file generated by this function serves as a valuable tool for studying and assessing
optimization results.</p>
<p>Note:
This function assumes that the 'instance' object conforms to the specific structure expected for your optimization
problem. Ensure that the 'instance' is correctly configured before using this function for export.
```</p>

            <details class="quote">
              <summary>Source code in <code>afccp/data/processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">export_solution_results_excel</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">filepath</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Export a solution and associated metrics to an Excel file for detailed analysis.</span>

<span class="sd">    This function exports a comprehensive set of solution metrics, objective values, and constraints, along with detailed</span>
<span class="sd">    solution information, to an Excel file. The exported file serves as a valuable resource for in-depth analysis of</span>
<span class="sd">    optimization results.</span>

<span class="sd">    Args:</span>
<span class="sd">        instance (object): An object containing problem instance and solution data.</span>
<span class="sd">        filepath (str): The path where the Excel file will be saved.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    Details:</span>
<span class="sd">    - The exported Excel file contains multiple sheets, each providing specific information about the optimization</span>
<span class="sd">      solution.</span>

<span class="sd">    - &quot;Main&quot; Sheet:</span>
<span class="sd">        - Displays overall metrics such as the value of the objective function (z).</span>
<span class="sd">        - Lists key metrics related to cadet preferences and choices, including choice counts and proportions.</span>
<span class="sd">        - Provides additional metrics relevant to the optimization problem, constraints, and objectives.</span>

<span class="sd">    - &quot;Objective Measures&quot; Sheet:</span>
<span class="sd">        - Presents objective measures for each AFSC (Air Force Specialty Code) in the optimization problem.</span>
<span class="sd">        - Helps in evaluating how well the solution aligns with each objective.</span>

<span class="sd">    - &quot;Constraint Fails&quot; Sheet:</span>
<span class="sd">        - Displays the number of constraint violations for each AFSC based on various optimization objectives.</span>
<span class="sd">        - Identifies where constraints are not met.</span>

<span class="sd">    - &quot;Objective Values&quot; Sheet:</span>
<span class="sd">        - Lists the values achieved for each AFSC for all objectives.</span>
<span class="sd">        - Highlights the performance of AFSCs with conditional formatting.</span>

<span class="sd">    - &quot;Solution&quot; Sheet:</span>
<span class="sd">        - Provides detailed information on each cadet&#39;s assignment, including matched AFSCs and preferences.</span>
<span class="sd">        - Shows merit, cadet choice, AFSC choice, cadet utility, and AFSC utility.</span>
<span class="sd">        - Includes information about rated cadet assignments and AFSC rankings.</span>

<span class="sd">    - &quot;X&quot; Sheet (Optional):</span>
<span class="sd">        - Displays the assignment matrix (X matrix) for cadets and AFSCs.</span>
<span class="sd">        - Shows the assignment status for each combination.</span>

<span class="sd">    The function expects an &#39;instance&#39; object to contain relevant data, including problem parameters, solution data,</span>
<span class="sd">    and value parameters. The Excel file generated by this function serves as a valuable tool for studying and assessing</span>
<span class="sd">    optimization results.</span>

<span class="sd">    Note:</span>
<span class="sd">    This function assumes that the &#39;instance&#39; object conforms to the specific structure expected for your optimization</span>
<span class="sd">    problem. Ensure that the &#39;instance&#39; is correctly configured before using this function for export.</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">solution</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span> <span class="n">instance</span><span class="o">.</span><span class="n">value_parameters</span><span class="p">,</span> <span class="n">instance</span><span class="o">.</span><span class="n">solution</span>
    <span class="n">mdl_p</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">mdl_p</span>

    <span class="c1"># Get list of excel columns in order (&quot;A&quot;, &quot;AB&quot;, etc.)</span>
    <span class="n">alphabet</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span><span class="p">)</span>
    <span class="n">excel_columns</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">alphabet</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">alphabet</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">letter_2</span> <span class="ow">in</span> <span class="n">alphabet</span><span class="p">:</span>
            <span class="n">excel_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">letter</span> <span class="o">+</span> <span class="n">letter_2</span><span class="p">)</span>

    <span class="c1"># Create a Pandas Excel writer using XlsxWriter as the engine.</span>
    <span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;xlsxwriter&#39;</span><span class="p">)</span>

    <span class="c1"># Get the xlsxwriter objects from the dataframe writer object.</span>
    <span class="n">workbook</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">book</span>
    <span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s2">&quot;Main&quot;</span><span class="p">)</span>

    <span class="c1"># Make the background white initially</span>
    <span class="n">white_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;font_color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;font_size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;font_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Calibri&#39;</span><span class="p">})</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
            <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">white_format</span><span class="p">)</span>

    <span class="c1"># Merge cells</span>
    <span class="n">merge_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;font_color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;font_size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;font_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span> <span class="s1">&#39;border_color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="s2">&quot;B2:D2&quot;</span><span class="p">,</span> <span class="s2">&quot;VFT Overall Metrics&quot;</span><span class="p">,</span> <span class="n">merge_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="s2">&quot;F2:G2&quot;</span><span class="p">,</span> <span class="s2">&quot;Additional Metrics&quot;</span><span class="p">,</span> <span class="n">merge_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;I2&#39;</span><span class="p">,</span> <span class="s1">&#39;Preference&#39;</span><span class="p">,</span> <span class="n">merge_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;J2&#39;</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">merge_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;Proportion&#39;</span><span class="p">,</span> <span class="n">merge_format</span><span class="p">)</span>

    <span class="c1"># Objective Value</span>
    <span class="n">obj_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;font_color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span>
                                      <span class="s1">&#39;font_size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;font_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                      <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span> <span class="s1">&#39;border_color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="s2">&quot;C6:D6&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span> <span class="n">obj_format</span><span class="p">)</span>

    <span class="c1"># Other cells</span>
    <span class="n">cell_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;font_color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;font_size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;font_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span> <span class="s1">&#39;border_color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;VFT&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="s1">&#39;Cadets&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="s1">&#39;AFSCs&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B6&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;D3&#39;</span><span class="p">,</span> <span class="s1">&#39;Weight&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>

    <span class="c1"># Basic format</span>
    <span class="n">cell_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;font_color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;font_size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;font_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="s1">&#39;border_color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

    <span class="c1"># Choice Counts</span>
    <span class="n">choice_dict</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;First&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;Second&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;Third&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="s2">&quot;Fourth&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="s2">&quot;Fifth&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="s2">&quot;Sixth&quot;</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="s2">&quot;Seventh&quot;</span><span class="p">,</span>
                   <span class="mi">8</span><span class="p">:</span> <span class="s2">&quot;Eighth&quot;</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="s2">&quot;Ninth&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="s2">&quot;Tenth&quot;</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span> <span class="n">choice_dict</span><span class="p">:</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;J&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">choice</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;cadet_choice_counts&#39;</span><span class="p">][</span><span class="n">choice</span><span class="p">]),</span> <span class="n">cell_format</span><span class="p">)</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;I&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">choice</span><span class="p">),</span> <span class="n">choice_dict</span><span class="p">[</span><span class="n">choice</span><span class="p">],</span> <span class="n">cell_format</span><span class="p">)</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;K&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">choice</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;cadet_choice_counts&#39;</span><span class="p">][</span><span class="n">choice</span><span class="p">]</span> <span class="o">/</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;N^Match&#39;</span><span class="p">],</span> <span class="mi">3</span><span class="p">),</span>
                        <span class="n">cell_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;I&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">choice</span><span class="p">),</span> <span class="s2">&quot;All Others&quot;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;J&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">choice</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;cadet_choice_counts&#39;</span><span class="p">][</span><span class="s1">&#39;All Others&#39;</span><span class="p">]),</span> <span class="n">cell_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;K&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">choice</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;cadet_choice_counts&#39;</span><span class="p">][</span><span class="s2">&quot;All Others&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;N^Match&#39;</span><span class="p">],</span> <span class="mi">3</span><span class="p">),</span>
                    <span class="n">cell_format</span><span class="p">)</span>

    <span class="c1"># Additional solution metrics</span>
    <span class="n">name_metric_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Blocking Pairs&#39;</span><span class="p">:</span> <span class="s1">&#39;num_blocking_pairs&#39;</span><span class="p">,</span> <span class="s1">&#39;Ineligible Cadets&#39;</span><span class="p">:</span> <span class="s1">&#39;num_ineligible&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Unmatched Cadets&#39;</span><span class="p">:</span> <span class="s1">&#39;num_unmatched&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Top 3 Choices (Proportion) for USSF&#39;</span><span class="p">:</span> <span class="s1">&#39;top_3_ussf_count&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Top 3 Choices (Proportion) for USAF&#39;</span><span class="p">:</span> <span class="s1">&#39;top_3_usaf_count&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Top 3 Choices (Proportion) for USAFA&#39;</span><span class="p">:</span> <span class="s1">&#39;top_3_usafa_count&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Top 3 Choices (Proportion) for ROTC&#39;</span><span class="p">:</span> <span class="s1">&#39;top_3_rotc_count&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Top 3 Choices (Proportion) for OTS&#39;</span><span class="p">:</span> <span class="s1">&#39;top_3_ots_count&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Average Cadet Choice&#39;</span><span class="p">:</span> <span class="s1">&#39;average_cadet_choice&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Average Normalized AFSC Score&#39;</span><span class="p">:</span> <span class="s1">&#39;weighted_average_afsc_score&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Average NRL Normalized AFSC Score&#39;</span><span class="p">:</span> <span class="s1">&#39;weighted_average_nrl_afsc_score&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Failed Constraints&#39;</span><span class="p">:</span> <span class="s1">&#39;total_failed_constraints&#39;</span><span class="p">,</span> <span class="s1">&#39;USSF OM&#39;</span><span class="p">:</span> <span class="s1">&#39;ussf_om&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Global Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;z^gu&#39;</span><span class="p">,</span> <span class="s1">&#39;Cadet Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;cadet_utility_overall&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;z^CASTLE&#39;</span><span class="p">:</span> <span class="s1">&#39;z^CASTLE&#39;</span><span class="p">,</span> <span class="s1">&#39;z^CASTLE (Values)&#39;</span><span class="p">:</span> <span class="s1">&#39;z^CASTLE (Values)&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;AFSC Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;afsc_utility_overall&#39;</span><span class="p">,</span> <span class="s1">&#39;USAFA Cadet Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;usafa_cadet_utility&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;ROTC Cadet Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;rotc_cadet_utility&#39;</span><span class="p">,</span> <span class="s1">&#39;OTS Cadet Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;ots_cadet_utility&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;USSF Cadet Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;ussf_cadet_utility&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;USAF Cadet Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;usaf_cadet_utility&#39;</span><span class="p">,</span> <span class="s1">&#39;USSF AFSC Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;ussf_afsc_utility&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;USAF AFSC Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;usaf_afsc_utility&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Average Normalized AFSC Score (USSF)&#39;</span><span class="p">:</span> <span class="s1">&#39;weighted_average_ussf_afsc_score&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Average Normalized AFSC Score (USAF)&#39;</span><span class="p">:</span> <span class="s1">&#39;weighted_average_usaf_afsc_score&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;USAFA USSF Cadets / USAFA USSF PGL&#39;</span><span class="p">:</span> <span class="s1">&#39;ussf_usafa_pgl_target&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;ROTC USSF Cadets / ROTC USSF PGL&#39;</span><span class="p">:</span> <span class="s1">&#39;ussf_rotc_pgl_target&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Cadets Successfully Constrained to Accessions Group / Total Fixed Accession Group Slots&#39;</span><span class="p">:</span>
                            <span class="s1">&#39;constrained_acc_grp_target&#39;</span><span class="p">,</span>
                        <span class="s2">&quot;Cadets Successfully Constrained to AFSC / Total Fixed AFSC Slots&quot;</span><span class="p">:</span>
                            <span class="s1">&#39;cadets_fixed_correctly&#39;</span><span class="p">,</span>
                        <span class="s2">&quot;Cadets Successfully Reserved to AFSC / Total Reserved AFSC Slots&quot;</span><span class="p">:</span>
                            <span class="s1">&#39;cadets_reserved_correctly&#39;</span><span class="p">,</span>
                        <span class="s2">&quot;Successful Alternate List Scenarios / Total Possible Alternate List Scenarios&quot;</span><span class="p">:</span>
                            <span class="s1">&#39;alternate_list_metric&#39;</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">acc_grp</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs_acc_grp&#39;</span><span class="p">]:</span>
        <span class="n">name_metric_dict</span><span class="p">[</span><span class="n">acc_grp</span> <span class="o">+</span> <span class="s2">&quot; Racial Simpson Index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;simpson_index_&#39;</span> <span class="o">+</span> <span class="n">acc_grp</span>

    <span class="c1"># Add these metrics into excel</span>
    <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">name_metric_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
        <span class="k">if</span> <span class="n">name_metric_dict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">:</span>

            <span class="c1"># Sometimes we can&#39;t write in a value for a solution metric that is incomplete</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;F&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">r</span><span class="p">),</span> <span class="n">name</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;G&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">r</span><span class="p">),</span> <span class="n">solution</span><span class="p">[</span><span class="n">name_metric_dict</span><span class="p">[</span><span class="n">name</span><span class="p">]],</span> <span class="n">cell_format</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>

    <span class="c1"># VFT Metrics</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;cadets_overall_value&#39;</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span> <span class="n">cell_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C5&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;afscs_overall_value&#39;</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span> <span class="n">cell_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;D4&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;cadets_overall_weight&#39;</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span> <span class="n">cell_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;D5&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;afscs_overall_weight&#39;</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span> <span class="n">cell_format</span><span class="p">)</span>

    <span class="c1"># Draw bigger borders</span>
    <span class="n">draw_frame_border_outside</span><span class="p">(</span><span class="n">workbook</span><span class="p">,</span> <span class="n">worksheet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">draw_frame_border_outside</span><span class="p">(</span><span class="n">workbook</span><span class="p">,</span> <span class="n">worksheet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">name_metric_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">draw_frame_border_outside</span><span class="p">(</span><span class="n">workbook</span><span class="p">,</span> <span class="n">worksheet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Adjust Column Widths</span>
    <span class="n">column_widths</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mf">1.50</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mf">1.50</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mf">1.50</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">12</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">column_widths</span><span class="p">:</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">column_widths</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">export_results_dfs</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This nested function is here to export all other dataframes</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Get the xlsxwriter worksheet object.</span>
        <span class="n">workbook</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">book</span>

        <span class="c1"># AFSC Objective measures dataframe</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AFSC&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][:</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]]})</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">objective</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objectives&#39;</span><span class="p">]):</span>
            <span class="n">df</span><span class="p">[</span><span class="n">objective</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;objective_measure&#39;</span><span class="p">][:,</span> <span class="n">k</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Convert the dataframe to an XlsxWriter Excel object.</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Objective Measures&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Add Castle Data if it exists</span>
        <span class="k">if</span> <span class="s1">&#39;castle_q&#39;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
            <span class="n">castle_afscs</span> <span class="o">=</span> <span class="p">[</span><span class="n">afsc</span> <span class="k">for</span> <span class="n">afsc</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^CASTLE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
            <span class="n">castle_counts</span> <span class="o">=</span> <span class="p">[</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;castle_counts&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">]</span> <span class="k">for</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="n">castle_afscs</span><span class="p">]</span>
            <span class="n">castle_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;castle_v&#39;</span><span class="p">][</span><span class="n">afsc</span><span class="p">]</span> <span class="k">for</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="n">castle_afscs</span><span class="p">]</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AFSC&#39;</span><span class="p">:</span> <span class="n">castle_afscs</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">:</span> <span class="n">castle_counts</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="n">castle_values</span><span class="p">})</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Castle Metrics&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># AFSC Constraint Fail dataframe</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AFSC&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][:</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]]})</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">objective</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objectives&#39;</span><span class="p">]):</span>
            <span class="n">df</span><span class="p">[</span><span class="n">objective</span><span class="p">]</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;objective_constraint_fail&#39;</span><span class="p">][:,</span> <span class="n">k</span><span class="p">]</span>

        <span class="c1"># Convert the dataframe to an XlsxWriter Excel object.</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Constraint Fails&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># AFSC Objective values dataframe</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AFSC&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][:</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]]})</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">objective</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objectives&#39;</span><span class="p">]):</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]))</span>
            <span class="n">values</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="n">np</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;J^A&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;objective_value&#39;</span><span class="p">][</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;J^A&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">k</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>

            <span class="n">df</span><span class="p">[</span><span class="n">objective</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>

        <span class="c1"># Convert the dataframe to an XlsxWriter Excel object.</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Objective Values&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Get the xlsxwriter worksheet object.</span>
        <span class="n">worksheet</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="s2">&quot;Objective Values&quot;</span><span class="p">]</span>

        <span class="c1"># Add a percent number format</span>
        <span class="n">percent_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s2">&quot;num_format&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0%&quot;</span><span class="p">})</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">percent_format</span><span class="p">)</span>

        <span class="c1"># Conditional formatting to highlight which objectives were met/not met</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s2">&quot;B2:&quot;</span> <span class="o">+</span> <span class="n">excel_columns</span><span class="p">[</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;3_color_scale&quot;</span><span class="p">})</span>

        <span class="c1"># Solution Dataframe</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Cadet&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadets&#39;</span><span class="p">]})</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;USAFA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;usafa&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Merit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;merit&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Matched AFSC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;afsc_array&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;base_array&quot;</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Matched Base&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;base_array&#39;</span><span class="p">]</span>
            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Matched Course&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;course_array&#39;</span><span class="p">]</span>
            <span class="n">col_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Base Choice&#39;</span><span class="p">:</span> <span class="s1">&#39;base_choice&#39;</span><span class="p">,</span> <span class="s1">&#39;Cadet State&#39;</span><span class="p">:</span> <span class="s1">&#39;cadet_state_achieved&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;State Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;state_utility_used&#39;</span><span class="p">,</span> <span class="s1">&#39;Cadet Value&#39;</span><span class="p">:</span> <span class="s1">&#39;cadet_value_achieved&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;AFSC Weight&#39;</span><span class="p">:</span> <span class="s1">&#39;afsc_weight_used&#39;</span><span class="p">,</span> <span class="s1">&#39;Base Weight&#39;</span><span class="p">:</span> <span class="s1">&#39;base_weight_used&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Course Weight&#39;</span><span class="p">:</span> <span class="s1">&#39;course_weight_used&#39;</span><span class="p">,</span> <span class="s1">&#39;Base Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;base_utility_achieved&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Course Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;course_utility_achieved&#39;</span><span class="p">}</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">col_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="n">val</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Cadet Choice&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;cadet_choice&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;AFSC Choice&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;afsc_choice&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Cadet Utility&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;cadet_utility_achieved&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;AFSC Utility&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;afsc_utility_achieved&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Global Utility&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;global_utility_achieved&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Matched Deg Tier&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>  <span class="c1"># &quot;U&quot; for unmatched cadets</span>
            <span class="n">p</span><span class="p">[</span><span class="s1">&#39;qual&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;j_array&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span> <span class="k">if</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;j_array&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;U&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]]</span>

        <span class="c1"># Rated Reserves/Matches/Alternates</span>
        <span class="k">for</span> <span class="n">s_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Rated Matches&#39;</span><span class="p">,</span> <span class="s1">&#39;Rated Reserves&#39;</span><span class="p">,</span> <span class="s1">&#39;Rated Alternates (Hard)&#39;</span><span class="p">,</span> <span class="s1">&#39;Rated Alternates (Soft)&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">s_name</span> <span class="ow">in</span> <span class="n">instance</span><span class="o">.</span><span class="n">solutions</span><span class="p">:</span>
                <span class="n">df</span><span class="p">[</span><span class="n">s_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">s_name</span><span class="p">][</span><span class="s1">&#39;afsc_array&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">df</span><span class="p">[</span><span class="n">s_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;*&quot;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]]</span>

        <span class="c1"># Rated Rankings</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^Rated&#39;</span><span class="p">]:</span>
            <span class="n">df</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; Rank&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;a_pref_matrix&#39;</span><span class="p">][:,</span> <span class="n">j</span><span class="p">]</span>

        <span class="c1"># Add the cadet&#39;s top 10 choices for more information!</span>
        <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">],</span> <span class="mi">10</span><span class="p">)):</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Choice &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">choice</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;c_preferences&#39;</span><span class="p">][:,</span> <span class="n">choice</span><span class="p">]</span>

        <span class="c1"># Capture preference columns</span>
        <span class="n">preference_columns</span> <span class="o">=</span> <span class="n">excel_columns</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">],</span> <span class="mi">10</span><span class="p">):</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)]</span>

        <span class="c1"># Add the cadet&#39;s top 10 utilities for more information!</span>
        <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">],</span> <span class="mi">10</span><span class="p">)):</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Utility &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">choice</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]:</span>

                <span class="c1"># Might run out of utilities</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadet_preferences&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">choice</span><span class="p">:</span>
                    <span class="n">j</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadet_preferences&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">choice</span><span class="p">]</span>
                    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Utility &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">choice</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadet_utility&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>

        <span class="c1"># Convert the dataframe to an XlsxWriter Excel object.</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Solution&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">startrow</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Get the xlsxwriter worksheet object.</span>
        <span class="n">worksheet</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="s2">&quot;Solution&quot;</span><span class="p">]</span>

        <span class="c1"># Add additional formatting to top row</span>
        <span class="n">header_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">})</span>
        <span class="k">for</span> <span class="n">col_num</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
            <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">col_num</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">header_format</span><span class="p">)</span>

        <span class="c1"># Get numpy array of df columns</span>
        <span class="n">df_columns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

        <span class="c1"># Conditional Formatting on preferences</span>
        <span class="n">cadet_choice_col</span> <span class="o">=</span> <span class="n">excel_columns</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df_columns</span> <span class="o">==</span> <span class="s1">&#39;Cadet Choice&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">preference_columns</span><span class="p">):</span>
            <span class="n">format1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;choice_colors&#39;</span><span class="p">][</span><span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]})</span>
            <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="s2">&quot;2:&quot;</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                                         <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;D2&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format1</span>
                                          <span class="p">})</span>
            <span class="c1"># Cadet Choice Column</span>
            <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cadet_choice_col</span> <span class="o">+</span> <span class="s2">&quot;2:&quot;</span> <span class="o">+</span> <span class="n">cadet_choice_col</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                                         <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                                          <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format1</span>
                                          <span class="p">})</span>

        <span class="c1"># Freeze top row</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">freeze_panes</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Add filter to headers</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">autofilter</span><span class="p">(</span><span class="s1">&#39;A1:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">excel_columns</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

        <span class="c1"># Replace unassigned base values</span>
        <span class="k">if</span> <span class="s1">&#39;Base Choice&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span>
            <span class="n">cell_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({})</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;Base Choice&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">letters</span> <span class="o">=</span> <span class="p">[</span><span class="n">excel_columns</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df_columns</span> <span class="o">==</span> <span class="n">col</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span>
                               <span class="p">[</span><span class="s1">&#39;Base Weight&#39;</span><span class="p">,</span> <span class="s1">&#39;Base Choice&#39;</span><span class="p">,</span> <span class="s1">&#39;Base Utility&#39;</span><span class="p">]]</span>
                    <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">letters</span><span class="p">:</span>
                        <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">letter</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>

        <span class="c1"># Small values good (1, 2, 3, 4, ...) Conditional Formatting</span>
        <span class="n">sv_excel_cols</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;AFSC Choice&#39;</span><span class="p">,</span> <span class="s1">&#39;Base Choice&#39;</span><span class="p">,</span> <span class="s1">&#39;Cadet State&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span>
                <span class="n">sv_excel_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">excel_columns</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df_columns</span> <span class="o">==</span> <span class="n">col</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">sv_excel_cols</span><span class="p">:</span>
            <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span>
                <span class="n">c</span> <span class="o">+</span> <span class="s2">&quot;2:&quot;</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;3_color_scale&#39;</span><span class="p">,</span> <span class="s1">&#39;min_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#63be7b&#39;</span><span class="p">,</span>
                                                 <span class="s1">&#39;mid_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#ffeb84&#39;</span><span class="p">,</span> <span class="s1">&#39;max_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#f8696b&#39;</span><span class="p">})</span>

        <span class="c1"># Large values good (1, ...,  0) Conditional Formatting</span>
        <span class="n">lv_excel_cols</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Merit&#39;</span><span class="p">,</span> <span class="s1">&#39;Cadet Utility&#39;</span><span class="p">,</span> <span class="s1">&#39;AFSC Utility&#39;</span><span class="p">,</span> <span class="s1">&#39;Global Utility&#39;</span><span class="p">,</span> <span class="s1">&#39;Base Utility&#39;</span><span class="p">,</span> <span class="s1">&#39;Course Utility&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;State Utility&#39;</span><span class="p">,</span> <span class="s1">&#39;Cadet Value&#39;</span><span class="p">,</span> <span class="s1">&#39;Cadet Value (Pyomo)&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span>
                <span class="n">lv_excel_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">excel_columns</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df_columns</span> <span class="o">==</span> <span class="n">col</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">lv_excel_cols</span><span class="p">:</span>
            <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="s2">&quot;2:&quot;</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;3_color_scale&quot;</span><span class="p">})</span>

        <span class="c1"># &quot;All Others&quot; for the choice column</span>
        <span class="n">format1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;all_other_choice_colors&#39;</span><span class="p">]})</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="n">cadet_choice_col</span> <span class="o">+</span> <span class="s2">&quot;2:&quot;</span> <span class="o">+</span> <span class="n">cadet_choice_col</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                                     <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format1</span><span class="p">})</span>

        <span class="c1"># Add a percent number format to certain columns</span>
        <span class="n">percent_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Merit&#39;</span><span class="p">,</span> <span class="s1">&#39;State Utility&#39;</span><span class="p">,</span> <span class="s1">&#39;Cadet Value&#39;</span><span class="p">,</span> <span class="s1">&#39;AFSC Weight&#39;</span><span class="p">,</span> <span class="s1">&#39;Base Weight&#39;</span><span class="p">,</span> <span class="s1">&#39;Course Weight&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Base Utility&#39;</span><span class="p">,</span> <span class="s1">&#39;Course Utility&#39;</span><span class="p">,</span> <span class="s1">&#39;Cadet Utility&#39;</span><span class="p">,</span> <span class="s1">&#39;AFSC Utility&#39;</span><span class="p">,</span> <span class="s1">&#39;Global Utility&#39;</span><span class="p">]</span>
        <span class="n">percent_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s2">&quot;num_format&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0%&quot;</span><span class="p">})</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">percent_cols</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_columns</span><span class="p">:</span>
                <span class="n">c_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df_columns</span> <span class="o">==</span> <span class="n">col</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="n">c_num</span><span class="p">,</span> <span class="n">c_num</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">percent_format</span><span class="p">)</span>

        <span class="c1"># Solution/X Matrix</span>
        <span class="k">if</span> <span class="s1">&#39;x&#39;</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Cadet&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadets&#39;</span><span class="p">]})</span>
            <span class="n">df</span><span class="p">[</span><span class="n">instance</span><span class="o">.</span><span class="n">solution_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;afsc_array&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][:</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]]):</span>
                <span class="n">df</span><span class="p">[</span><span class="n">afsc</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">][:,</span> <span class="n">j</span><span class="p">]</span>

            <span class="c1"># Convert the dataframe to an XlsxWriter Excel object.</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Base Matrix</span>
        <span class="k">if</span> <span class="s1">&#39;v&#39;</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Cadet&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadets&#39;</span><span class="p">]})</span>
            <span class="n">df</span><span class="p">[</span><span class="n">instance</span><span class="o">.</span><span class="n">solution_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;base_array&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">b</span><span class="p">,</span> <span class="n">base</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;bases&#39;</span><span class="p">][:</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">]]):</span>
                <span class="n">df</span><span class="p">[</span><span class="n">base</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">][:,</span> <span class="n">b</span><span class="p">]</span>

            <span class="c1"># Convert the dataframe to an XlsxWriter Excel object.</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Training Matrix</span>
        <span class="k">if</span> <span class="s1">&#39;q&#39;</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">:</span>

            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Cadet&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadets&#39;</span><span class="p">]})</span>
            <span class="n">df</span><span class="p">[</span><span class="n">instance</span><span class="o">.</span><span class="n">solution_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;course_array&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][:</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]]):</span>
                <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">course</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;courses&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]):</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">afsc</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">course</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;q&#39;</span><span class="p">][:,</span> <span class="n">j</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span>

            <span class="c1"># Convert the dataframe to an XlsxWriter Excel object.</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Value Function Matrices</span>
        <span class="k">if</span> <span class="s1">&#39;lambda&#39;</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">:</span>

            <span class="n">afsc_arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">afsc</span> <span class="k">for</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][:</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;K&#39;</span><span class="p">]]</span>
            <span class="n">objective_arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">objective</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">objective</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objectives&#39;</span><span class="p">]]</span>

            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AFSC&#39;</span><span class="p">:</span> <span class="n">afsc_arr</span><span class="p">,</span> <span class="s1">&#39;Objective&#39;</span><span class="p">:</span> <span class="n">objective_arr</span><span class="p">})</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;r^max&#39;</span><span class="p">]):</span>
                <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;lambda&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;K&#39;</span><span class="p">]]</span>
                <span class="n">df</span><span class="p">[</span><span class="s1">&#39;l_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span>  <span class="n">arr</span>

            <span class="c1"># Convert the dataframe to an XlsxWriter Excel object.</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Lambda&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;AFSC&#39;</span><span class="p">:</span> <span class="n">afsc_arr</span><span class="p">,</span> <span class="s1">&#39;Objective&#39;</span><span class="p">:</span> <span class="n">objective_arr</span><span class="p">})</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;r^max&#39;</span><span class="p">]):</span>
                <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;K&#39;</span><span class="p">]]</span>
                <span class="n">df</span><span class="p">[</span><span class="s1">&#39;y_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">arr</span>

            <span class="c1"># Convert the dataframe to an XlsxWriter Excel object.</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Blocking Pairs</span>
        <span class="k">if</span> <span class="s1">&#39;blocking_pairs&#39;</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">:</span>

            <span class="c1"># Create &quot;blocking pairs&quot; dataframe and export it to excel</span>
            <span class="n">blocking_cadets</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="nb">tuple</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;blocking_pairs&#39;</span><span class="p">]]</span>
            <span class="n">blocking_afscs</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][</span><span class="nb">tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="nb">tuple</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;blocking_pairs&#39;</span><span class="p">]]</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Blocking Cadet&#39;</span><span class="p">:</span> <span class="n">blocking_cadets</span><span class="p">,</span> <span class="s1">&#39;Blocking AFSC&#39;</span><span class="p">:</span> <span class="n">blocking_afscs</span><span class="p">})</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Blocking Pairs&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Close the workbook</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">export_results_dfs</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://gitlab.com/path-to-your-repo" target="_blank" rel="noopener" title="gitlab.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>