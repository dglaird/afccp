
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://dglaird.github.io/afccp/reference/solutions/sensitivity/">
      
      
        <link rel="prev" href="../optimization/">
      
      
        <link rel="next" href="../../visualizations/">
      
      
      <link rel="icon" href="../../../images/logos/afccp_logo_favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Sensitivity - Air Force Cadet Career Problem</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#solutions.sensitivity" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Air Force Cadet Career Problem" class="md-header__button md-logo" aria-label="Air Force Cadet Career Problem" data-md-component="logo">
      
  <img src="../../../images/logos/afccp_logo_and_text_light.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Air Force Cadet Career Problem
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Sensitivity
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/dglaird/afccp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  üè† Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../getting-started/getting-started/" class="md-tabs__link">
          
  
  
  üöÄ Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../user-guide/overview/" class="md-tabs__link">
          
  
  
  üìò User Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../developer-guide/" class="md-tabs__link">
        
  
  
    
  
  üß† Developer Guide

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../main/cadetcareerproblem_overview/" class="md-tabs__link">
          
  
  
  CadetCareerProblem

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../data/" class="md-tabs__link">
          
  
  
  üìä Data

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  üìà Solutions

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../visualizations/" class="md-tabs__link">
          
  
  
  Visualizations

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../faq/" class="md-tabs__link">
        
  
  
    
  
  ‚ùì FAQs

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../help/" class="md-tabs__link">
        
  
  
    
  
  üÜò Help & Support

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Air Force Cadet Career Problem" class="md-nav__button md-logo" aria-label="Air Force Cadet Career Problem" data-md-component="logo">
      
  <img src="../../../images/logos/afccp_logo_and_text_light.png" alt="logo">

    </a>
    Air Force Cadet Career Problem
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/dglaird/afccp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üè† Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üöÄ Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            üöÄ Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting-started/getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üìÑ Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üõ†Ô∏è Install Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            üõ†Ô∏è Install Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting-started/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation Instructions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting-started/developer-checklist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Developer Checklist
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üìò User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            üìò User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/tutorial_1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 1 (Introduction)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/tutorial_2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 2 (Data Overview)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/tutorial_3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 3 (Parameters)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/tutorial_4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 4 (Value Parameters)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üß† Developer Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    CadetCareerProblem
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            CadetCareerProblem
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_generated_data_corrections/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generated Data Corrections
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_main_data_corrections/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Main Data Corrections
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_other_adjustments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Other Adjustments
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_value_parameter_specifications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Value Parameter Specifications
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_solution_generation_%26_algorithms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solution Generation & Algorithms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_optimization_models_%26_meta-heuristics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Optimization Models & Meta-Heuristics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_solution_handling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solution Handling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_export_data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Export Data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_data_visualizations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Visualizations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_results_visualizations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Results Visualizations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üìä Data
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            üìä Data
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/adjustments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Adjustments
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/preferences/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Preferences
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/processing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Processing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/values/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Values
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/support/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Support
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/generation/basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generation- 'Basic'
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/generation/realistic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generation- 'Realistic'
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    üìà Solutions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            üìà Solutions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algorithms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Algorithms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../handling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Handling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optimization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Sensitivity
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Sensitivity
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#solutions.sensitivity.determine_model_constraints" class="md-nav__link">
    <span class="md-ellipsis">
      determine_model_constraints
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solutions.sensitivity.populate_initial_ga_solutions_from_vft_model" class="md-nav__link">
    <span class="md-ellipsis">
      populate_initial_ga_solutions_from_vft_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solutions.sensitivity.populate_initial_ga_solutions_from_assignment_model" class="md-nav__link">
    <span class="md-ellipsis">
      populate_initial_ga_solutions_from_assignment_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solutions.sensitivity.optimization_what_if_analysis" class="md-nav__link">
    <span class="md-ellipsis">
      optimization_what_if_analysis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solutions.sensitivity.solve_pgl_capacity_sensitivity" class="md-nav__link">
    <span class="md-ellipsis">
      solve_pgl_capacity_sensitivity
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Visualizations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Visualizations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../visualizations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../visualizations/bubbles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bubbles
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../visualizations/charts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Charts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../visualizations/slides/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Slides
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ‚ùì FAQs
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../help/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üÜò Help & Support
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<div class="doc doc-object doc-module">



<h1 id="solutions.sensitivity" class="doc doc-heading">
            <code>solutions.sensitivity</code>


<a href="#solutions.sensitivity" class="headerlink" title="Permanent link">&para;</a></h1>

    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="solutions.sensitivity.determine_model_constraints" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">determine_model_constraints</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span></code>

<a href="#solutions.sensitivity.determine_model_constraints" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Iteratively evaluate the VFT (Value Focussed Thinking) model by adding constraints until a feasible solution is obtained,
in order of importance.</p>
<p>This function takes a problem instance containing parameters and value parameters as input. It starts with no constraints
activated and gradually adds constraints in order of their importance. The function builds and solves the VFT model at each
constraint iteration, evaluating the feasibility and objective value of the solution. The process continues until all
constraints have been considered.</p>
<p>Args:
    instance (ProblemInstance): An instance of the problem containing the problem parameters and value parameters.</p>
<p>Returns:
    A tuple containing:
        - constraint_type (ndarray): The adjusted constraint type matrix, indicating the active constraints.
        - solutions_df (DataFrame): A DataFrame with the solutions for different constraint iterations.
        - report_df (DataFrame): A DataFrame containing the report of each constraint iteration, including information
                                 about the solution, the new constraint applied, the objective value, and if the solution
                                 failed or not.</p>

            <details class="quote">
              <summary>Source code in <code>afccp/solutions/sensitivity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">determine_model_constraints</span><span class="p">(</span><span class="n">instance</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Iteratively evaluate the VFT (Value Focussed Thinking) model by adding constraints until a feasible solution is obtained,</span>
<span class="sd">    in order of importance.</span>

<span class="sd">    This function takes a problem instance containing parameters and value parameters as input. It starts with no constraints</span>
<span class="sd">    activated and gradually adds constraints in order of their importance. The function builds and solves the VFT model at each</span>
<span class="sd">    constraint iteration, evaluating the feasibility and objective value of the solution. The process continues until all</span>
<span class="sd">    constraints have been considered.</span>

<span class="sd">    Args:</span>
<span class="sd">        instance (ProblemInstance): An instance of the problem containing the problem parameters and value parameters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tuple containing:</span>
<span class="sd">            - constraint_type (ndarray): The adjusted constraint type matrix, indicating the active constraints.</span>
<span class="sd">            - solutions_df (DataFrame): A DataFrame with the solutions for different constraint iterations.</span>
<span class="sd">            - report_df (DataFrame): A DataFrame containing the report of each constraint iteration, including information</span>
<span class="sd">                                     about the solution, the new constraint applied, the objective value, and if the solution</span>
<span class="sd">                                     failed or not.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">ip</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">value_parameters</span><span class="p">),</span> <span class="n">instance</span><span class="o">.</span><span class="n">mdl_p</span>

    <span class="c1"># Create a copy of the problem instance</span>
    <span class="n">adj_instance</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>  <span class="c1"># &quot;Adjusted Instance&quot;</span>
    <span class="n">real_constraint_type</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s2">&quot;constraint_type&quot;</span><span class="p">])</span>  <span class="c1"># All constraints (Not 0s)</span>

    <span class="c1"># Initially, we&#39;ll start with no constraints turned on</span>
    <span class="n">vp</span><span class="p">[</span><span class="s2">&quot;constraint_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">],</span> <span class="n">vp</span><span class="p">[</span><span class="s2">&quot;O&quot;</span><span class="p">]])</span>
    <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;K^C&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">j</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]}</span>
    <span class="n">adj_instance</span><span class="o">.</span><span class="n">value_parameters</span> <span class="o">=</span> <span class="n">vp</span>  <span class="c1"># Set to instance</span>

    <span class="c1"># Initialize Report</span>
    <span class="n">report_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Solution&quot;</span><span class="p">,</span> <span class="s2">&quot;New Constraint&quot;</span><span class="p">,</span> <span class="s2">&quot;Objective Value&quot;</span><span class="p">,</span> <span class="s2">&quot;Failed&quot;</span><span class="p">]</span>
    <span class="n">report</span> <span class="o">=</span> <span class="p">{</span><span class="n">col</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">report_columns</span><span class="p">}</span>

    <span class="c1"># Determine which model we&#39;re going to solve (either VFT or Assignment model)</span>
    <span class="k">if</span> <span class="n">ip</span><span class="p">[</span><span class="s1">&#39;constraint_model_to_use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;VFT&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Initializing VFT Model Constraint Algorithm...&quot;</span><span class="p">)</span>

        <span class="c1"># Build the model</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">optimization</span><span class="o">.</span><span class="n">vft_model_build</span><span class="p">(</span><span class="n">adj_instance</span><span class="p">)</span>
        <span class="n">model_name</span><span class="p">,</span> <span class="n">obj_metric</span> <span class="o">=</span> <span class="s1">&#39;VFT&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span>

    <span class="k">else</span><span class="p">:</span>  <span class="c1"># Assignment model</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Initializing Assignment Model Constraint Algorithm...&quot;</span><span class="p">)</span>

        <span class="c1"># Build the model</span>
        <span class="n">adj_instance</span><span class="o">.</span><span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;assignment_model_obj&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Global Utility&#39;</span>  <span class="c1"># Force the correct objective function</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">optimization</span><span class="o">.</span><span class="n">assignment_model_build</span><span class="p">(</span><span class="n">adj_instance</span><span class="p">),</span> <span class="kc">None</span>
        <span class="n">model_name</span><span class="p">,</span> <span class="n">obj_metric</span> <span class="o">=</span> <span class="s1">&#39;Assignment&#39;</span><span class="p">,</span> <span class="s1">&#39;z^gu&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done. Solving model with no constraints active...&quot;</span><span class="p">)</span>

    <span class="c1"># Dictionary of solutions with different constraints!</span>
    <span class="n">current_solution</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">optimization</span><span class="o">.</span><span class="n">solve_pyomo_model</span><span class="p">(</span>
        <span class="n">adj_instance</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">printing</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">solutions</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="n">current_solution</span><span class="p">}</span>
    <span class="n">current_solution</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">handling</span><span class="o">.</span><span class="n">evaluate_solution</span><span class="p">(</span><span class="n">current_solution</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">)</span>
    <span class="n">afsc_solutions</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="n">current_solution</span><span class="p">[</span><span class="s1">&#39;afsc_array&#39;</span><span class="p">]}</span>

    <span class="c1"># Add first solution to the report</span>
    <span class="n">report</span><span class="p">[</span><span class="s2">&quot;Solution&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">report</span><span class="p">[</span><span class="s2">&quot;Objective Value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">current_solution</span><span class="p">[</span><span class="n">obj_metric</span><span class="p">],</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">report</span><span class="p">[</span><span class="s2">&quot;New Constraint&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;None&quot;</span><span class="p">)</span>
    <span class="n">report</span><span class="p">[</span><span class="s2">&quot;Failed&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done. New solution objective value:&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">report</span><span class="p">[</span><span class="s2">&quot;Objective Value&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>

    <span class="c1"># Get importance &quot;list&quot; based on multiplied weight</span>
    <span class="n">afsc_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s2">&quot;afsc_weight&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># Turns 1d array into 2d column</span>
    <span class="n">scaled_weights</span> <span class="o">=</span> <span class="n">afsc_weight</span> <span class="o">*</span> <span class="n">vp</span><span class="p">[</span><span class="s2">&quot;objective_weight&quot;</span><span class="p">]</span>
    <span class="n">flat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">scaled_weights</span><span class="p">)</span>  <span class="c1"># flatten them</span>
    <span class="n">tuples</span> <span class="o">=</span> <span class="p">[(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">])]</span>  <span class="c1"># get a list of tuples (0, 0), (0, 1) etc.</span>
    <span class="n">tuples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tuples</span><span class="p">)</span>
    <span class="n">sort_flat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">flat</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">importance_list</span> <span class="o">=</span> <span class="p">[(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tuples</span><span class="p">[</span><span class="n">sort_flat</span><span class="p">]</span> <span class="k">if</span> <span class="n">real_constraint_type</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">num_constraints</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">importance_list</span><span class="p">)</span>

    <span class="c1"># Begin the algorithm!</span>
    <span class="n">cons</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Running through &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">num_constraints</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; total constraint iterations...&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="ow">in</span> <span class="n">importance_list</span><span class="p">:</span>
        <span class="n">afsc</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;afscs&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
        <span class="n">objective</span> <span class="o">=</span> <span class="n">vp</span><span class="p">[</span><span class="s2">&quot;objectives&quot;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>

        <span class="c1"># Make a copy of the model (In case we have to remove a constraint)</span>
        <span class="n">new_model</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

        <span class="c1"># Calculate AFSC objective measure components</span>
        <span class="n">measure</span><span class="p">,</span> <span class="n">numerator</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">handling</span><span class="o">.</span><span class="n">calculate_objective_measure_matrix</span><span class="p">(</span>
            <span class="n">new_model</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">objective</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">approximate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Add AFSC objective measure constraint</span>
        <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;constraint_type&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">real_constraint_type</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">])</span>
        <span class="n">new_model</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">optimization</span><span class="o">.</span><span class="n">add_objective_measure_constraint</span><span class="p">(</span>
            <span class="n">new_model</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">measure</span><span class="p">,</span> <span class="n">numerator</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">)</span>
        <span class="n">num_measure_constraints</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_model</span><span class="o">.</span><span class="n">measure_constraints</span><span class="p">)</span>

        <span class="c1"># Update constraint type within the problem instance</span>
        <span class="n">adj_instance</span><span class="o">.</span><span class="n">value_parameters</span><span class="p">[</span><span class="s1">&#39;constraint_type&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">real_constraint_type</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">])</span>

        <span class="c1"># Print message</span>
        <span class="n">cons</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">print_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">------[&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">cons</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;] AFSC &quot;</span> <span class="o">+</span> <span class="n">afsc</span> <span class="o">+</span> <span class="s2">&quot; Objective &quot;</span> <span class="o">+</span> <span class="n">objective</span>
        <span class="n">print_str</span> <span class="o">+=</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="p">(</span><span class="mi">55</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">print_str</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">print_str</span><span class="p">)</span>

        <span class="c1"># Loop through each of the constraints to validate how many are on</span>
        <span class="n">num_activated</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">new_model</span><span class="o">.</span><span class="n">measure_constraints</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">new_model</span><span class="o">.</span><span class="n">measure_constraints</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">active</span><span class="p">:</span>
                <span class="n">num_activated</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Constraint&quot;</span><span class="p">,</span> <span class="n">cons</span><span class="p">,</span> <span class="s2">&quot;Active Constraints:&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_measure_constraints</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
                               <span class="s2">&quot;Validated:&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_activated</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>

        <span class="c1"># Variable to determine the outcome of this iteration</span>
        <span class="n">feasible</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Assume model is feasible until proven otherwise</span>

        <span class="c1"># We can skip the quota constraint (leave it on without solving)</span>
        <span class="k">if</span> <span class="n">objective</span> <span class="o">==</span> <span class="s2">&quot;Combined Quota&quot;</span> <span class="ow">and</span> <span class="n">ip</span><span class="p">[</span><span class="s2">&quot;skip_quota_constraint&quot;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Result: SKIPPED [Combined Quota]&quot;</span><span class="p">)</span>
            <span class="n">solutions</span><span class="p">[</span><span class="n">cons</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">current_solution</span><span class="p">)</span>
            <span class="n">skipped_obj</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># If our most current solution is already meeting this constraint, then we can skip this constraint</span>
        <span class="k">elif</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objective_min&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">current_solution</span><span class="p">[</span><span class="s2">&quot;objective_measure&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objective_max&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Result: SKIPPED [Measure:&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">current_solution</span><span class="p">[</span><span class="s2">&quot;objective_measure&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;], &quot;</span><span class="p">,</span>
                  <span class="s2">&quot;Range: (&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objective_min&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">])</span> <span class="o">+</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objective_max&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">)</span>
            <span class="n">solutions</span><span class="p">[</span><span class="n">cons</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">current_solution</span><span class="p">)</span>
            <span class="n">skipped_obj</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># We can&#39;t skip the constraint, so we solve it</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">skipped_obj</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="c1"># Solution Solved!</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">solutions</span><span class="p">[</span><span class="n">cons</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">afccp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">optimization</span><span class="o">.</span><span class="n">solve_pyomo_model</span><span class="p">(</span>
                    <span class="n">adj_instance</span><span class="p">,</span> <span class="n">new_model</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">printing</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

            <span class="c1"># Solution Failed :(</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">solutions</span><span class="p">[</span><span class="n">cons</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">current_solution</span><span class="p">)</span>
                <span class="n">feasible</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Get solution information</span>
        <span class="n">current_solution</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">solutions</span><span class="p">[</span><span class="n">cons</span><span class="p">])</span>
        <span class="n">current_solution</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">afccp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">handling</span><span class="o">.</span><span class="n">evaluate_solution</span><span class="p">(</span><span class="n">current_solution</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">))</span>
        <span class="n">afsc_solutions</span><span class="p">[</span><span class="n">cons</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">current_solution</span><span class="p">[</span><span class="s1">&#39;afsc_array&#39;</span><span class="p">])</span>

        <span class="c1"># Add this solution to report</span>
        <span class="n">report</span><span class="p">[</span><span class="s2">&quot;Solution&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cons</span><span class="p">)</span>
        <span class="n">report</span><span class="p">[</span><span class="s2">&quot;New Constraint&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">afsc</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">objective</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">feasible</span><span class="p">:</span>
            <span class="n">report</span><span class="p">[</span><span class="s2">&quot;Objective Value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">current_solution</span><span class="p">[</span><span class="n">obj_metric</span><span class="p">],</span> <span class="mi">4</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">skipped_obj</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Result: SOLVED [Z = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">report</span><span class="p">[</span><span class="s2">&quot;Objective Value&quot;</span><span class="p">][</span><span class="n">cons</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span><span class="p">)</span>
            <span class="n">report</span><span class="p">[</span><span class="s2">&quot;Failed&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">new_model</span><span class="p">)</span>  <span class="c1"># Save this model!</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Result: INFEASIBLE. Proceeding with next constraint.&quot;</span><span class="p">)</span>
            <span class="n">report</span><span class="p">[</span><span class="s2">&quot;Objective Value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">report</span><span class="p">[</span><span class="s2">&quot;Failed&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

            <span class="c1"># Update constraint type within the problem instance (Remove this constraint)</span>
            <span class="n">vp</span><span class="p">[</span><span class="s2">&quot;constraint_type&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Measure it again</span>
        <span class="n">current_solution</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">afccp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">handling</span><span class="o">.</span><span class="n">evaluate_solution</span><span class="p">(</span><span class="n">current_solution</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">))</span>

        <span class="c1"># Validate solution meets the constraints:</span>
        <span class="n">num_constraint_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s2">&quot;constraint_type&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Active Objective Measure Constraints:&quot;</span><span class="p">,</span> <span class="n">num_constraint_check</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total Failed Constraints:&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">current_solution</span><span class="p">[</span><span class="s2">&quot;total_failed_constraints&quot;</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Current Objective Measure:&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">current_solution</span><span class="p">[</span><span class="s2">&quot;objective_measure&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;Range:&quot;</span><span class="p">,</span>
              <span class="n">vp</span><span class="p">[</span><span class="s2">&quot;objective_value_min&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">con_fail_str</span> <span class="ow">in</span> <span class="n">current_solution</span><span class="p">[</span><span class="s2">&quot;failed_constraints&quot;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failed:&quot;</span><span class="p">,</span> <span class="n">con_fail_str</span><span class="p">)</span>

        <span class="c1"># Check all other AFSC objectives to see if we&#39;re suddenly failing them now for some reason</span>
        <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">measure_fails</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">cons</span><span class="p">:</span>
            <span class="n">j_1</span><span class="p">,</span> <span class="n">k_1</span> <span class="o">=</span> <span class="n">importance_list</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
            <span class="n">afsc_1</span><span class="p">,</span> <span class="n">objective_1</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;afscs&quot;</span><span class="p">][</span><span class="n">j_1</span><span class="p">],</span> <span class="n">vp</span><span class="p">[</span><span class="s2">&quot;objectives&quot;</span><span class="p">][</span><span class="n">k_1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">current_solution</span><span class="p">[</span><span class="s2">&quot;objective_measure&quot;</span><span class="p">][</span><span class="n">j_1</span><span class="p">,</span> <span class="n">k_1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objective_max&#39;</span><span class="p">][</span><span class="n">j_1</span><span class="p">,</span> <span class="n">k_1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.05</span><span class="p">)</span> <span class="ow">or</span> \
                    <span class="n">current_solution</span><span class="p">[</span><span class="s2">&quot;objective_measure&quot;</span><span class="p">][</span><span class="n">j_1</span><span class="p">,</span> <span class="n">k_1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objective_min&#39;</span><span class="p">][</span><span class="n">j_1</span><span class="p">,</span> <span class="n">k_1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.95</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Measure Fail:&quot;</span><span class="p">,</span> <span class="n">afsc_1</span><span class="p">,</span> <span class="n">objective_1</span><span class="p">,</span> <span class="s2">&quot;Measure:&quot;</span><span class="p">,</span>
                      <span class="nb">round</span><span class="p">(</span><span class="n">current_solution</span><span class="p">[</span><span class="s2">&quot;objective_measure&quot;</span><span class="p">][</span><span class="n">j_1</span><span class="p">,</span> <span class="n">k_1</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;Range:&quot;</span><span class="p">,</span>
                      <span class="n">vp</span><span class="p">[</span><span class="s2">&quot;objective_value_min&quot;</span><span class="p">][</span><span class="n">j_1</span><span class="p">,</span> <span class="n">k_1</span><span class="p">])</span>
                <span class="n">measure_fails</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">c</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">print_str</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="s2">&quot; Objective Measure Fails:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">measure_fails</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">print_str</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="p">(</span><span class="mi">55</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">print_str</span><span class="p">)))</span>

    <span class="c1"># Build Report</span>
    <span class="n">solutions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">afsc_solutions</span><span class="p">)</span>
    <span class="n">report_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">report</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">vp</span><span class="p">[</span><span class="s2">&quot;constraint_type&quot;</span><span class="p">],</span> <span class="n">solutions_df</span><span class="p">,</span> <span class="n">report_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="solutions.sensitivity.populate_initial_ga_solutions_from_vft_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">populate_initial_ga_solutions_from_vft_model</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">printing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#solutions.sensitivity.populate_initial_ga_solutions_from_vft_model" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>This function takes a problem instance and creates several initial solutions for the genetic algorithm to evolve
from</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>instance</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>problem instance</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>printing</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>whether to print something or not</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>initial population</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>afccp/solutions/sensitivity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">populate_initial_ga_solutions_from_vft_model</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">printing</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function takes a problem instance and creates several initial solutions for the genetic algorithm to evolve</span>
<span class="sd">    from</span>
<span class="sd">    :param instance: problem instance</span>
<span class="sd">    :param printing: whether to print something or not</span>
<span class="sd">    :return: initial population</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Generating initial population of solutions for the genetic algorithm from the approximate VFT model...&quot;</span><span class="p">)</span>

    <span class="c1"># Load parameters/variables</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">vp</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">value_parameters</span><span class="p">)</span>
    <span class="n">previous_estimate</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;quota_e&quot;</span><span class="p">]</span>
    <span class="n">initial_solutions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># We get our first round of solutions by iterating on the estimated number of cadets</span>
    <span class="k">if</span> <span class="n">instance</span><span class="o">.</span><span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;iterate_from_quota&quot;</span><span class="p">]:</span>

        <span class="c1"># Initialize variables</span>
        <span class="n">deviations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">])</span>
        <span class="n">quota_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s2">&quot;objectives&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Combined Quota&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="nb">sum</span><span class="p">(</span><span class="n">deviations</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Solving VFT model... (&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">)</span>

            <span class="c1"># Set the current estimated number of cadets</span>
            <span class="n">current_estimate</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;quota_e&quot;</span><span class="p">]</span>

            <span class="k">try</span><span class="p">:</span>

                <span class="c1"># Build &amp; solve the VFT model</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">vft_model_build</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>
                <span class="n">solution</span> <span class="o">=</span> <span class="n">solve_pyomo_model</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="s2">&quot;VFT&quot;</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">printing</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">solution</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">handling</span><span class="o">.</span><span class="n">evaluate_solution</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">)</span>
                <span class="n">initial_solutions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;j_array&#39;</span><span class="p">])</span>

                <span class="c1"># Save this estimate for quota</span>
                <span class="n">previous_estimate</span> <span class="o">=</span> <span class="n">current_estimate</span>

                <span class="c1"># Update new quota information (based on the number of cadets assigned from this solution)</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;quota_e&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="s2">&quot;objective_measure&quot;</span><span class="p">][:,</span> <span class="n">quota_k</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

                <span class="c1"># Validate the estimated number is within the appropriate range</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;J&quot;</span><span class="p">]:</span>

                    <span class="c1"># Reset the parameter if necessary</span>
                    <span class="k">if</span> <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;quota_e&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;quota_min&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">]:</span>
                        <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;quota_e&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;quota_min&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;quota_e&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;quota_max&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">]:</span>
                        <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;quota_e&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;quota_max&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>

                <span class="c1"># Calculate deviations and proceed with next iteration</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span>
                <span class="n">deviations</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;quota_e&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">current_estimate</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;J&quot;</span><span class="p">]]</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Current Number of Quota Differences:&quot;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">deviations</span><span class="p">),</span> <span class="s2">&quot;with objective value of&quot;</span><span class="p">,</span>
                          <span class="nb">round</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">],</span> <span class="mi">4</span><span class="p">))</span>

                <span class="c1"># Don&#39;t solve this thing too many times (other stopping conditions)</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">instance</span><span class="o">.</span><span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;max_quota_iterations&quot;</span><span class="p">]:</span>
                    <span class="k">break</span>

            <span class="k">except</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Something went wrong with this iteration, proceeding with overall weight technique...&quot;</span><span class="p">)</span>

                <span class="c1"># Revert to the previous quota estimate</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;quota_e&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">previous_estimate</span>
                <span class="k">break</span>

    <span class="c1"># Solve for different overall weights on cadets/AFSCs</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;population_additions&quot;</span><span class="p">])</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">weights</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">weights</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Solving VFT model with &#39;w&#39; of &quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;...&quot;</span><span class="p">)</span>

        <span class="c1"># Update overall weights</span>
        <span class="n">instance</span><span class="o">.</span><span class="n">value_parameters</span><span class="p">[</span><span class="s2">&quot;cadets_overall_weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">w</span>
        <span class="n">instance</span><span class="o">.</span><span class="n">value_parameters</span><span class="p">[</span><span class="s2">&quot;afscs_overall_weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">w</span>

        <span class="c1"># Solve model</span>
        <span class="k">try</span><span class="p">:</span>

            <span class="c1"># Build &amp; solve the model</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">vft_model_build</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>
            <span class="n">solution</span> <span class="o">=</span> <span class="n">solve_pyomo_model</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="s2">&quot;VFT&quot;</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">printing</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">solution</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">handling</span><span class="o">.</span><span class="n">evaluate_solution</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">)</span>
            <span class="n">initial_solutions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;j_array&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Objective value of&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span> <span class="s2">&quot;obtained&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failed to solve. Going to next iteration...&quot;</span><span class="p">)</span>

    <span class="n">instance</span><span class="o">.</span><span class="n">value_parameters</span> <span class="o">=</span> <span class="n">vp</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">initial_solutions</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="solutions.sensitivity.populate_initial_ga_solutions_from_assignment_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">populate_initial_ga_solutions_from_assignment_model</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">printing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#solutions.sensitivity.populate_initial_ga_solutions_from_assignment_model" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>This function generates several initial solutions for the genetic algorithm to evolve from using the
<em>new and improved</em> Assignment Problem Model as a heuristic</p>

            <details class="quote">
              <summary>Source code in <code>afccp/solutions/sensitivity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">populate_initial_ga_solutions_from_assignment_model</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">printing</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function generates several initial solutions for the genetic algorithm to evolve from using the</span>
<span class="sd">    *new and improved* Assignment Problem Model as a heuristic</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Generating initial population of solutions for the genetic algorithm from the approximate VFT model...&quot;</span><span class="p">)</span>

    <span class="c1"># Force the correct objective function</span>
    <span class="n">instance</span><span class="o">.</span><span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;assignment_model_obj&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Global Utility&#39;</span>

    <span class="c1"># Load parameters/variables</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">vp</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">value_parameters</span><span class="p">)</span>
    <span class="n">initial_solutions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Solve using different &quot;global utility&quot; matrices calculated from different overall weights on cadets/AFSCs</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;population_additions&quot;</span><span class="p">])</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">weights</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">weights</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Solving assignment model with &#39;w&#39; of &quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;...&quot;</span><span class="p">)</span>

        <span class="c1"># Update global utility matrix</span>
        <span class="n">instance</span><span class="o">.</span><span class="n">value_parameters</span><span class="p">[</span><span class="s1">&#39;global_utility&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]:</span>
            <span class="n">instance</span><span class="o">.</span><span class="n">value_parameters</span><span class="p">[</span><span class="s1">&#39;global_utility&#39;</span><span class="p">][:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadet_utility&#39;</span><span class="p">][:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> \
                                                                <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;afsc_utility&#39;</span><span class="p">][:,</span> <span class="n">j</span><span class="p">]</span>

        <span class="c1"># Solve model</span>
        <span class="k">try</span><span class="p">:</span>

            <span class="c1"># Build &amp; solve the model</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">assignment_model_build</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>
            <span class="n">solution</span> <span class="o">=</span> <span class="n">solve_pyomo_model</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="s2">&quot;Assignment&quot;</span><span class="p">,</span> <span class="n">printing</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">solution</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">handling</span><span class="o">.</span><span class="n">evaluate_solution</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">)</span>
            <span class="n">initial_solutions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;j_array&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Objective value of&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span> <span class="s2">&quot;obtained&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failed to solve. Going to next iteration...&quot;</span><span class="p">)</span>

    <span class="n">instance</span><span class="o">.</span><span class="n">value_parameters</span> <span class="o">=</span> <span class="n">vp</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">initial_solutions</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="solutions.sensitivity.optimization_what_if_analysis" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">optimization_what_if_analysis</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">printing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#solutions.sensitivity.optimization_what_if_analysis" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>This function takes in an AFSC/cadet problem instance and performs some "What If" analysis based on the items listed
in "What If List.csv". We manipulate the "value parameters" to meet these pre-defined conditions and then evaluate
the model with the new constraints. We can then create a pareto frontier by modifying the weights on cadets/AFSCs.
These results are all exported to a sub-folder called "What If" in the Analysis &amp; Results folder.</p>

            <details class="quote">
              <summary>Source code in <code>afccp/solutions/sensitivity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">optimization_what_if_analysis</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">printing</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function takes in an AFSC/cadet problem instance and performs some &quot;What If&quot; analysis based on the items listed</span>
<span class="sd">    in &quot;What If List.csv&quot;. We manipulate the &quot;value parameters&quot; to meet these pre-defined conditions and then evaluate</span>
<span class="sd">    the model with the new constraints. We can then create a pareto frontier by modifying the weights on cadets/AFSCs.</span>
<span class="sd">    These results are all exported to a sub-folder called &quot;What If&quot; in the Analysis &amp; Results folder.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">mdl_p</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span> <span class="n">instance</span><span class="o">.</span><span class="n">value_parameters</span><span class="p">,</span> <span class="n">instance</span><span class="o">.</span><span class="n">mdl_p</span>

    <span class="c1"># Import dataframe</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">globals</span><span class="o">.</span><span class="n">import_csv_data</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="s1">&#39;Analysis &amp; Results&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;What If List.csv&quot;</span><span class="p">)</span>

    <span class="c1"># Make sure the first name is in the solutions dictionary</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">instance</span><span class="o">.</span><span class="n">solutions</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error. Constraint name &#39;&quot;</span> <span class="o">+</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;&#39; is the baseline solution and is currently&quot;</span>
                                                                          <span class="s2">&quot; not in the solutions dictionary.&quot;</span><span class="p">)</span>

    <span class="c1"># Get baseline solution and evaluate it</span>
    <span class="n">baseline</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">]]</span>
    <span class="n">baseline</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">handling</span><span class="o">.</span><span class="n">evaluate_solution</span><span class="p">(</span><span class="n">baseline</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">)</span>

    <span class="c1"># Dictionary of metric column names and their associated variable name in the solution dictionary</span>
    <span class="n">metrics_dictionary</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Effect on Global Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;z^gu&#39;</span><span class="p">,</span> <span class="s1">&#39;Effect on Cadet Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;cadet_utility_overall&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Effect on AFSC Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;afsc_utility_overall&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Effect on USAFA Cadet Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;usafa_cadet_utility&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Effect on ROTC Cadet Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;rotc_cadet_utility&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Effect on USSF Cadet Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;ussf_cadet_utility&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Effect on USAF Cadet Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;usaf_cadet_utility&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Effect on USSF AFSC Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;ussf_afsc_utility&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Effect on USAF AFSC Utility&#39;</span><span class="p">:</span> <span class="s1">&#39;usaf_afsc_utility&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Effect on USSF AFSC Norm Score&#39;</span><span class="p">:</span> <span class="s1">&#39;weighted_average_ussf_afsc_score&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Effect on USAF AFSC Norm Score&#39;</span><span class="p">:</span> <span class="s1">&#39;weighted_average_usaf_afsc_score&#39;</span><span class="p">}</span>

    <span class="c1"># Dictionary of AFSC solutions</span>
    <span class="n">afsc_solutions</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Loop through each constraint type</span>
    <span class="n">names</span><span class="p">,</span> <span class="n">con</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]),</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>  <span class="c1"># Skip the baseline</span>
        <span class="n">con</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># Next constraint iteration (skips baseline too)</span>
        <span class="n">c_vp</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">vp</span><span class="p">)</span>  <span class="c1"># set of value parameters for this constraint iteration</span>

        <span class="c1"># Print statement</span>
        <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Iteration&#39;</span><span class="p">,</span> <span class="n">con</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

        <span class="c1"># If we don&#39;t want to re-calculate something we can skip it</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">con</span><span class="p">,</span> <span class="s1">&#39;Calculate&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Skipped&quot;</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="c1"># Set the appropriate value parameters for this iteration</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;Unconstrained&#39;</span><span class="p">:</span>  <span class="c1"># Turn off all the AFSC objective constraints</span>
            <span class="n">c_vp</span><span class="p">[</span><span class="s1">&#39;constraint_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">],</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">]])</span>

            <span class="c1"># Turn off cadet constraints</span>
            <span class="n">c_vp</span><span class="p">[</span><span class="s1">&#39;cadet_value_min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">])</span>

        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;PGL Only&#39;</span><span class="p">:</span>  <span class="c1"># Turn of all the AFSC objective constraints except PGL</span>
            <span class="n">c_vp</span><span class="p">[</span><span class="s1">&#39;constraint_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">],</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">]])</span>

            <span class="c1"># Turn on PGL constraints</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objectives&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Combined Quota&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">c_vp</span><span class="p">[</span><span class="s1">&#39;constraint_type&#39;</span><span class="p">][:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">2</span>

            <span class="c1"># Turn off cadet constraints</span>
            <span class="n">c_vp</span><span class="p">[</span><span class="s1">&#39;cadet_value_min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">])</span>

        <span class="k">elif</span> <span class="s1">&#39;Top 10 First Choice&#39;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>  <span class="c1"># Cadets from the top 10% of the class need to get first choice</span>

            <span class="k">if</span> <span class="s2">&quot;Replace&quot;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>  <span class="c1"># Do we add these constraints on top of current cadet value constraints?</span>

                <span class="c1"># Turn off current cadet constraints</span>
                <span class="n">c_vp</span><span class="p">[</span><span class="s1">&#39;cadet_value_min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">])</span>

            <span class="c1"># Constrained slots</span>
            <span class="n">constrained_slots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">])</span>

            <span class="c1"># Need an algorithm to see which constraints are possible based on GOM</span>
            <span class="n">sorted_cadets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;merit&#39;</span><span class="p">])[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sorted_cadets</span><span class="p">:</span>

                <span class="c1"># Once we&#39;re passed the top 10% we&#39;re done</span>
                <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;merit&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.9</span><span class="p">:</span>
                    <span class="k">break</span>

                <span class="c1"># Loop through choices until we find one under capacity</span>
                <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
                    <span class="n">j</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadet_preferences&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">choice</span><span class="p">]</span>

                    <span class="c1"># Only constrain this preference if we&#39;re under constrained capacity</span>
                    <span class="k">if</span> <span class="n">constrained_slots</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;pgl&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]:</span>

                        <span class="c1"># Constrain the utility of this preference</span>
                        <span class="n">utility</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadet_utility&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
                        <span class="n">c_vp</span><span class="p">[</span><span class="s1">&#39;cadet_value_min&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">utility</span>

                        <span class="c1"># Increment constrained slots by one</span>
                        <span class="n">constrained_slots</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

                        <span class="c1"># Break out of this choice</span>
                        <span class="k">break</span>

        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;USSF OM&quot;</span><span class="p">:</span>  <span class="c1"># Turn on USSF OM constraint</span>
            <span class="n">c_vp</span><span class="p">[</span><span class="s2">&quot;USSF OM&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Strict AFOCD M Tier&quot;</span><span class="p">:</span>  <span class="c1"># Turn on mandatory AFOCD constraints</span>

            <span class="c1"># Loop through each degree tier to find AFSCs that have mandatory degree tier requirements</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
                <span class="n">j_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;t_mandatory&quot;</span><span class="p">][:,</span> <span class="n">t</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;constraint_type&#39;</span><span class="p">][</span><span class="n">j_indices</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Turn on these constraints</span>

        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Skip the rest of this loop</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Skipped&quot;</span><span class="p">)</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">con</span><span class="p">,</span> <span class="s2">&quot;Result&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Skipped&quot;</span>
            <span class="k">continue</span>

        <span class="c1"># Set of constrained objectives for each AFSC</span>
        <span class="n">c_vp</span><span class="p">[</span><span class="s1">&#39;K^C&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># constrained objectives</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;J&quot;</span><span class="p">]:</span>
            <span class="n">c_vp</span><span class="p">[</span><span class="s1">&#39;K^C&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">c_vp</span><span class="p">[</span><span class="s1">&#39;constraint_type&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="c1"># Create a duplicate instance and set its value parameters</span>
        <span class="n">c_instance</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>
        <span class="n">c_instance</span><span class="o">.</span><span class="n">value_parameters</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">c_vp</span><span class="p">)</span>

        <span class="c1"># Solve the model</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">optimization</span><span class="o">.</span><span class="n">assignment_model_build</span><span class="p">(</span><span class="n">c_instance</span><span class="p">)</span>

        <span class="c1"># Check for feasibility</span>
        <span class="k">try</span><span class="p">:</span>

            <span class="c1"># Solve model and get solution</span>
            <span class="n">solution</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">optimization</span><span class="o">.</span><span class="n">solve_pyomo_model</span><span class="p">(</span><span class="n">c_instance</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;Assignment&#39;</span><span class="p">,</span>
                                                                      <span class="n">printing</span><span class="o">=</span><span class="n">printing</span><span class="p">)</span>
            <span class="n">solution</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">handling</span><span class="o">.</span><span class="n">evaluate_solution</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">c_vp</span><span class="p">)</span>
            <span class="n">afsc_solutions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;afsc_array&#39;</span><span class="p">])</span>

            <span class="c1"># Calculate metrics</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">metrics_dictionary</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">con</span><span class="p">,</span> <span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="o">-</span> <span class="n">baseline</span><span class="p">[</span><span class="n">value</span><span class="p">]</span>

            <span class="c1"># It was feasible!</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">con</span><span class="p">,</span> <span class="s2">&quot;Result&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Feasible&quot;</span>

            <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Feasible :)&quot;</span><span class="p">)</span>

        <span class="k">except</span><span class="p">:</span>

            <span class="c1"># Empty solution</span>
            <span class="n">afsc_solutions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;*&quot;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]])</span>

            <span class="c1"># It was infeasible!</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">con</span><span class="p">,</span> <span class="s2">&quot;Result&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Infeasible&quot;</span>

            <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Infeasible :(&quot;</span><span class="p">)</span>

    <span class="c1"># Export main dataframe</span>
    <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="s1">&#39;Analysis &amp; Results&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;What If List.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Create and export solutions dataframe</span>
    <span class="n">solution_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">afsc_solutions</span><span class="p">)</span>
    <span class="n">solution_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="s1">&#39;Analysis &amp; Results&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;What If Solutions.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="solutions.sensitivity.solve_pgl_capacity_sensitivity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">solve_pgl_capacity_sensitivity</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">p_dict</span><span class="o">=</span><span class="p">{},</span> <span class="n">printing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#solutions.sensitivity.solve_pgl_capacity_sensitivity" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Doc string here</p>

            <details class="quote">
              <summary>Source code in <code>afccp/solutions/sensitivity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">solve_pgl_capacity_sensitivity</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">p_dict</span><span class="o">=</span><span class="p">{},</span> <span class="n">printing</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Doc string here</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">alter_quota_max</span><span class="p">(</span><span class="n">done_iterating</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Determine which AFSCs were most over quota</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span>
        <span class="n">surplus</span> <span class="o">=</span> <span class="n">count</span> <span class="o">-</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;pgl&#39;</span><span class="p">]</span>
        <span class="n">percentage</span> <span class="o">=</span> <span class="n">count</span> <span class="o">/</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;pgl&#39;</span><span class="p">]</span>

        <span class="c1"># Determine which AFSC to alter</span>
        <span class="n">sorted_afscs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">percentage</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">sorted_afscs</span><span class="p">:</span>

            <span class="c1"># If we&#39;re already at our &quot;true max&quot;, pick the next AFSC in the list</span>
            <span class="k">if</span> <span class="n">count</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">true_max</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
                <span class="k">continue</span>

            <span class="c1"># Calculate what the new max should be</span>
            <span class="n">new_max_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;pgl&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">surplus</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

            <span class="c1"># If the difference is small enough, skip straight to true max</span>
            <span class="n">difference</span> <span class="o">=</span> <span class="n">count</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">new_max_val</span>
            <span class="k">if</span> <span class="n">difference</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">:</span>
                <span class="n">new_max_val</span> <span class="o">=</span> <span class="n">true_max</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>

            <span class="c1"># If this would put the maximum under the &quot;true maximum&quot;, force it to be the true maximum</span>
            <span class="k">if</span> <span class="n">new_max_val</span> <span class="o">&lt;</span> <span class="n">true_max</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
                <span class="n">new_max_val</span> <span class="o">=</span> <span class="n">true_max</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>

            <span class="c1"># Set the new maximum value for this AFSC</span>
            <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;quota_max&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">new_max_val</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations complete.&quot;</span><span class="p">)</span>
                <span class="n">done_iterating</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">p</span><span class="p">[</span><span class="s1">&#39;quota_max&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_max_val</span>

            <span class="c1"># Break out of the loop</span>
            <span class="k">break</span>

        <span class="k">return</span> <span class="n">done_iterating</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">mdl_p</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span> <span class="n">instance</span><span class="o">.</span><span class="n">value_parameters</span><span class="p">,</span> <span class="n">instance</span><span class="o">.</span><span class="n">mdl_p</span>

    <span class="c1"># Make the main directory if needed</span>
    <span class="n">folder_path</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">export_paths</span><span class="p">[</span><span class="s1">&#39;Analysis &amp; Results&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s2">&quot;PGL Sensitivity Analysis&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">folder_path</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">folder_path</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="s1">&#39;PGL Sensitivity Analysis&#39;</span><span class="p">)</span>
    <span class="n">folder_path</span> <span class="o">+=</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="s1">&#39;PGL Sensitivity Analysis/&#39;</span>

    <span class="c1"># Adjust the chart settings</span>
    <span class="n">p_dict</span><span class="p">[</span><span class="s2">&quot;objective&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Combined Quota&quot;</span>
    <span class="n">p_dict</span><span class="p">[</span><span class="s2">&quot;version&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;quantity_bar&quot;</span>
    <span class="n">p_dict</span><span class="p">[</span><span class="s1">&#39;macro_chart_kind&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;AFSC Chart&#39;</span>
    <span class="n">p_dict</span><span class="p">[</span><span class="s1">&#39;save&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># Get contents of folder to determine sub-folder this analysis will be in</span>
    <span class="n">folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span>

    <span class="c1"># Settings for max quotas</span>
    <span class="n">true_max</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;quota_max&#39;</span><span class="p">])</span>

    <span class="c1"># If we are starting where we left off and have provided a valid Analysis folder, we import there</span>
    <span class="k">if</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;import_pgl_analysis_folder&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">folder</span><span class="p">:</span>
        <span class="n">sub_folder_name</span> <span class="o">=</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;import_pgl_analysis_folder&#39;</span><span class="p">]</span>
        <span class="n">folder_path</span> <span class="o">+=</span> <span class="n">sub_folder_name</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>

        <span class="c1"># Print statement</span>
        <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Conducting PGL sensitivity analysis on this problem instance &quot;</span>
                  <span class="s2">&quot;from imported &#39;&quot;</span> <span class="o">+</span> <span class="n">sub_folder_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;...&quot;</span><span class="p">)</span>

        <span class="c1"># Import dataframes</span>
        <span class="n">capacities_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">folder_path</span> <span class="o">+</span> <span class="s2">&quot;Capacities.csv&quot;</span><span class="p">)</span>
        <span class="n">solutions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">folder_path</span> <span class="o">+</span> <span class="s2">&quot;Solutions.csv&quot;</span><span class="p">)</span>

        <span class="c1"># Load dictionaries</span>
        <span class="n">capacities_dict</span> <span class="o">=</span> <span class="p">{</span><span class="nb">int</span><span class="p">(</span><span class="n">col</span><span class="p">):</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">capacities_df</span><span class="p">[</span><span class="n">col</span><span class="p">])</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">capacities_df</span><span class="p">}</span>
        <span class="n">solutions_dict</span> <span class="o">=</span> <span class="p">{</span><span class="nb">int</span><span class="p">(</span><span class="n">col</span><span class="p">):</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">solutions_df</span><span class="p">[</span><span class="n">col</span><span class="p">])</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">solutions_df</span><span class="p">}</span>

        <span class="c1"># Determine what our last iteration was</span>
        <span class="n">iteration</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">capacities_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="c1"># Set initial quota_max</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;quota_max&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">capacities_dict</span><span class="p">[</span><span class="n">iteration</span><span class="p">]</span>

        <span class="c1"># Add the current solution to the instance</span>
        <span class="n">instance</span><span class="o">.</span><span class="n">add_solution</span><span class="p">(</span><span class="n">solutions_dict</span><span class="p">[</span><span class="n">iteration</span><span class="p">])</span>

        <span class="c1"># Process that solution to get new quota max</span>
        <span class="n">alter_quota_max</span><span class="p">(</span><span class="n">done_iterating</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Set the iterations</span>
        <span class="n">iteration</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">iterations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">iteration</span><span class="p">,</span> <span class="n">iteration</span> <span class="o">+</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;num_pgl_analysis_iterations&#39;</span><span class="p">])</span>

    <span class="c1"># If we are starting from scratch, create the new analysis folder and start that way</span>
    <span class="k">else</span><span class="p">:</span>

        <span class="c1"># Crate the new folder</span>
        <span class="n">name_determined</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">name_determined</span><span class="p">:</span>
            <span class="n">sub_folder_name</span> <span class="o">=</span> <span class="s2">&quot;Analysis &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">sub_folder_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">folder</span><span class="p">:</span>
                <span class="n">folder_path</span> <span class="o">+=</span> <span class="n">sub_folder_name</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span>  <span class="c1"># Make the folder</span>
                <span class="n">name_determined</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Print statement</span>
        <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Conducting PGL sensitivity analysis on this problem instance &quot;</span>
                  <span class="s2">&quot;using new &#39;&quot;</span> <span class="o">+</span> <span class="n">sub_folder_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;...&quot;</span><span class="p">)</span>

        <span class="c1"># Set essentially no maximum value for each AFSC at the beginning</span>
        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;quota_max&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1000</span> <span class="k">if</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^NRL&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;quota_max&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]])</span>

        <span class="c1"># Create dictionaries of solution/capacity arrays</span>
        <span class="n">solutions_dict</span><span class="p">,</span> <span class="n">capacities_dict</span> <span class="o">=</span> <span class="p">{},{}</span>

        <span class="c1"># Set the iterations</span>
        <span class="n">iterations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;num_pgl_analysis_iterations&#39;</span><span class="p">])</span>

    <span class="c1"># Loop through each iteration</span>
    <span class="n">done_iterating</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="n">iterations</span><span class="p">:</span>

        <span class="c1"># Update the value parameters with the new quota max</span>
        <span class="n">instance</span><span class="o">.</span><span class="n">update_value_parameters</span><span class="p">()</span>

        <span class="c1"># Run the model</span>
        <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Solving iteration&quot;</span><span class="p">,</span> <span class="n">iteration</span><span class="p">,</span> <span class="s2">&quot;with capacities&quot;</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;quota_max&#39;</span><span class="p">])</span>
        <span class="n">instance</span><span class="o">.</span><span class="n">solve_guo_pyomo_model</span><span class="p">(</span><span class="n">p_dict</span><span class="p">,</span> <span class="n">printing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Save solution and capacities information</span>
        <span class="n">capacities_dict</span><span class="p">[</span><span class="n">iteration</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;quota_max&#39;</span><span class="p">])</span>
        <span class="n">solutions_dict</span><span class="p">[</span><span class="n">iteration</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;afsc_array&#39;</span><span class="p">]</span>

        <span class="c1"># Process the solution</span>
        <span class="n">done_iterating</span> <span class="o">=</span> <span class="n">alter_quota_max</span><span class="p">(</span><span class="n">done_iterating</span><span class="p">)</span>

        <span class="c1"># If we&#39;re done iterating, stop. Otherwise, build the chart</span>
        <span class="k">if</span> <span class="n">done_iterating</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>

            <span class="c1"># Save dataframes at each step</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Saving dataframes..&quot;</span><span class="p">)</span>
            <span class="n">capacities_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">capacities_dict</span><span class="p">)</span>
            <span class="n">capacities_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">folder_path</span> <span class="o">+</span> <span class="s2">&quot;Capacities.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">solutions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">solutions_dict</span><span class="p">)</span>
            <span class="n">solutions_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">folder_path</span> <span class="o">+</span> <span class="s2">&quot;Solutions.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://gitlab.com/path-to-your-repo" target="_blank" rel="noopener" title="gitlab.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/input/tex/extensions/bm.js"></script>
      
    
  </body>
</html>