
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://dglaird.github.io/afccp/reference/solutions/optimization/">
      
      
        <link rel="prev" href="../handling/">
      
      
        <link rel="next" href="../sensitivity/">
      
      
      <link rel="icon" href="../../../images/logos/afccp_logo_favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Optimization - Air Force Cadet Career Problem</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#solutions.optimization" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Air Force Cadet Career Problem" class="md-header__button md-logo" aria-label="Air Force Cadet Career Problem" data-md-component="logo">
      
  <img src="../../../images/logos/afccp_logo_and_text_light.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Air Force Cadet Career Problem
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Optimization
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/dglaird/afccp/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  üè† Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../getting-started/getting-started/" class="md-tabs__link">
          
  
  
  üöÄ Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../user-guide/overview/" class="md-tabs__link">
          
  
  
  üìò User Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../developer-guide/" class="md-tabs__link">
        
  
  
    
  
  üß† Developer Guide

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../main/cadetcareerproblem_overview/" class="md-tabs__link">
          
  
  
  CadetCareerProblem

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../data/" class="md-tabs__link">
          
  
  
  üìä Data

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  üìà Solutions

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../visualizations/" class="md-tabs__link">
          
  
  
  Visualizations

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../faq/" class="md-tabs__link">
        
  
  
    
  
  ‚ùì FAQs

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../help/" class="md-tabs__link">
        
  
  
    
  
  üÜò Help & Support

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Air Force Cadet Career Problem" class="md-nav__button md-logo" aria-label="Air Force Cadet Career Problem" data-md-component="logo">
      
  <img src="../../../images/logos/afccp_logo_and_text_light.png" alt="logo">

    </a>
    Air Force Cadet Career Problem
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/dglaird/afccp/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üè† Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üöÄ Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            üöÄ Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting-started/getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üìÑ Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üõ†Ô∏è Install Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            üõ†Ô∏è Install Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting-started/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation Instructions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting-started/developer-checklist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Developer Checklist
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üìò User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            üìò User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/tutorial_1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 1 (Introduction)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/tutorial_2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 2 (Data Overview)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/tutorial_3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 3 (Parameters)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/tutorial_4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 4 (Value Parameters)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üß† Developer Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    CadetCareerProblem
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            CadetCareerProblem
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_generated_data_corrections/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generated Data Corrections
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_main_data_corrections/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Main Data Corrections
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_other_adjustments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Other Adjustments
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_value_parameter_specifications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Value Parameter Specifications
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_solution_generation_%26_algorithms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solution Generation & Algorithms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_optimization_models_%26_meta-heuristics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Optimization Models & Meta-Heuristics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_solution_handling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solution Handling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_export_data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Export Data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_data_visualizations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Visualizations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../main/cadetcareerproblem_results_visualizations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Results Visualizations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üìä Data
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            üìä Data
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/adjustments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Adjustments
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/preferences/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Preferences
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/processing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Processing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/values/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Values
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/support/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Support
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/generation/basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generation- 'Basic'
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/generation/realistic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generation- 'Realistic'
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    üìà Solutions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            üìà Solutions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algorithms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Algorithms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../handling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Handling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Optimization
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Optimization
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#solutions.optimization.assignment_model_build" class="md-nav__link">
    <span class="md-ellipsis">
      assignment_model_build
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solutions.optimization.assignment_model_objective_function_definition" class="md-nav__link">
    <span class="md-ellipsis">
      assignment_model_objective_function_definition
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solutions.optimization.common_optimization_handling" class="md-nav__link">
    <span class="md-ellipsis">
      common_optimization_handling
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solutions.optimization.log_constraint_violations_to_file" class="md-nav__link">
    <span class="md-ellipsis">
      log_constraint_violations_to_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solutions.optimization.handle_infeasible_model" class="md-nav__link">
    <span class="md-ellipsis">
      handle_infeasible_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solutions.optimization.parse_lp_file_debug" class="md-nav__link">
    <span class="md-ellipsis">
      parse_lp_file_debug
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solutions.optimization.parse_lp_file" class="md-nav__link">
    <span class="md-ellipsis">
      parse_lp_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solutions.optimization.solve_pyomo_model" class="md-nav__link">
    <span class="md-ellipsis">
      solve_pyomo_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solutions.optimization.execute_solver" class="md-nav__link">
    <span class="md-ellipsis">
      execute_solver
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solutions.optimization.vft_model_build" class="md-nav__link">
    <span class="md-ellipsis">
      vft_model_build
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solutions.optimization.initialize_value_function_constraint_lists" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_value_function_constraint_lists
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solutions.optimization.add_objective_measure_constraint" class="md-nav__link">
    <span class="md-ellipsis">
      add_objective_measure_constraint
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solutions.optimization.add_objective_value_function_constraints" class="md-nav__link">
    <span class="md-ellipsis">
      add_objective_value_function_constraints
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solutions.optimization.base_training_model_handling" class="md-nav__link">
    <span class="md-ellipsis">
      base_training_model_handling
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solutions.optimization.bubble_chart_configuration_model" class="md-nav__link">
    <span class="md-ellipsis">
      bubble_chart_configuration_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solutions.optimization.gp_model_build" class="md-nav__link">
    <span class="md-ellipsis">
      gp_model_build
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solutions.optimization.calculate_rewards_penalties" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_rewards_penalties
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sensitivity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sensitivity
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Visualizations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Visualizations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../visualizations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../visualizations/bubbles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bubbles
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../visualizations/charts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Charts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../visualizations/slides/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Slides
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ‚ùì FAQs
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../help/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üÜò Help & Support
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<div class="doc doc-object doc-module">



<h1 id="solutions.optimization" class="doc doc-heading">
            <code>solutions.optimization</code>


<a href="#solutions.optimization" class="headerlink" title="Permanent link">&para;</a></h1>

    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="solutions.optimization.assignment_model_build" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">assignment_model_build</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">printing</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#solutions.optimization.assignment_model_build" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Converts the parameters and value parameters to the pyomo data structure</p>
<p>Parameters:
    instance (object): Problem instance object
    printing (bool, optional): Whether the procedure should print something. Default is False.</p>
<p>Returns:
    pyomo data: Pyomo data representing the converted model</p>
<p>Description:
    This function builds a Pyomo model based on the provided problem instance. It converts the parameters and value
    parameters into the Pyomo data structure and constructs the objective function and constraints of the model.</p>
<div class="highlight"><pre><span></span><code>The function takes a problem instance object as input, which contains the necessary parameters and value parameters
for building the model. The `printing` parameter controls whether the procedure should print progress information
during model construction.

The utility/cost matrix is computed based on the parameters and value parameters. The AFSC preferences, merit,
and eligibility information are used to calculate the cost values for each cadet-AFSC pair in the matrix.

The model is built using the Pyomo `ConcreteModel` class. The variables, objective function, and constraints
are defined within the model.

The objective function is defined as the sum of the cost values multiplied by the corresponding decision variable
for each cadet-AFSC pair.

The constraints include ensuring that each cadet is assigned to exactly one AFSC, limiting the percentage of
USAFA cadets in certain AFSCs, and applying AFSC objective measure constraints if specified.

If `printing` is set to True, the function prints progress information during the model construction.

Finally, the constructed model is returned.
</code></pre></div>
<p>Example:
    instance = ProblemInstance()
    model = assignment_model_build(instance, printing=True)
    ...</p>

            <details class="quote">
              <summary>Source code in <code>afccp/solutions/optimization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">assignment_model_build</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">printing</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the parameters and value parameters to the pyomo data structure</span>

<span class="sd">    Parameters:</span>
<span class="sd">        instance (object): Problem instance object</span>
<span class="sd">        printing (bool, optional): Whether the procedure should print something. Default is False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pyomo data: Pyomo data representing the converted model</span>

<span class="sd">    Description:</span>
<span class="sd">        This function builds a Pyomo model based on the provided problem instance. It converts the parameters and value</span>
<span class="sd">        parameters into the Pyomo data structure and constructs the objective function and constraints of the model.</span>

<span class="sd">        The function takes a problem instance object as input, which contains the necessary parameters and value parameters</span>
<span class="sd">        for building the model. The `printing` parameter controls whether the procedure should print progress information</span>
<span class="sd">        during model construction.</span>

<span class="sd">        The utility/cost matrix is computed based on the parameters and value parameters. The AFSC preferences, merit,</span>
<span class="sd">        and eligibility information are used to calculate the cost values for each cadet-AFSC pair in the matrix.</span>

<span class="sd">        The model is built using the Pyomo `ConcreteModel` class. The variables, objective function, and constraints</span>
<span class="sd">        are defined within the model.</span>

<span class="sd">        The objective function is defined as the sum of the cost values multiplied by the corresponding decision variable</span>
<span class="sd">        for each cadet-AFSC pair.</span>

<span class="sd">        The constraints include ensuring that each cadet is assigned to exactly one AFSC, limiting the percentage of</span>
<span class="sd">        USAFA cadets in certain AFSCs, and applying AFSC objective measure constraints if specified.</span>

<span class="sd">        If `printing` is set to True, the function prints progress information during the model construction.</span>

<span class="sd">        Finally, the constructed model is returned.</span>

<span class="sd">    Example:</span>
<span class="sd">        instance = ProblemInstance()</span>
<span class="sd">        model = assignment_model_build(instance, printing=True)</span>
<span class="sd">        ...</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">mdl_p</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span> <span class="n">instance</span><span class="o">.</span><span class="n">value_parameters</span><span class="p">,</span> <span class="n">instance</span><span class="o">.</span><span class="n">mdl_p</span>

    <span class="c1"># *New* Utility/&quot;Cost&quot; Matrix based on CFM preferences and cadet preferences (GUO model)</span>
    <span class="k">if</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;assignment_model_obj&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Global Utility&#39;</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;global_utility&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Building assignment problem (GUO) model...&quot;</span><span class="p">)</span>

    <span class="c1"># Original Model Utility/&quot;Cost&quot; Matrix  (Original model)</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># This is the &quot;legacy&quot; AFPC model!</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">build_old_afpc_model_utility_matrix</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Building original assignment problem model...&quot;</span><span class="p">)</span>

    <span class="c1"># Build Model</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">ConcreteModel</span><span class="p">()</span>

    <span class="c1"># ___________________________________VARIABLE DEFINITION_________________________________</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">common_optimization_handling</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">mdl_p</span><span class="p">)</span>  <span class="c1"># Define x along with additional functional constraints</span>

    <span class="c1"># Base/Training model extra components</span>
    <span class="k">if</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;solve_extra_components&#39;</span><span class="p">]:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">base_training_model_handling</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mdl_p</span><span class="p">)</span>

    <span class="c1"># Initialize CASTLE value curve variables</span>
    <span class="k">if</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;solve_castle_guo&#39;</span><span class="p">]:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">initialize_castle_value_curve_function_variables</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;castle_q&#39;</span><span class="p">])</span>

    <span class="c1"># ___________________________________OBJECTIVE FUNCTION__________________________________</span>
    <span class="n">m</span><span class="o">.</span><span class="n">objective</span> <span class="o">=</span> <span class="n">assignment_model_objective_function_definition</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="o">=</span><span class="n">vp</span><span class="p">,</span> <span class="n">mdl_p</span><span class="o">=</span><span class="n">mdl_p</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>

    <span class="c1"># ________________________________________CONSTRAINTS_____________________________________</span>
    <span class="n">m</span><span class="o">.</span><span class="n">measure_constraints</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>  <span class="c1"># AFSC Objective Measure Constraints (Optional decision-maker constraints)</span>

    <span class="c1"># Incorporate CASTLE value curve functional constraints</span>
    <span class="k">if</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;solve_castle_guo&#39;</span><span class="p">]:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">initialize_value_function_constraint_lists</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

        <span class="c1"># Loop through each CASTLE AFSC to add the constraints</span>
        <span class="k">for</span> <span class="n">castle_afsc</span><span class="p">,</span> <span class="n">j_indices</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^CASTLE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

            <span class="c1"># Get the number of people assigned to each AFSC under this &quot;CASTLE&quot; AFSC umbrella (+ ADD OTS!!)</span>
            <span class="k">if</span> <span class="s1">&#39;ots&#39;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;SOCs&#39;</span><span class="p">]:</span>  <span class="c1"># If OTS is in the model, we don&#39;t have to account for them</span>
                <span class="n">measure</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I^E&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">j_indices</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># If we are not matching OTS, we have to account for them</span>
                <span class="n">measure</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I^E&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">j_indices</span><span class="p">)</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;ots_counts&#39;</span><span class="p">][</span>
                    <span class="n">castle_afsc</span><span class="p">]</span>

            <span class="c1"># Add the value curve constraints for this &quot;CASTLE&quot; AFSC</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">add_castle_value_curve_function_constraints</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">measure</span><span class="p">,</span> <span class="n">afsc</span><span class="o">=</span><span class="n">castle_afsc</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;castle_q&#39;</span><span class="p">])</span>

    <span class="c1"># Loop through all AFSCs to add AFSC objective measure constraints</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]:</span>

        <span class="c1"># Loop through all constrained AFSC objectives</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;K^C&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]:</span>
            <span class="c1"># Calculate AFSC objective measure components</span>
            <span class="n">measure</span><span class="p">,</span> <span class="n">numerator</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">handling</span><span class="o">.</span><span class="n">calculate_objective_measure_matrix</span><span class="p">(</span>
                <span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objectives&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">approximate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="c1"># Add AFSC objective measure constraint</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">add_objective_measure_constraint</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">measure</span><span class="p">,</span> <span class="n">numerator</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done. Solving model...&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;usafa_soc_pilot_cross_in&#39;</span><span class="p">]:</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;11XX_U&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objectives&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Combined Quota&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s2">&quot;objective_min&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">vp</span><span class="p">[</span><span class="s2">&quot;objective_max&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">])</span> <span class="ow">and</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;constraint_type&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*****************WARNING**********************&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Model designated to allow USAFA Pilot cross-flows but constraints are still activated that&quot;</span>
                  <span class="s2">&quot; would prevent this.</span><span class="se">\n</span><span class="s2">Ensure you turn off the USAFA/ROTC pilot quota&quot;</span><span class="p">,</span>
                  <span class="sa">f</span><span class="s2">&quot;constraints in &#39;</span><span class="si">{</span><span class="n">instance</span><span class="o">.</span><span class="n">data_name</span><span class="si">}</span><span class="s2"> VP.csv&#39;&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">m</span>  <span class="c1"># Return model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="solutions.optimization.assignment_model_objective_function_definition" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">assignment_model_objective_function_definition</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">mdl_p</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span></code>

<a href="#solutions.optimization.assignment_model_objective_function_definition" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Define the objective function for the assignment model.</p>
<p>This function constructs the objective function for an assignment optimization model.
The objective function varies depending on whether the model includes additional components
(<code>solve_extra_components</code>) or only considers AFSC-based assignments.</p>
<p>If <code>solve_extra_components</code> is enabled, the objective function consists of two weighted
components:
- A cadet-specific value function weighted by <code>cadets_overall_weight</code> and individual
  cadet weights.
- An AFSC-specific utility function weighted by <code>afscs_overall_weight</code> and normalized by <code>1/N</code>.</p>
<p>If <code>solve_extra_components</code> is disabled, the function simplifies to maximizing
the AFSC-only utility values.</p>
<p>Args:
    m (ConcreteModel): The Pyomo model to which the objective function will be added.
    p (dict): A dictionary containing problem parameters, including:
        - 'I': Set of cadets.
        - 'J^E': Set of available AFSCs for each cadet.
        - 'afsc_utility': Utility values for cadet-to-AFSC assignments.
        - 'N': Normalization factor for AFSC weight.
    vp (dict): A dictionary containing value parameters, including:
        - 'cadets_overall_weight': Overall weight for cadet value.
        - 'cadet_weight': Individual weights for cadets.
        - 'afscs_overall_weight': Overall weight for AFSC utility.
    mdl_p (dict): Model parameters containing:
        - 'solve_extra_components' (bool): Determines whether additional components
          (cadet-based value) are included in the objective.
    c (dict): A dictionary of AFSC-only utility values used when <code>solve_extra_components</code>
        is disabled.</p>
<p>Returns:
    Objective: The Pyomo Objective function, maximizing either the full weighted sum
    of cadet and AFSC utility (if <code>solve_extra_components</code> is True) or just AFSC utility
    (if False).</p>

            <details class="quote">
              <summary>Source code in <code>afccp/solutions/optimization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">assignment_model_objective_function_definition</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">mdl_p</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Define the objective function for the assignment model.</span>

<span class="sd">    This function constructs the objective function for an assignment optimization model.</span>
<span class="sd">    The objective function varies depending on whether the model includes additional components</span>
<span class="sd">    (`solve_extra_components`) or only considers AFSC-based assignments.</span>

<span class="sd">    If `solve_extra_components` is enabled, the objective function consists of two weighted</span>
<span class="sd">    components:</span>
<span class="sd">    - A cadet-specific value function weighted by `cadets_overall_weight` and individual</span>
<span class="sd">      cadet weights.</span>
<span class="sd">    - An AFSC-specific utility function weighted by `afscs_overall_weight` and normalized by `1/N`.</span>

<span class="sd">    If `solve_extra_components` is disabled, the function simplifies to maximizing</span>
<span class="sd">    the AFSC-only utility values.</span>

<span class="sd">    Args:</span>
<span class="sd">        m (ConcreteModel): The Pyomo model to which the objective function will be added.</span>
<span class="sd">        p (dict): A dictionary containing problem parameters, including:</span>
<span class="sd">            - &#39;I&#39;: Set of cadets.</span>
<span class="sd">            - &#39;J^E&#39;: Set of available AFSCs for each cadet.</span>
<span class="sd">            - &#39;afsc_utility&#39;: Utility values for cadet-to-AFSC assignments.</span>
<span class="sd">            - &#39;N&#39;: Normalization factor for AFSC weight.</span>
<span class="sd">        vp (dict): A dictionary containing value parameters, including:</span>
<span class="sd">            - &#39;cadets_overall_weight&#39;: Overall weight for cadet value.</span>
<span class="sd">            - &#39;cadet_weight&#39;: Individual weights for cadets.</span>
<span class="sd">            - &#39;afscs_overall_weight&#39;: Overall weight for AFSC utility.</span>
<span class="sd">        mdl_p (dict): Model parameters containing:</span>
<span class="sd">            - &#39;solve_extra_components&#39; (bool): Determines whether additional components</span>
<span class="sd">              (cadet-based value) are included in the objective.</span>
<span class="sd">        c (dict): A dictionary of AFSC-only utility values used when `solve_extra_components`</span>
<span class="sd">            is disabled.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Objective: The Pyomo Objective function, maximizing either the full weighted sum</span>
<span class="sd">        of cadet and AFSC utility (if `solve_extra_components` is True) or just AFSC utility</span>
<span class="sd">        (if False).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Do we incorporate base/training decision components to the model?</span>
    <span class="k">if</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;solve_extra_components&#39;</span><span class="p">]:</span>

        <span class="c1"># Base/Training model objective function</span>
        <span class="k">def</span> <span class="nf">objective_function</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;cadets_overall_weight&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;cadet_weight&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">cadet_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">])</span> <span class="o">+</span> \
                   <span class="mi">1</span> <span class="o">/</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;afscs_overall_weight&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;afsc_utility&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^E&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">])</span>

    <span class="k">else</span><span class="p">:</span>  <span class="c1"># If not, we solve the &quot;AFSC-only&quot; assignment problem model</span>

        <span class="c1"># AFSC-only objective function (GUO) i.e. (not base/training component considerations)</span>
        <span class="n">z_guo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;J^E&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;N^Match&#39;</span><span class="p">]</span>

        <span class="k">def</span> <span class="nf">objective_function</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>  <span class="c1"># Standard &quot;GUO&quot; function value &quot;z^GUO&quot;</span>
            <span class="k">return</span> <span class="n">z_guo</span>

        <span class="c1"># Determine whether we want to add &quot;CASTLE&quot; modeling components or not</span>
        <span class="k">if</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;solve_castle_guo&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="s1">&#39;castle_q&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>  <span class="c1"># If we don&#39;t have castle parameters, we can&#39;t solve the model</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CASTLE Parameters not found. We cannot solve model w/CASTLE modifications.&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">Objective</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="n">objective_function</span><span class="p">,</span> <span class="n">sense</span><span class="o">=</span><span class="n">maximize</span><span class="p">)</span>  <span class="c1"># Return normal GUO function</span>
            <span class="n">afscs</span> <span class="o">=</span> <span class="p">[</span><span class="n">afsc</span> <span class="k">for</span> <span class="n">afsc</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;castle_afscs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>

            <span class="c1"># Define the Castle-informed objective function!</span>
            <span class="n">z_castle_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">f_value</span><span class="p">[</span><span class="n">afsc</span><span class="p">]</span> <span class="k">for</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="n">afscs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;w^G&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Weight on Castle solution is zero so we don&#39;t need to include it!</span>
                <span class="k">def</span> <span class="nf">objective_function</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>  <span class="c1"># Standard &quot;GUO&quot; function value &quot;z^GUO&quot;</span>
                    <span class="k">return</span> <span class="n">z_guo</span>
            <span class="k">elif</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;w^G&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Weight on GUO solution is zero so just use Castle information</span>
                <span class="k">def</span> <span class="nf">objective_function</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>  <span class="c1"># Castle-values portion of objective function</span>
                    <span class="k">return</span> <span class="n">z_castle_values</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">def</span> <span class="nf">objective_function</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>  <span class="c1"># Full weighted function of GUO and Castle</span>
                    <span class="k">return</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;w^G&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">z_guo</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;w^G&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">z_castle_values</span>

    <span class="c1"># Objective function has been defined</span>
    <span class="k">return</span> <span class="n">Objective</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="n">objective_function</span><span class="p">,</span> <span class="n">sense</span><span class="o">=</span><span class="n">maximize</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="solutions.optimization.common_optimization_handling" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">common_optimization_handling</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">mdl_p</span><span class="p">)</span></code>

<a href="#solutions.optimization.common_optimization_handling" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Adds optimization model components common to <em>main</em> optimization models like VFT and the generalized assignment
problem models.</p>
<p>Parameters:
m (ConcreteModel): The Pyomo ConcreteModel instance to which the optimization model components will be added.
p (dict): A dictionary containing problem-specific data, including cadet, AFSC, base, course, utility, and weight
         information.
vp (dict): A dictionary containing value-specific parameters and information.
mdl_p (dict): A dictionary containing model-specific parameters and configurations.</p>
<p>Returns:
ConcreteModel: The modified Pyomo ConcreteModel instance with added optimization model components.</p>
<p>Notes:
- This function extends the given Pyomo ConcreteModel (m) by adding optimization model components common to
  various main optimization models.
- The parameters include:
    - m: The Pyomo ConcreteModel instance to be extended.
    - p: A dictionary containing various problem-specific data, such as cadet information, AFSCs, bases, courses,
         utility values, and weights.
    - vp: A dictionary containing value-specific parameters and information.
    - mdl_p: A dictionary containing model-specific parameters and configurations.
- The added optimization model components include binary variables (x), constraints for cadet AFSC assignment,
  cadet value constraints, constraints for fixed variables, reserved AFSC constraints, and constraints for
  AFSC cadet percentages, among others.
- Additional constraints handle special cases like alternate list rated addition, 5% cap on total percentage of
  USAFA cadets allowed in certain AFSCs, USSF SOC PGL constraint, and USSF OM constraint.
- The given ConcreteModel (m) is modified in-place and returned for further use.</p>

            <details class="quote">
              <summary>Source code in <code>afccp/solutions/optimization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">common_optimization_handling</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">mdl_p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds optimization model components common to *main* optimization models like VFT and the generalized assignment</span>
<span class="sd">    problem models.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    m (ConcreteModel): The Pyomo ConcreteModel instance to which the optimization model components will be added.</span>
<span class="sd">    p (dict): A dictionary containing problem-specific data, including cadet, AFSC, base, course, utility, and weight</span>
<span class="sd">             information.</span>
<span class="sd">    vp (dict): A dictionary containing value-specific parameters and information.</span>
<span class="sd">    mdl_p (dict): A dictionary containing model-specific parameters and configurations.</span>

<span class="sd">    Returns:</span>
<span class="sd">    ConcreteModel: The modified Pyomo ConcreteModel instance with added optimization model components.</span>

<span class="sd">    Notes:</span>
<span class="sd">    - This function extends the given Pyomo ConcreteModel (m) by adding optimization model components common to</span>
<span class="sd">      various main optimization models.</span>
<span class="sd">    - The parameters include:</span>
<span class="sd">        - m: The Pyomo ConcreteModel instance to be extended.</span>
<span class="sd">        - p: A dictionary containing various problem-specific data, such as cadet information, AFSCs, bases, courses,</span>
<span class="sd">             utility values, and weights.</span>
<span class="sd">        - vp: A dictionary containing value-specific parameters and information.</span>
<span class="sd">        - mdl_p: A dictionary containing model-specific parameters and configurations.</span>
<span class="sd">    - The added optimization model components include binary variables (x), constraints for cadet AFSC assignment,</span>
<span class="sd">      cadet value constraints, constraints for fixed variables, reserved AFSC constraints, and constraints for</span>
<span class="sd">      AFSC cadet percentages, among others.</span>
<span class="sd">    - Additional constraints handle special cases like alternate list rated addition, 5% cap on total percentage of</span>
<span class="sd">      USAFA cadets allowed in certain AFSCs, USSF SOC PGL constraint, and USSF OM constraint.</span>
<span class="sd">    - The given ConcreteModel (m) is modified in-place and returned for further use.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Define the x-variable</span>
    <span class="n">m</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^E&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]),</span> <span class="n">within</span><span class="o">=</span><span class="n">Binary</span><span class="p">)</span>

    <span class="c1"># Cadets receive one and only one AFSC (Ineligibility constraint is always met as a result of the indexed sets)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">one_afsc_constraints</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>  <span class="c1"># ...except for OTS candidates- there is a lot of nuance there!</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">add_x_variable_one_afsc_constraints</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mdl_p</span><span class="p">)</span>  <span class="c1"># Modify the &quot;one_afsc_constraints&quot; list for each cadet</span>

    <span class="c1"># Cadets may sometimes be constrained to be part of one &quot;Accessions Group&quot; (probably just USSF)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">acc_grp_constraints</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>
    <span class="k">if</span> <span class="s1">&#39;acc_grp_constraint&#39;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">acc_grp</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs_acc_grp&#39;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I^&#39;</span> <span class="o">+</span> <span class="n">acc_grp</span><span class="p">]:</span>
                <span class="n">m</span><span class="o">.</span><span class="n">acc_grp_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
                    <span class="n">expr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^&#39;</span> <span class="o">+</span> <span class="n">acc_grp</span><span class="p">]</span> <span class="k">if</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^E&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Cadet value constraint (Could work on any optimization model)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">min_cadet_value_constraints</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;I^C&#39;</span><span class="p">]:</span>  <span class="c1"># &quot;J^Top_Choice is set of AFSCs at or above designated utility value (typically top 3)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">min_cadet_value_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;J^Top_Choice&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># &quot;AlTERNATE LIST&quot; Rated Addition</span>
    <span class="k">if</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;rated_alternates&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="s1">&#39;J^Preferred [usafa]&#39;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>  <span class="c1"># If [usafa] version is here, [rotc] will be too</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">add_rated_alternates_constraints</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mdl_p</span><span class="p">)</span>

    <span class="c1"># Fixing variables if necessary</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^Fixed&#39;</span><span class="p">]:</span>
        <span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^Fixed&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Cadets with reserved AFSC slots get constrained so that the &quot;worst&quot; choice they can get is their reserved AFSC</span>
    <span class="n">m</span><span class="o">.</span><span class="n">reserved_afsc_constraints</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^Reserved&#39;</span><span class="p">]:</span>
        <span class="n">m</span><span class="o">.</span><span class="n">reserved_afsc_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^Reserved&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># 5% cap on total percentage of USAFA cadets allowed into certain AFSCs</span>
    <span class="k">if</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;USAFA-Constrained AFSCs&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cap</span> <span class="o">=</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;real_usafa_n&quot;</span><span class="p">]</span>  <span class="c1"># Total number of graduating USAFA cadets</span>

        <span class="c1"># Convert list of AFSC names to list of AFSC indices</span>
        <span class="n">constrained_afscs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">afsc</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">afsc</span> <span class="ow">in</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;USAFA-Constrained AFSCs&quot;</span><span class="p">]]</span>

        <span class="c1"># USAFA 5% Cap Constraint</span>
        <span class="k">def</span> <span class="nf">usafa_afscs_rule</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            This is the 5% USAFA graduating class cap constraint for certain AFSCs (support AFSCs). I will note that</span>
<span class="sd">            as of Mar &#39;23 this constraint is effectively null and void! Still here for documentation however and for any</span>
<span class="sd">            potential future experiment</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;usafa_cadets&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">constrained_afscs</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">cap</span>

        <span class="n">m</span><span class="o">.</span><span class="n">usafa_afscs_constraint</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="n">usafa_afscs_rule</span><span class="p">)</span>

    <span class="c1"># Space Force Special Constraints!</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">add_space_force_constraints</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mdl_p</span><span class="p">)</span>

    <span class="c1"># OTS accessions cap</span>
    <span class="k">if</span> <span class="s1">&#39;ots&#39;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;SOCs&#39;</span><span class="p">]:</span>
        <span class="c1"># Determine the cap on OTS accessions</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;OTS accessions capacity constraint: </span><span class="si">{</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;ots_accessions&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Define and apply the constraint</span>
        <span class="k">def</span> <span class="nf">ots_accessions_constraint_rule</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Constraint to ensure we stay under OTS accessions cap</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^E&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I^OTS&#39;</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;ots_accessions&#39;</span><span class="p">]</span>

        <span class="n">m</span><span class="o">.</span><span class="n">ots_accessions_constraint</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="n">ots_accessions_constraint_rule</span><span class="p">)</span>

    <span class="c1"># Return updated model</span>
    <span class="k">return</span> <span class="n">m</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="solutions.optimization.log_constraint_violations_to_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_constraint_violations_to_file</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">max_violations</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span></code>

<a href="#solutions.optimization.log_constraint_violations_to_file" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Logs violated constraints to a text file, suppressing uninitialized variable warnings.</p>
<p>Args:
    model (ConcreteModel): The Pyomo model to inspect.
    filepath (str): Path to the log file.
    tolerance (float): Numerical tolerance for feasibility.
    max_violations (int): Max number of violations to report.</p>

            <details class="quote">
              <summary>Source code in <code>afccp/solutions/optimization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">log_constraint_violations_to_file</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">max_violations</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Logs violated constraints to a text file, suppressing uninitialized variable warnings.</span>

<span class="sd">    Args:</span>
<span class="sd">        model (ConcreteModel): The Pyomo model to inspect.</span>
<span class="sd">        filepath (str): Path to the log file.</span>
<span class="sd">        tolerance (float): Numerical tolerance for feasibility.</span>
<span class="sd">        max_violations (int): Max number of violations to report.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">all_vars_initialized</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Helper to check if all variables in an expression are initialized.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">identify_variables</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">include_fixed</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Constraint Violations Log</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">constr</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">component_objects</span><span class="p">(</span><span class="n">Constraint</span><span class="p">,</span> <span class="n">active</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
            <span class="n">cdata</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">constr</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">cdata</span><span class="p">:</span>
                <span class="n">con</span> <span class="o">=</span> <span class="n">cdata</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">all_vars_initialized</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">body</span><span class="p">):</span>
                        <span class="k">continue</span>  <span class="c1"># Skip uninitialized expressions</span>

                    <span class="n">lhs</span> <span class="o">=</span> <span class="n">value</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
                    <span class="n">lb</span> <span class="o">=</span> <span class="n">value</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">lower</span><span class="p">)</span> <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">lower</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
                    <span class="n">ub</span> <span class="o">=</span> <span class="n">value</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">upper</span><span class="p">)</span> <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">upper</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

                    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">lb</span> <span class="o">-</span> <span class="n">tolerance</span> <span class="o">&lt;=</span> <span class="n">lhs</span> <span class="o">&lt;=</span> <span class="n">ub</span> <span class="o">+</span> <span class="n">tolerance</span><span class="p">):</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚ùå </span><span class="si">{</span><span class="n">constr</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">[</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">]</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    LHS = </span><span class="si">{</span><span class="n">lhs</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Bounds = [</span><span class="si">{</span><span class="n">lb</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ub</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">]</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;=</span> <span class="n">max_violations</span><span class="p">:</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;‚ö†Ô∏è Max violations reached.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                            <span class="k">return</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚ö†Ô∏è Could not evaluate </span><span class="si">{</span><span class="n">constr</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">[</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">]: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;‚úÖ No constraint violations detected.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="solutions.optimization.handle_infeasible_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">handle_infeasible_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="s1">&#39;infeasibility_logs&#39;</span><span class="p">)</span></code>

<a href="#solutions.optimization.handle_infeasible_model" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Handles an infeasible model: prints message, logs diagnostics, and raises error.</p>
<p>Args:
    model (ConcreteModel): The Pyomo model.
    results (SolverResults): The results from solver.solve().
    output_dir (str): Directory to write the LP file and violation log.</p>

            <details class="quote">
              <summary>Source code in <code>afccp/solutions/optimization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">handle_infeasible_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="s2">&quot;infeasibility_logs&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles an infeasible model: prints message, logs diagnostics, and raises error.</span>

<span class="sd">    Args:</span>
<span class="sd">        model (ConcreteModel): The Pyomo model.</span>
<span class="sd">        results (SolverResults): The results from solver.solve().</span>
<span class="sd">        output_dir (str): Directory to write the LP file and violation log.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">output_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_dir</span><span class="p">)</span>

    <span class="n">infeasible_lp_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;infeasible_model.lp&quot;</span><span class="p">)</span>
    <span class="n">violations_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;constraint_violations.txt&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">üö´ Model is infeasible. Writing diagnostics...&quot;</span><span class="p">)</span>

    <span class="c1"># Write model to LP file for further inspection</span>
    <span class="n">model</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">infeasible_lp_path</span><span class="p">,</span> <span class="n">io_options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;symbolic_solver_labels&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üìÑ Model written to: </span><span class="si">{</span><span class="n">infeasible_lp_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Log constraint violations</span>
    <span class="n">log_constraint_violations_to_file</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">violations_path</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üìÑ Constraint violations written to: </span><span class="si">{</span><span class="n">violations_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Log LP analysis</span>
    <span class="n">lp_analysis_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;lp_analysis.txt&quot;</span><span class="p">)</span>
    <span class="n">parse_lp_file</span><span class="p">(</span><span class="n">infeasible_lp_path</span><span class="p">,</span> <span class="n">output_log</span><span class="o">=</span><span class="n">lp_analysis_path</span><span class="p">)</span>
    <span class="n">lp_analysis_debug_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;lp_analysis_debug.txt&quot;</span><span class="p">)</span>
    <span class="n">parse_lp_file_debug</span><span class="p">(</span><span class="n">infeasible_lp_path</span><span class="p">,</span> <span class="n">output_log</span><span class="o">=</span><span class="n">lp_analysis_debug_path</span><span class="p">)</span>

    <span class="c1"># Raise the error</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Model is infeasible. Diagnostics have been saved.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="solutions.optimization.parse_lp_file_debug" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_lp_file_debug</span><span class="p">(</span><span class="n">lp_path</span><span class="p">,</span> <span class="n">output_log</span><span class="o">=</span><span class="s1">&#39;lp_analysis_debug.txt&#39;</span><span class="p">)</span></code>

<a href="#solutions.optimization.parse_lp_file_debug" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Parses and analyzes a .lp file to flag common infeasibility patterns.</p>
<p>Args:
    lp_path (str): Path to the .lp file.
    output_log (str): Output file for diagnostic results.</p>

            <details class="quote">
              <summary>Source code in <code>afccp/solutions/optimization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_lp_file_debug</span><span class="p">(</span><span class="n">lp_path</span><span class="p">,</span> <span class="n">output_log</span><span class="o">=</span><span class="s2">&quot;lp_analysis_debug.txt&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parses and analyzes a .lp file to flag common infeasibility patterns.</span>

<span class="sd">    Args:</span>
<span class="sd">        lp_path (str): Path to the .lp file.</span>
<span class="sd">        output_log (str): Output file for diagnostic results.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">lp_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="n">in_constraints</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">in_bounds</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">in_general</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">constraints</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">binary_vars</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">constraint_vars</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">variable_bounds</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="c1"># Section headers</span>
        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Subject To&quot;</span><span class="p">):</span>
            <span class="n">in_constraints</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Bounds&quot;</span><span class="p">):</span>
            <span class="n">in_constraints</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">in_bounds</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;General&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Binary&quot;</span><span class="p">):</span>
            <span class="n">in_bounds</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">in_general</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;End&quot;</span><span class="p">):</span>
            <span class="n">in_general</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Constraints</span>
        <span class="k">if</span> <span class="n">in_constraints</span><span class="p">:</span>
            <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="n">constraint_vars</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\b\w+\b&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">))</span>

        <span class="c1"># Bounds</span>
        <span class="k">elif</span> <span class="n">in_bounds</span><span class="p">:</span>
            <span class="n">bounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="c1"># Examples:</span>
            <span class="c1"># 0 &lt;= x1 &lt;= 1</span>
            <span class="c1"># x3 free</span>
            <span class="n">parts</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[\w\.-]+&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;free&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">variable_bounds</span><span class="p">[</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;-inf&quot;</span><span class="p">,</span> <span class="s2">&quot;inf&quot;</span><span class="p">,</span> <span class="s2">&quot;free&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                <span class="n">variable_bounds</span><span class="p">[</span><span class="n">parts</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">parts</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="s2">&quot;bounded&quot;</span><span class="p">)</span>

        <span class="c1"># Binary/General</span>
        <span class="k">elif</span> <span class="n">in_general</span><span class="p">:</span>
            <span class="n">binary_vars</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\b\w+\b&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">))</span>

    <span class="n">flagged_issues</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Analyze bounds</span>
    <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span> <span class="ow">in</span> <span class="n">variable_bounds</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;free&quot;</span><span class="p">:</span>
            <span class="n">flagged_issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚ö†Ô∏è Variable </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2"> is free ‚Äî may lead to unboundedness.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">lb</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">float</span><span class="p">(</span><span class="n">ub</span><span class="p">):</span>
                    <span class="n">flagged_issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚ùå Variable </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2"> has inconsistent bounds: </span><span class="si">{</span><span class="n">lb</span><span class="si">}</span><span class="s2"> &gt; </span><span class="si">{</span><span class="n">ub</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">flagged_issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚ö†Ô∏è Variable </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2"> has non-numeric bounds: </span><span class="si">{</span><span class="n">lb</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ub</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Analyze constraints</span>
    <span class="n">eq_constraints</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">constraints</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;= [\d\.-]+&quot;</span><span class="p">,</span> <span class="n">c</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">eq_constraints</span><span class="p">:</span>
        <span class="n">flagged_issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚ö†Ô∏è Hard equality constraint: </span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Check for undeclared variables</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">constraint_vars</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">variable_bounds</span> <span class="ow">and</span> <span class="n">var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">binary_vars</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">):</span>
            <span class="n">flagged_issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚ö†Ô∏è Variable </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2"> used in constraints but not declared.&quot;</span><span class="p">)</span>

    <span class="c1"># Check for large coefficients</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">constraints</span><span class="p">:</span>
        <span class="n">coeffs</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[\+\-]?\s*\d+\.\d+&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">coeff</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e6</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-6</span><span class="p">:</span>
                <span class="n">flagged_issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚ö†Ô∏è Extreme coefficient (</span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">) in: </span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Write log</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_log</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out</span><span class="p">:</span>
        <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;=== LP Debug Analysis ===</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;‚úÖ Basic stats:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  - Constraints: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">constraints</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  - Bounds: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  - Binary/General vars: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">binary_vars</span><span class="p">)</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">flagged_issues</span><span class="p">:</span>
            <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;‚ùó Potential Issues Found:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">issue</span> <span class="ow">in</span> <span class="n">flagged_issues</span><span class="p">:</span>
                <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;  &quot;</span> <span class="o">+</span> <span class="n">issue</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;‚úÖ No obvious issues found.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Sample Constraints ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">constraints</span><span class="p">[:</span><span class="mi">10</span><span class="p">]:</span>
            <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;  &quot;</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Sample Bounds ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bounds</span><span class="p">[:</span><span class="mi">10</span><span class="p">]:</span>
            <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;  &quot;</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üìÑ LP analysis written to: </span><span class="si">{</span><span class="n">output_log</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="solutions.optimization.parse_lp_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_lp_file</span><span class="p">(</span><span class="n">lp_path</span><span class="p">,</span> <span class="n">output_log</span><span class="o">=</span><span class="s1">&#39;lp_analysis.txt&#39;</span><span class="p">)</span></code>

<a href="#solutions.optimization.parse_lp_file" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Parses a .lp file and logs constraints and bounds for debugging.</p>
<p>Args:
    lp_path (str): Path to the .lp file.
    output_log (str): File to write analysis log to.</p>

            <details class="quote">
              <summary>Source code in <code>afccp/solutions/optimization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_lp_file</span><span class="p">(</span><span class="n">lp_path</span><span class="p">,</span> <span class="n">output_log</span><span class="o">=</span><span class="s2">&quot;lp_analysis.txt&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parses a .lp file and logs constraints and bounds for debugging.</span>

<span class="sd">    Args:</span>
<span class="sd">        lp_path (str): Path to the .lp file.</span>
<span class="sd">        output_log (str): File to write analysis log to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">lp_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="n">in_constraints</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">in_bounds</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">in_general</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">constraints</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">binary_vars</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Subject To&quot;</span><span class="p">):</span>
            <span class="n">in_constraints</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Bounds&quot;</span><span class="p">):</span>
            <span class="n">in_constraints</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">in_bounds</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;General&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Binary&quot;</span><span class="p">):</span>
            <span class="n">in_bounds</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">in_general</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;End&quot;</span><span class="p">):</span>
            <span class="n">in_general</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">in_constraints</span><span class="p">:</span>
            <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">in_bounds</span><span class="p">:</span>
            <span class="n">bounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">in_general</span><span class="p">:</span>
            <span class="n">binary_vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_log</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out</span><span class="p">:</span>
        <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;=== Constraint Section ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">constraints</span><span class="p">[:</span><span class="mi">50</span><span class="p">]:</span>  <span class="c1"># show only first 50 for brevity</span>
            <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Bounds Section ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bounds</span><span class="p">[:</span><span class="mi">50</span><span class="p">]:</span>
            <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Binary/General Variables ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">binary_vars</span><span class="p">:</span>
            <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">v</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">‚úÖ Finished parsing LP file.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚úîÔ∏è LP file parsed and analyzed. Results written to: </span><span class="si">{</span><span class="n">output_log</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="solutions.optimization.solve_pyomo_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">solve_pyomo_model</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">printing</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#solutions.optimization.solve_pyomo_model" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Solve a Pyomo model using a specified solver.</p>
<p>This function takes an instance, a Pyomo model, the model name, optional parameters (q), and a flag for printing
intermediate information. It adjusts the solver settings based on the provided instance parameters, solves the
model, and returns the solution.</p>
<p>Args:
    instance: The Pyomo instance.
    model: The Pyomo model to solve.
    model_name (str): The name of the model.
    q (dict, optional): Optional parameters.
    printing (bool, optional): Flag for printing intermediate information.</p>
<p>Returns:
    solution (int or tuple): The solution of the model.
        - If the model name is "GP", returns a tuple (solution, x) where solution is an array of integers representing
          the AFSCs assigned to cadets, and x is a 2D array representing the assignment matrix.
        - Otherwise, returns a tuple (solution, x, warm_start), where solution is an array of integers representing
          the AFSCs assigned to cadets, x is a 2D array representing the assignment matrix, and warm_start is a
          dictionary containing warm start variables used for initializing the VFT Pyomo model.</p>

            <details class="quote">
              <summary>Source code in <code>afccp/solutions/optimization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">solve_pyomo_model</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">printing</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve a Pyomo model using a specified solver.</span>

<span class="sd">    This function takes an instance, a Pyomo model, the model name, optional parameters (q), and a flag for printing</span>
<span class="sd">    intermediate information. It adjusts the solver settings based on the provided instance parameters, solves the</span>
<span class="sd">    model, and returns the solution.</span>

<span class="sd">    Args:</span>
<span class="sd">        instance: The Pyomo instance.</span>
<span class="sd">        model: The Pyomo model to solve.</span>
<span class="sd">        model_name (str): The name of the model.</span>
<span class="sd">        q (dict, optional): Optional parameters.</span>
<span class="sd">        printing (bool, optional): Flag for printing intermediate information.</span>

<span class="sd">    Returns:</span>
<span class="sd">        solution (int or tuple): The solution of the model.</span>
<span class="sd">            - If the model name is &quot;GP&quot;, returns a tuple (solution, x) where solution is an array of integers representing</span>
<span class="sd">              the AFSCs assigned to cadets, and x is a 2D array representing the assignment matrix.</span>
<span class="sd">            - Otherwise, returns a tuple (solution, x, warm_start), where solution is an array of integers representing</span>
<span class="sd">              the AFSCs assigned to cadets, x is a 2D array representing the assignment matrix, and warm_start is a</span>
<span class="sd">              dictionary containing warm start variables used for initializing the VFT Pyomo model.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Different parameters are needed based on the model</span>
    <span class="k">if</span> <span class="n">model_name</span> <span class="o">==</span> <span class="s1">&#39;Bubbles&#39;</span><span class="p">:</span>
        <span class="n">b</span><span class="p">,</span> <span class="n">mdl_p</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="n">instance</span><span class="o">.</span><span class="n">b</span>  <span class="c1"># It&#39;s weird, I know, but this works</span>
        <span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;solver_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="s1">&#39;b_solver_name&#39;</span><span class="p">]</span>  <span class="c1"># Change the solver</span>
        <span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;pyomo_max_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="s1">&#39;b_pyomo_max_time&#39;</span><span class="p">]</span>  <span class="c1"># Set the max time</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">gp</span><span class="p">,</span> <span class="n">mdl_p</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span> <span class="n">instance</span><span class="o">.</span><span class="n">value_parameters</span><span class="p">,</span> <span class="n">instance</span><span class="o">.</span><span class="n">gp_parameters</span><span class="p">,</span> <span class="n">instance</span><span class="o">.</span><span class="n">mdl_p</span>

        <span class="c1"># Adjust solver if necessary</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;approximate&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">model_name</span> <span class="o">==</span> <span class="s2">&quot;VFT&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;solver_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;cbc&#39;</span><span class="p">:</span>
                <span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;solver_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ipopt&#39;</span>

    <span class="c1"># Determine how the solver is called here</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="n">build_solver</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">mdl_p</span><span class="p">,</span> <span class="n">printing</span><span class="p">)</span>

    <span class="c1"># Solve Model</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">execute_solver</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">solver</span><span class="p">,</span> <span class="n">mdl_p</span><span class="p">)</span>
    <span class="n">solve_time</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="c1"># # Log infeasibility</span>
    <span class="c1"># if (results.solver.status != SolverStatus.ok) or (</span>
    <span class="c1">#         results.solver.termination_condition == TerminationCondition.infeasible):</span>
    <span class="c1">#     timestamp = datetime.datetime.now().strftime(&#39;%Y-%m-%d_%H-%M-%S&#39;)</span>
    <span class="c1">#     folder_path = f&quot;{instance.export_paths[&#39;Analysis &amp; Results&#39;]}infeasibility_logs {timestamp}&quot;</span>
    <span class="c1">#     handle_infeasible_model(model, results, output_dir=folder_path)</span>

    <span class="c1"># Goal Programming Model specific actions</span>
    <span class="k">if</span> <span class="n">model_name</span> <span class="o">==</span> <span class="s2">&quot;GP&quot;</span><span class="p">:</span>

        <span class="c1"># We&#39;re &quot;pre-process&quot; solving the model for a specific GP constraint</span>
        <span class="k">if</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;con_term&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">objective</span><span class="p">()</span>

        <span class="c1"># We&#39;re actually solving the model for a solution</span>
        <span class="k">else</span><span class="p">:</span>

            <span class="c1"># Get solution</span>
            <span class="n">solution</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;GP&quot;</span><span class="p">,</span> <span class="s2">&quot;j_array&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">gp</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">gp</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">],</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]))}</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;A^&#39;</span><span class="p">][</span><span class="s1">&#39;E&#39;</span><span class="p">][</span><span class="n">c</span><span class="p">]:</span>
                    <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">][</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                    <span class="k">if</span> <span class="nb">round</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">][</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">]):</span>
                        <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;j_array&#39;</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model solved.&#39;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">solution</span>

    <span class="c1"># &quot;Bubble Chart&quot; optimization model</span>
    <span class="k">elif</span> <span class="n">model_name</span> <span class="o">==</span> <span class="s1">&#39;Bubbles&#39;</span><span class="p">:</span>

        <span class="c1"># Get the values from the model and return them</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{},</span> <span class="n">model</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">value</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">b</span><span class="p">[</span><span class="s1">&#39;J^translated&#39;</span><span class="p">]:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="s1">&#39;J^translated&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
            <span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>

    <span class="c1"># VFT/Assignment Model specific actions</span>
    <span class="k">else</span><span class="p">:</span>

        <span class="c1"># Obtain solution from the model</span>
        <span class="k">def</span> <span class="nf">obtain_solution</span><span class="p">():</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            This nested function obtains the X matrix and the solution vector from the pyomo model</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="c1"># Get solution</span>
            <span class="n">solution</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="n">model_name</span><span class="p">,</span> <span class="s2">&quot;j_array&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">])),</span>
                        <span class="s1">&#39;solve_time&#39;</span><span class="p">:</span> <span class="n">solve_time</span><span class="p">,</span> <span class="s1">&#39;x_integer&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>

            <span class="c1"># Loop through each cadet to determine what AFSC they&#39;re assigned</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]:</span>
                <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^E&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
                    <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">round</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]):</span>
                            <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;j_array&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                            <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>

                        <span class="k">if</span> <span class="mf">0.01</span> <span class="o">&lt;</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.99</span><span class="p">:</span>
                            <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;x_integer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Solution didn&#39;t come out right, likely model is infeasible.&quot;</span><span class="p">)</span>

                <span class="c1"># For some reason we may not have assigned a cadet to an AFSC in which case we just give them to one</span>
                <span class="c1"># they&#39;re eligible for and want (happens usually to only 1-3 people through VFT model)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>

                    <span class="c1"># OTS candidates may go unmatched</span>
                    <span class="k">if</span> <span class="s1">&#39;I^OTS&#39;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I^OTS&#39;</span><span class="p">]:</span>
                            <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;j_array&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]</span>  <span class="c1"># Cadet assigned to &quot;unmatched&quot; AFSC!</span>
                            <span class="k">continue</span>

                    <span class="c1"># Try to give the cadet their top choice AFSC for which they&#39;re eligible</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;J^P&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">max_util</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="n">max_j</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;J^P&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
                            <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadet_utility&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">max_util</span><span class="p">:</span>
                                <span class="n">max_j</span> <span class="o">=</span> <span class="n">j</span>
                                <span class="n">max_util</span> <span class="o">=</span> <span class="n">max_util</span>
                        <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;j_array&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">max_j</span><span class="p">)</span>

                    <span class="c1"># If we don&#39;t have any eligible preferences from the cadet, they get Needs of the Air Force</span>
                    <span class="k">else</span><span class="p">:</span>

                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;J^E&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
                            <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;j_array&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;J^E&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;j_array&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;J^E&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

                    <span class="n">afsc</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;afscs&quot;</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;j_array&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])]</span>

                    <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cadet &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; was not assigned by the model for some reason. &quot;</span>
                                                  <span class="s2">&quot;We assigned them to&quot;</span><span class="p">,</span> <span class="n">afsc</span><span class="p">)</span>

            <span class="c1"># Get objective value</span>
            <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;pyomo_obj_value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">objective</span><span class="p">(),</span> <span class="mi">4</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">solution</span>

        <span class="c1"># Obtain base/training solution components from the model</span>
        <span class="k">def</span> <span class="nf">obtain_extra_solution_components</span><span class="p">(</span><span class="n">solution</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            This nested function obtains the base/training variable components from the pyomo model</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;b_array&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;c_array&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]])</span>
            <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;base_array&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]])</span>
            <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;course_array&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]])</span>
            <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">]))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;q&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">],</span> <span class="nb">max</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">])))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;cadet_value (Pyomo)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">])</span>
            <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;v_integer&#39;</span><span class="p">],</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;q_integer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span>

            <span class="c1"># Loop through each cadet to determine what base they&#39;re assigned to</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]:</span>
                <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;B^E&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
                    <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">round</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">b</span><span class="p">]):</span>
                            <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;b_array&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
                            <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>

                        <span class="k">if</span> <span class="mf">0.01</span> <span class="o">&lt;</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.99</span><span class="p">:</span>
                            <span class="n">warm_start</span><span class="p">[</span><span class="s1">&#39;v_integer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Solution didn&#39;t come out right, likely model is infeasible.&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
                    <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;base_array&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;bases&#39;</span><span class="p">][</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;b_array&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># Not matched to a base</span>
                    <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;base_array&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;b_array&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">]</span>

            <span class="c1"># Loop through each cadet to determine what course they&#39;re assigned to</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]:</span>
                <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^E&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
                    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;C^E&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]:</span>
                        <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;q&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="k">if</span> <span class="nb">round</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;q&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">c</span><span class="p">]):</span>
                                <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;c_array&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
                                <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>

                            <span class="k">if</span> <span class="mf">0.01</span> <span class="o">&lt;</span> <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;q&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.99</span><span class="p">:</span>
                                <span class="n">warm_start</span><span class="p">[</span><span class="s1">&#39;q_integer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Solution didn&#39;t come out right, likely model is infeasible.&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
                    <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;course_array&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;courses&#39;</span><span class="p">][</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;c_array&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;c_array&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># Not matched to a course</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cadet&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;not matched to a course for some reason. Something went wrong.&#39;</span><span class="p">)</span>

            <span class="c1"># Loop through each cadet to get their value from pyomo</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]:</span>
                <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;cadet_value (Pyomo)&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">cadet_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>

            <span class="k">return</span> <span class="n">solution</span>

        <span class="n">solution</span> <span class="o">=</span> <span class="n">obtain_solution</span><span class="p">()</span>

        <span class="c1"># Base/Training Model components</span>
        <span class="k">if</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;solve_extra_components&#39;</span><span class="p">]:</span>
            <span class="n">solution</span> <span class="o">=</span> <span class="n">obtain_extra_solution_components</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span>

        <span class="c1"># Obtain &quot;warm start&quot; variables used to initialize the VFT pyomo model</span>
        <span class="k">def</span> <span class="nf">obtain_warm_start_variables</span><span class="p">():</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            This nested function obtains the variables used for the warm start (variable initialization) of the pyomo model</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="c1"># Determine maximum number of breakpoints for any particular AFSC</span>
            <span class="n">max_r</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;J&quot;</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s2">&quot;K^A&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">q</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">max_r</span><span class="p">:</span>
                        <span class="n">max_r</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>

            <span class="c1"># Initialize dictionary</span>
            <span class="n">warm_start</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;f(measure)&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">],</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">]]),</span> <span class="s1">&#39;r^max&#39;</span><span class="p">:</span> <span class="n">max_r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                          <span class="s1">&#39;lambda&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">],</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">],</span> <span class="n">max_r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]),</span>
                          <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">],</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">],</span> <span class="n">max_r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="s1">&#39;obj&#39;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">objective</span><span class="p">(),</span>
                          <span class="s1">&#39;y_original&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">],</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">],</span> <span class="n">max_r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]),</span> <span class="s1">&#39;y_integer&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>

            <span class="c1"># Load warm start variables</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;K^A&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]:</span>
                    <span class="n">warm_start</span><span class="p">[</span><span class="s1">&#39;f(measure)&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">f_value</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]):</span>
                        <span class="n">warm_start</span><span class="p">[</span><span class="s1">&#39;lambda&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">lam</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                        <span class="k">if</span> <span class="n">l</span> <span class="o">&lt;</span> <span class="n">q</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">warm_start</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                            <span class="n">warm_start</span><span class="p">[</span><span class="s1">&#39;y_original&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                            <span class="k">if</span> <span class="mf">0.01</span> <span class="o">&lt;</span> <span class="n">warm_start</span><span class="p">[</span><span class="s1">&#39;y_original&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.99</span><span class="p">:</span>
                                <span class="n">warm_start</span><span class="p">[</span><span class="s1">&#39;y_integer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="c1"># Return the &quot;warm start&quot; dictionary</span>
            <span class="k">return</span> <span class="n">warm_start</span>

        <span class="c1"># Add additional components to solution dictionary</span>
        <span class="k">if</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;obtain_warm_start_variables&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="s1">&#39;VFT&#39;</span> <span class="ow">in</span> <span class="n">model_name</span><span class="p">:</span>
            <span class="n">warm_start</span> <span class="o">=</span> <span class="n">obtain_warm_start_variables</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">warm_start</span><span class="p">:</span>
                <span class="n">solution</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">warm_start</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
            <span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%B </span><span class="si">%d</span><span class="s1"> %Y </span><span class="si">%r</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model solved in </span><span class="si">{</span><span class="n">solve_time</span><span class="si">}</span><span class="s2"> seconds at </span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">. Pyomo reported objective value:&quot;</span><span class="p">,</span>
                  <span class="n">solution</span><span class="p">[</span><span class="s1">&#39;pyomo_obj_value&#39;</span><span class="p">])</span>

        <span class="c1"># Return solution dictionary</span>
        <span class="k">return</span> <span class="n">solution</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="solutions.optimization.execute_solver" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">execute_solver</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">solver</span><span class="p">,</span> <span class="n">mdl_p</span><span class="p">)</span></code>

<a href="#solutions.optimization.execute_solver" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Solves the Pyomo model with a progress bar if a time limit is specified.</p>
<p>Args:
    model (ConcreteModel): The Pyomo model to solve.
    solver (SolverFactory): The solver instance.
    mdl_p (dict): Dictionary of model parameters including solver config.</p>
<p>Returns:
    ConcreteModel: The solved model.</p>

            <details class="quote">
              <summary>Source code in <code>afccp/solutions/optimization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">execute_solver</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">solver</span><span class="p">,</span> <span class="n">mdl_p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solves the Pyomo model with a progress bar if a time limit is specified.</span>

<span class="sd">    Args:</span>
<span class="sd">        model (ConcreteModel): The Pyomo model to solve.</span>
<span class="sd">        solver (SolverFactory): The solver instance.</span>
<span class="sd">        mdl_p (dict): Dictionary of model parameters including solver config.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ConcreteModel: The solved model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">print_progress_bar</span><span class="p">(</span><span class="n">duration</span><span class="p">,</span> <span class="n">stop_event</span><span class="p">):</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">bar_length</span> <span class="o">=</span> <span class="mi">40</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">stop_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
            <span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
            <span class="n">percent</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">elapsed</span> <span class="o">/</span> <span class="n">duration</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">)</span>
            <span class="n">filled_len</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">bar_length</span> <span class="o">*</span> <span class="n">percent</span><span class="p">)</span>
            <span class="n">bar</span> <span class="o">=</span> <span class="s1">&#39;‚ñà&#39;</span> <span class="o">*</span> <span class="n">filled_len</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="p">(</span><span class="n">bar_length</span> <span class="o">-</span> <span class="n">filled_len</span><span class="p">)</span>
            <span class="n">eta</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">duration</span> <span class="o">-</span> <span class="n">elapsed</span><span class="p">)</span> <span class="k">if</span> <span class="n">elapsed</span> <span class="o">&lt;</span> <span class="n">duration</span> <span class="k">else</span> <span class="mi">1</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">‚è≥ Solver running: |</span><span class="si">{</span><span class="n">bar</span><span class="si">}</span><span class="s1">| </span><span class="si">{</span><span class="n">percent</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">5.1f</span><span class="si">}</span><span class="s1">% ETA: ~</span><span class="si">{</span><span class="n">eta</span><span class="si">}</span><span class="s1">s &#39;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">‚úÖ Solver complete: |</span><span class="si">{</span><span class="s2">&quot;‚ñà&quot;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">bar_length</span><span class="si">}</span><span class="s1">| 100.0%              </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="c1"># If time limit is set, start the timer bar</span>
    <span class="k">if</span> <span class="n">mdl_p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pyomo_max_time&quot;</span><span class="p">):</span>
        <span class="n">stop_event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
        <span class="n">target_time</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;pyomo_max_time&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.05</span><span class="p">,</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;pyomo_max_time&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">40</span><span class="p">))</span>
        <span class="n">thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">print_progress_bar</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">target_time</span><span class="p">,</span> <span class="n">stop_event</span><span class="p">))</span>
        <span class="n">thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="c1"># Solve Model</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;pyomo_max_time&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;solver_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;mindtpy&#39;</span><span class="p">:</span>
                <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;pyomo_max_time&quot;</span><span class="p">],</span> <span class="n">tee</span><span class="o">=</span><span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;pyomo_tee&#39;</span><span class="p">])</span>
                <span class="c1"># mip_solver=&#39;cplex_persistent&#39;, nlp_solver=&#39;ipopt&#39;)</span>
            <span class="k">elif</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;solver_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;gurobi&#39;</span><span class="p">:</span>
                <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;TimeLimit&#39;</span><span class="p">:</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;pyomo_max_time&quot;</span><span class="p">],</span>
                                             <span class="s1">&#39;IntFeasTol&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">},</span> <span class="n">tee</span><span class="o">=</span><span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;pyomo_tee&#39;</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;solver_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ipopt&#39;</span><span class="p">:</span>
                <span class="n">solver</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;max_cpu_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;pyomo_max_time&quot;</span><span class="p">]</span>
                <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">tee</span><span class="o">=</span><span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;pyomo_tee&#39;</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;solver_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;cbc&#39;</span><span class="p">:</span>
                <span class="n">solver</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;seconds&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;pyomo_max_time&quot;</span><span class="p">]</span>
                <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">tee</span><span class="o">=</span><span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;pyomo_tee&#39;</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;solver_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;baron&#39;</span><span class="p">:</span>
                <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;MaxTime&#39;</span><span class="p">:</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;pyomo_max_time&quot;</span><span class="p">]},</span> <span class="n">tee</span><span class="o">=</span><span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;pyomo_tee&#39;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">tee</span><span class="o">=</span><span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;pyomo_tee&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;solver_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;mindtpy&#39;</span><span class="p">:</span>
                <span class="n">model</span><span class="o">.</span><span class="n">pprint</span><span class="p">()</span>
                <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">mip_solver</span><span class="o">=</span><span class="s1">&#39;cplex_persistent&#39;</span><span class="p">,</span> <span class="n">nlp_solver</span><span class="o">=</span><span class="s1">&#39;ipopt&#39;</span><span class="p">,</span> <span class="n">tee</span><span class="o">=</span><span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;pyomo_tee&#39;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">tee</span><span class="o">=</span><span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;pyomo_tee&#39;</span><span class="p">])</span>

    <span class="k">finally</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">mdl_p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pyomo_max_time&quot;</span><span class="p">):</span>
            <span class="n">stop_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
            <span class="n">thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="solutions.optimization.vft_model_build" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vft_model_build</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">printing</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#solutions.optimization.vft_model_build" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Builds the VFT optimization model using pyomo.</p>
<p>Parameters:
    instance (object): Problem instance object.
    printing (bool): Whether the procedure should print something. Default is False.</p>
<p>Returns:
    object: Pyomo model object.</p>
<p>This function builds the VFT (Value Focused Thinking) optimization model using the Pyomo library. It takes a
problem instance as input and returns the constructed model.</p>
<p>The function performs the following steps:
1. Initializes the Pyomo model.
2. Adjusts certain parameters used in the model.
3. Defines and initializes the decision variables of the model.
4. Defines the objective function of the model.
5. Defines the constraints of the model.</p>
<p>Parameter Adjustments:
The function adjusts certain parameters related to the value function breakpoints and sets. These adjustments are
necessary to account for the approximate model's capability of exceeding the normal domain. The adjusted parameters
are stored in a new dictionary called 'q' for use in the model.</p>
<p>Variable Definitions:
The function defines the decision variables used in the model, including 'x' (main decision variable), 'f_value'
(AFSC objective value), 'lam' (lambda and y variables for value functions), and 'y' (binary variable for line
segments between breakpoints).</p>
<p>Variable Adjustments:
This function initializes the variables defined above if applicable (warm start has been determined) and fixes
certain 'x' variables if necessary/applicable.</p>
<p>Objective Function:
The objective function of the model is to maximize the overall weighted sum of all VFT objectives. It combines the
AFSC objective values and the cadet utility values based on their respective weights.</p>
<p>Constraints:
The function defines various constraints for the model, including the constraint that each cadet receives one and
only one AFSC, the 5% cap on the total percentage of USAFA cadets allowed into certain AFSCs, the value function
constraints linking the main methodology with the value function methodology, and optional decision-maker
constraints.</p>
<p>AFSC Objective Measure Constraints:
The function adds AFSC objective measure constraints for each AFSC and objective. It calculates the objective measure
components and adds linear value function constraints based on the measure and value functions.</p>
<p>AFSC Value Constraints:
Optional decision-maker constraints can be added to enforce minimum AFSC objective values. The function adds
constraints to ensure that the weighted sum of AFSC objective values meets the specified minimum value for each AFSC.</p>
<p>Cadet Value Constraints:
Optional decision-maker constraints can be added to enforce minimum cadet utility values. The function adds
constraints to ensure that the weighted sum of cadet utility values meets the specified minimum value for each cadet.</p>
<p>AFSCs Overall Min Value Constraint:
If a minimum overall value for AFSCs is specified, the function adds a constraint to ensure that the weighted sum of
AFSC objective values meets the specified minimum value for all AFSCs.</p>
<p>Note: The function assumes the availability of additional helper functions, such as 'add_objective_measure_constraint',
which are used to add specific types of constraints to the model.</p>

            <details class="quote">
              <summary>Source code in <code>afccp/solutions/optimization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">vft_model_build</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">printing</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Builds the VFT optimization model using pyomo.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        instance (object): Problem instance object.</span>
<span class="sd">        printing (bool): Whether the procedure should print something. Default is False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        object: Pyomo model object.</span>

<span class="sd">    This function builds the VFT (Value Focused Thinking) optimization model using the Pyomo library. It takes a</span>
<span class="sd">    problem instance as input and returns the constructed model.</span>

<span class="sd">    The function performs the following steps:</span>
<span class="sd">    1. Initializes the Pyomo model.</span>
<span class="sd">    2. Adjusts certain parameters used in the model.</span>
<span class="sd">    3. Defines and initializes the decision variables of the model.</span>
<span class="sd">    4. Defines the objective function of the model.</span>
<span class="sd">    5. Defines the constraints of the model.</span>

<span class="sd">    Parameter Adjustments:</span>
<span class="sd">    The function adjusts certain parameters related to the value function breakpoints and sets. These adjustments are</span>
<span class="sd">    necessary to account for the approximate model&#39;s capability of exceeding the normal domain. The adjusted parameters</span>
<span class="sd">    are stored in a new dictionary called &#39;q&#39; for use in the model.</span>

<span class="sd">    Variable Definitions:</span>
<span class="sd">    The function defines the decision variables used in the model, including &#39;x&#39; (main decision variable), &#39;f_value&#39;</span>
<span class="sd">    (AFSC objective value), &#39;lam&#39; (lambda and y variables for value functions), and &#39;y&#39; (binary variable for line</span>
<span class="sd">    segments between breakpoints).</span>

<span class="sd">    Variable Adjustments:</span>
<span class="sd">    This function initializes the variables defined above if applicable (warm start has been determined) and fixes</span>
<span class="sd">    certain &#39;x&#39; variables if necessary/applicable.</span>

<span class="sd">    Objective Function:</span>
<span class="sd">    The objective function of the model is to maximize the overall weighted sum of all VFT objectives. It combines the</span>
<span class="sd">    AFSC objective values and the cadet utility values based on their respective weights.</span>

<span class="sd">    Constraints:</span>
<span class="sd">    The function defines various constraints for the model, including the constraint that each cadet receives one and</span>
<span class="sd">    only one AFSC, the 5% cap on the total percentage of USAFA cadets allowed into certain AFSCs, the value function</span>
<span class="sd">    constraints linking the main methodology with the value function methodology, and optional decision-maker</span>
<span class="sd">    constraints.</span>

<span class="sd">    AFSC Objective Measure Constraints:</span>
<span class="sd">    The function adds AFSC objective measure constraints for each AFSC and objective. It calculates the objective measure</span>
<span class="sd">    components and adds linear value function constraints based on the measure and value functions.</span>

<span class="sd">    AFSC Value Constraints:</span>
<span class="sd">    Optional decision-maker constraints can be added to enforce minimum AFSC objective values. The function adds</span>
<span class="sd">    constraints to ensure that the weighted sum of AFSC objective values meets the specified minimum value for each AFSC.</span>

<span class="sd">    Cadet Value Constraints:</span>
<span class="sd">    Optional decision-maker constraints can be added to enforce minimum cadet utility values. The function adds</span>
<span class="sd">    constraints to ensure that the weighted sum of cadet utility values meets the specified minimum value for each cadet.</span>

<span class="sd">    AFSCs Overall Min Value Constraint:</span>
<span class="sd">    If a minimum overall value for AFSCs is specified, the function adds a constraint to ensure that the weighted sum of</span>
<span class="sd">    AFSC objective values meets the specified minimum value for all AFSCs.</span>

<span class="sd">    Note: The function assumes the availability of additional helper functions, such as &#39;add_objective_measure_constraint&#39;,</span>
<span class="sd">    which are used to add specific types of constraints to the model.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Building VFT Model...&#39;</span><span class="p">)</span>

    <span class="c1"># Build Model</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">ConcreteModel</span><span class="p">()</span>

    <span class="c1"># Shorthand</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">mdl_p</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span> <span class="n">instance</span><span class="o">.</span><span class="n">value_parameters</span><span class="p">,</span> <span class="n">instance</span><span class="o">.</span><span class="n">mdl_p</span>

    <span class="c1"># _________________________________PARAMETER ADJUSTMENTS_________________________________</span>
    <span class="k">def</span> <span class="nf">adjust_parameters</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function defined here to adjust certain parameters. The parameters adjusted here are the value function</span>
<span class="sd">        breakpoint parameters (r, a, f^hat) and set (L) as well as the AFSC objective constraint min, max values since</span>
<span class="sd">        they&#39;ve been stored as strings (3, 6, for example) up until this point. These parameters are saved into a new</span>
<span class="sd">        dictionary &quot;q&quot; for use in the model. This is done because the value function breakpoints need to be adjusted</span>
<span class="sd">        due to the approximate model&#39;s capability of exceeding the normal domain, and I don&#39;t want it saved to &quot;vp&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Written here, so I can reference it below (Keys &quot;r&quot; and &quot;L&quot; both use this)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="p">[[</span><span class="nb">len</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;K&#39;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]]</span>

        <span class="c1"># New dictionary of parameters used in this main function (&quot;vft_model_build&quot;) and in &quot;vft_model_solve&quot;</span>
        <span class="n">q</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="n">r</span><span class="p">,</span>  <span class="c1"># Number of breakpoints (bps) for objective k&#39;s function for AFSC j</span>
             <span class="s2">&quot;L&quot;</span><span class="p">:</span> <span class="p">[[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;K&#39;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]],</span>  <span class="c1"># Set of breakpoints</span>
             <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[[[</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">][</span><span class="n">l</span><span class="p">]</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;K&#39;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]],</span>  <span class="c1"># Measures of bps</span>
             <span class="s2">&quot;f^hat&quot;</span><span class="p">:</span> <span class="p">[[[</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;f^hat&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">][</span><span class="n">l</span><span class="p">]</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;K&#39;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span>
                       <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]]}</span>  <span class="c1"># Values of bps</span>

        <span class="c1"># Loop through each AFSC</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]:</span>

            <span class="c1"># Loop through each objective for each AFSC</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;K^A&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]:</span>

                <span class="c1"># We need to add an extra breakpoint to effectively extend the domain</span>
                <span class="k">if</span> <span class="n">instance</span><span class="o">.</span><span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;add_breakpoints&quot;</span><span class="p">]:</span>
                    <span class="c1"># We add an extra breakpoint far along the x-axis with the same y value as the previous one</span>
                    <span class="n">last_a</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">][</span><span class="n">q</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="n">last_f</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="s2">&quot;f^hat&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">][</span><span class="n">q</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="n">q</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">last_a</span> <span class="o">*</span> <span class="mi">2000</span><span class="p">)</span>  <span class="c1"># arbitrarily large number in the domain (x-space)</span>
                    <span class="n">q</span><span class="p">[</span><span class="s2">&quot;f^hat&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">last_f</span><span class="p">)</span>  <span class="c1"># same AFSC objective &quot;y-value&quot; as previous one</span>
                    <span class="n">q</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">])</span>  <span class="c1"># add the new breakpoint index</span>
                    <span class="n">q</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># increase number of breakpoints by 1</span>

        <span class="c1"># Convert to numpy arrays of lists</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;f^hat&quot;</span><span class="p">]:</span>
            <span class="n">q</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">q</span>  <span class="c1"># Return the new dictionary</span>

    <span class="n">q</span> <span class="o">=</span> <span class="n">adjust_parameters</span><span class="p">()</span>  <span class="c1"># Call the function</span>

    <span class="c1"># _________________________________VARIABLE DEFINITIONS_________________________________</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">common_optimization_handling</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">mdl_p</span><span class="p">)</span>  <span class="c1"># Define x along with additional functional constraints</span>
    <span class="n">m</span><span class="o">.</span><span class="n">f_value</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(((</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;K^A&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]),</span> <span class="n">within</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">)</span>  <span class="c1"># AFSC objective value</span>
    <span class="n">m</span><span class="o">.</span><span class="n">lam</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(((</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;K^A&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">q</span><span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]),</span>
                <span class="n">within</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># Lambda and y variables for value functions</span>
    <span class="n">m</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(((</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;K^A&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">within</span><span class="o">=</span><span class="n">Binary</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">variable_adjustments</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function initializes the 4 variables defined above if applicable (warm start has been determined) and also</span>
<span class="sd">        fixes certain x variables if necessary/applicable as well.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># If we initialize variables</span>
        <span class="k">if</span> <span class="n">instance</span><span class="o">.</span><span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;warm_start&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="c1"># For each cadet, for each AFSC that the cadet is eligible</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^E&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
                    <span class="c1"># x: 1 if we assign cadet i to AFSC j; 0 otherwise</span>
                    <span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;warm_start&quot;</span><span class="p">][</span><span class="s1">&#39;x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>

            <span class="c1"># Loop through each AFSC objective for each AFSC</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;K^A&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]:</span>

                    <span class="c1"># Value for AFSC j objective k  (Used in Constraint 20b in VFT thesis)</span>
                    <span class="n">m</span><span class="o">.</span><span class="n">f_value</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;warm_start&quot;</span><span class="p">][</span><span class="s1">&#39;f(measure)&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>

                    <span class="c1"># Loop through each breakpoint for this AFSC objective value function</span>
                    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">q</span><span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]:</span>

                        <span class="c1"># % between breakpoint l and l + 1 that the measure for AFSC j objective k &quot;has yet to travel&quot;</span>
                        <span class="n">m</span><span class="o">.</span><span class="n">lam</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;warm_start&quot;</span><span class="p">][</span><span class="s1">&#39;lambda&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span>

                        <span class="c1"># There is one less &quot;y&quot; variable than lambda because this is for the line segments between bps</span>
                        <span class="k">if</span> <span class="n">l</span> <span class="o">&lt;</span> <span class="n">q</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="c1"># 1 if AFSC j objective measure k is on line segment between breakpoints l and l + 1; 0 o/w</span>
                            <span class="n">m</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;warm_start&quot;</span><span class="p">][</span><span class="s1">&#39;y&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span>

        <span class="c1"># Return model (m)</span>
        <span class="k">return</span> <span class="n">m</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">variable_adjustments</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>  <span class="c1"># Call the function</span>

    <span class="c1"># _________________________________OBJECTIVE FUNCTION_________________________________</span>
    <span class="k">if</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;solve_extra_components&#39;</span><span class="p">]:</span>

        <span class="c1"># Base/Training model extra components</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">base_training_model_handling</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mdl_p</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">objective_function</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>  <span class="c1"># Z^VFT (w/base/training revision on cadet_value)</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            The objective function is to maximize &quot;Z&quot;, the overall weighted sum of all VFT objectives</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;afscs_overall_weight&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;afsc_weight&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
                <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objective_weight&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">f_value</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;K^A&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">])</span> <span class="o">+</span> \
                   <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;cadets_overall_weight&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;cadet_weight&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">cadet_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">])</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="c1"># AFSC-only objective function</span>
        <span class="k">def</span> <span class="nf">objective_function</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>  <span class="c1"># Z^VFT (Definition of variable in written formulation)</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            The objective function is to maximize &quot;Z&quot;, the overall weighted sum of all VFT objectives</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;afscs_overall_weight&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;afsc_weight&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
                <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objective_weight&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">f_value</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;K^A&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">])</span> <span class="o">+</span> \
                   <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;cadets_overall_weight&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;cadet_weight&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
                <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadet_utility&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^E&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">])</span>

    <span class="n">m</span><span class="o">.</span><span class="n">objective</span> <span class="o">=</span> <span class="n">Objective</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="n">objective_function</span><span class="p">,</span> <span class="n">sense</span><span class="o">=</span><span class="n">maximize</span><span class="p">)</span>

    <span class="c1"># ____________________________________CONSTRAINTS_____________________________________</span>
    <span class="k">pass</span>  <span class="c1"># Here so pycharm doesn&#39;t yell at me for the constraint line above</span>

    <span class="c1"># Value Function Constraints: Linking main methodology with value function methodology...</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">initialize_value_function_constraint_lists</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>  <span class="c1"># ...and then enforcing that methodology</span>

    <span class="c1"># AFSC Value Constraints (Optional decision-maker constraints)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">min_afsc_value_constraints</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>

    <span class="c1"># AFSC Objective Measure Constraints (Optional decision-maker constraints)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">measure_constraints</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>

    <span class="c1"># Loop through all AFSCs to add AFSC objective measure constraints</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]:</span>

        <span class="c1"># Loop through all AFSC objectives</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">objective</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objectives&#39;</span><span class="p">]):</span>

            <span class="c1"># Add AFSC objective measure value function &quot;functional&quot; constraints</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;K^A&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]:</span>

                <span class="c1"># Calculate AFSC objective measure components</span>
                <span class="n">measure</span><span class="p">,</span> <span class="n">numerator</span> <span class="o">=</span> <span class="n">afccp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">handling</span><span class="o">.</span><span class="n">calculate_objective_measure_matrix</span><span class="p">(</span>
                    <span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">objective</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">approximate</span><span class="o">=</span><span class="n">instance</span><span class="o">.</span><span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;approximate&#39;</span><span class="p">])</span>

                <span class="c1"># Add Value Function constraints (for functionality)</span>
                <span class="n">m</span> <span class="o">=</span> <span class="n">add_objective_value_function_constraints</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">measure</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">)</span>

                <span class="c1"># Add AFSC objective measure constraint</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;K^C&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]:</span>
                    <span class="n">m</span> <span class="o">=</span> <span class="n">add_objective_measure_constraint</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">measure</span><span class="p">,</span> <span class="n">numerator</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">)</span>

        <span class="c1"># AFSC value constraint</span>
        <span class="k">if</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;afsc_value_min&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">m</span><span class="o">.</span><span class="n">min_afsc_value_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
                <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objective_weight&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">f_value</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;K^A&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;afsc_value_min&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>

    <span class="c1"># AFSCs Overall Min Value</span>
    <span class="k">def</span> <span class="nf">afsc_min_value_constraint</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;afscs_overall_value_min&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;afsc_weight&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
            <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objective_weight&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">f_value</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;K^A&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;afscs_overall_value_min&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">m</span><span class="o">.</span><span class="n">afsc_min_value_constraint</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="n">afsc_min_value_constraint</span><span class="p">)</span>

    <span class="c1"># Cadets Overall Min Value</span>
    <span class="k">def</span> <span class="nf">cadet_min_value_constraint</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;cadets_overall_value_min&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;cadet_weight&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
            <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadet_utility&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^E&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;cadets_overall_value_min&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">m</span><span class="o">.</span><span class="n">cadet_min_value_constraint</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="n">cadet_min_value_constraint</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">m</span><span class="p">,</span> <span class="n">q</span>  <span class="c1"># Return model and additional component dictionary</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="solutions.optimization.initialize_value_function_constraint_lists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">initialize_value_function_constraint_lists</span><span class="p">(</span><span class="n">m</span><span class="p">)</span></code>

<a href="#solutions.optimization.initialize_value_function_constraint_lists" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Initialize constraint lists for the value function methodology.</p>
<p>This function sets up empty constraint lists in the Pyomo model to enforce the relationships
between the primary methodology and the value function methodology. These constraints
are used later when defining the value function constraints.</p>
<p>The constraint lists initialized correspond to the following formulations:</p>
<ul>
<li><code>measure_vf_constraints</code> (20a): Ensures the measure is computed using a weighted sum.</li>
<li><code>value_vf_constraints</code> (20b): Computes the value function as a weighted sum.</li>
<li><code>lambda_y_constraint1</code> (20c): Ensures the first lambda variable is bounded by y.</li>
<li><code>lambda_y_constraint2</code> (20d): Ensures intermediate lambda variables are bounded by y variables.</li>
<li><code>lambda_y_constraint3</code> (20e): Ensures the last lambda variable is bounded by y.</li>
<li><code>y_sum_constraint</code> (20f): Ensures the y variables sum to 1.</li>
<li><code>lambda_sum_constraint</code> (20g): Ensures the lambda variables sum to 1.</li>
<li><code>lambda_positive</code> (20h): Enforces non-negativity on lambda variables.</li>
<li><code>f_value_positive</code>: Enforces non-negativity on the AFSC objective value.</li>
</ul>
<p>Args:
    m (ConcreteModel): The Pyomo model to which the constraint lists will be added.</p>
<p>Returns:
    ConcreteModel: The updated Pyomo model with initialized constraint lists.</p>

            <details class="quote">
              <summary>Source code in <code>afccp/solutions/optimization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">initialize_value_function_constraint_lists</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize constraint lists for the value function methodology.</span>

<span class="sd">    This function sets up empty constraint lists in the Pyomo model to enforce the relationships</span>
<span class="sd">    between the primary methodology and the value function methodology. These constraints</span>
<span class="sd">    are used later when defining the value function constraints.</span>

<span class="sd">    The constraint lists initialized correspond to the following formulations:</span>

<span class="sd">    - `measure_vf_constraints` (20a): Ensures the measure is computed using a weighted sum.</span>
<span class="sd">    - `value_vf_constraints` (20b): Computes the value function as a weighted sum.</span>
<span class="sd">    - `lambda_y_constraint1` (20c): Ensures the first lambda variable is bounded by y.</span>
<span class="sd">    - `lambda_y_constraint2` (20d): Ensures intermediate lambda variables are bounded by y variables.</span>
<span class="sd">    - `lambda_y_constraint3` (20e): Ensures the last lambda variable is bounded by y.</span>
<span class="sd">    - `y_sum_constraint` (20f): Ensures the y variables sum to 1.</span>
<span class="sd">    - `lambda_sum_constraint` (20g): Ensures the lambda variables sum to 1.</span>
<span class="sd">    - `lambda_positive` (20h): Enforces non-negativity on lambda variables.</span>
<span class="sd">    - `f_value_positive`: Enforces non-negativity on the AFSC objective value.</span>

<span class="sd">    Args:</span>
<span class="sd">        m (ConcreteModel): The Pyomo model to which the constraint lists will be added.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ConcreteModel: The updated Pyomo model with initialized constraint lists.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Value Function Constraints: Linking main methodology with value function methodology</span>
    <span class="n">m</span><span class="o">.</span><span class="n">measure_vf_constraints</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>  <span class="c1"># 20a in Thesis</span>
    <span class="n">m</span><span class="o">.</span><span class="n">value_vf_constraints</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>  <span class="c1"># 20b in Thesis</span>

    <span class="c1"># Value Function Constraints: Functional constraints enforcing the relationship above</span>
    <span class="n">m</span><span class="o">.</span><span class="n">lambda_y_constraint1</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>  <span class="c1"># 20c in Thesis</span>
    <span class="n">m</span><span class="o">.</span><span class="n">lambda_y_constraint2</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>  <span class="c1"># 20d in Thesis</span>
    <span class="n">m</span><span class="o">.</span><span class="n">lambda_y_constraint3</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>  <span class="c1"># 20e in Thesis</span>
    <span class="n">m</span><span class="o">.</span><span class="n">y_sum_constraint</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>  <span class="c1"># 20f in Thesis</span>
    <span class="n">m</span><span class="o">.</span><span class="n">lambda_sum_constraint</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>  <span class="c1"># 20g in Thesis</span>
    <span class="n">m</span><span class="o">.</span><span class="n">lambda_positive</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>  <span class="c1"># Lambda domain (20h)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">f_value_positive</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>  <span class="c1"># AFSC objective value domain</span>

    <span class="c1"># Return updated model</span>
    <span class="k">return</span> <span class="n">m</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="solutions.optimization.add_objective_measure_constraint" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_objective_measure_constraint</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">measure</span><span class="p">,</span> <span class="n">numerator</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">)</span></code>

<a href="#solutions.optimization.add_objective_measure_constraint" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Add an objective measure constraint to the model.</p>
<p>This function takes the model (m), AFSC index (j), objective, objective measure, numerator of the function,
problem parameters (p), and value parameters (vp) as inputs. It adds a constraint to the constraint list of the model
based on the given objective measure.</p>
<p>For objectives related to the number of cadets (such as Combined Quota, USAFA Quota, ROTC Quota), the minimum and
maximum values of the measure are directly enforced.</p>
<p>For objectives with constrained approximate measures, the function checks whether the constrained minimum number
of cadets is lower than the Program Guidance Letter (PGL). If the constrained minimum is below the PGL, the
objective constraint is based on that minimum value, otherwise, it is based on the PGL target.</p>
<p>For objectives with constrained exact measures, the constraint is directly based on the minimum and maximum values
multiplied by the count of cadets for the AFSC. (Numerator / Count) -&gt; Objective Measure</p>
<p>Args:
    m (ConcreteModel): The Pyomo model to which the constraint will be added.
    j (int): The index of the AFSC.
    k (int): The index of the objective.
    measure (Expression): The objective measure.
    numerator (Expression): The numerator of the objective measure function.
    p (dict): The problem parameters.
    vp (dict): The value parameters.</p>
<p>Returns:
    ConcreteModel: The updated Pyomo model with the objective measure constraint added.</p>

            <details class="quote">
              <summary>Source code in <code>afccp/solutions/optimization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_objective_measure_constraint</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">measure</span><span class="p">,</span> <span class="n">numerator</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">vp</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add an objective measure constraint to the model.</span>

<span class="sd">    This function takes the model (m), AFSC index (j), objective, objective measure, numerator of the function,</span>
<span class="sd">    problem parameters (p), and value parameters (vp) as inputs. It adds a constraint to the constraint list of the model</span>
<span class="sd">    based on the given objective measure.</span>

<span class="sd">    For objectives related to the number of cadets (such as Combined Quota, USAFA Quota, ROTC Quota), the minimum and</span>
<span class="sd">    maximum values of the measure are directly enforced.</span>

<span class="sd">    For objectives with constrained approximate measures, the function checks whether the constrained minimum number</span>
<span class="sd">    of cadets is lower than the Program Guidance Letter (PGL). If the constrained minimum is below the PGL, the</span>
<span class="sd">    objective constraint is based on that minimum value, otherwise, it is based on the PGL target.</span>

<span class="sd">    For objectives with constrained exact measures, the constraint is directly based on the minimum and maximum values</span>
<span class="sd">    multiplied by the count of cadets for the AFSC. (Numerator / Count) -&gt; Objective Measure</span>

<span class="sd">    Args:</span>
<span class="sd">        m (ConcreteModel): The Pyomo model to which the constraint will be added.</span>
<span class="sd">        j (int): The index of the AFSC.</span>
<span class="sd">        k (int): The index of the objective.</span>
<span class="sd">        measure (Expression): The objective measure.</span>
<span class="sd">        numerator (Expression): The numerator of the objective measure function.</span>
<span class="sd">        p (dict): The problem parameters.</span>
<span class="sd">        vp (dict): The value parameters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ConcreteModel: The updated Pyomo model with the objective measure constraint added.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Get count variables for this AFSC</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I^E&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># &quot;Number of Cadets&quot; objectives handled separately</span>
        <span class="k">if</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objectives&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Combined Quota&#39;</span><span class="p">,</span> <span class="s1">&#39;USAFA Quota&#39;</span><span class="p">,</span> <span class="s1">&#39;ROTC Quota&#39;</span><span class="p">,</span> <span class="s1">&#39;OTS Quota&#39;</span><span class="p">]:</span>
            <span class="n">m</span><span class="o">.</span><span class="n">measure_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">measure</span> <span class="o">&gt;=</span> <span class="n">vp</span><span class="p">[</span><span class="s2">&quot;objective_min&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">])</span>
            <span class="n">m</span><span class="o">.</span><span class="n">measure_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">measure</span> <span class="o">&lt;=</span> <span class="n">vp</span><span class="p">[</span><span class="s2">&quot;objective_max&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">])</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Constrained Approximate Measure</span>
            <span class="k">if</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;constraint_type&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>

                <span class="c1"># Take the smallest value between the PGL and constrained minimum number for this constraint</span>
                <span class="n">m</span><span class="o">.</span><span class="n">measure_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
                    <span class="n">expr</span><span class="o">=</span><span class="n">numerator</span> <span class="o">-</span> <span class="n">vp</span><span class="p">[</span><span class="s2">&quot;objective_min&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="nb">min</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;pgl&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;quota_min&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">m</span><span class="o">.</span><span class="n">measure_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
                    <span class="n">expr</span><span class="o">=</span><span class="n">numerator</span> <span class="o">-</span> <span class="n">vp</span><span class="p">[</span><span class="s2">&quot;objective_max&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="nb">min</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;pgl&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;quota_min&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>

            <span class="c1"># Constrained Exact Measure</span>
            <span class="k">elif</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;constraint_type&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">m</span><span class="o">.</span><span class="n">measure_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">numerator</span> <span class="o">-</span> <span class="n">vp</span><span class="p">[</span><span class="s2">&quot;objective_min&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">count</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">m</span><span class="o">.</span><span class="n">measure_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">numerator</span> <span class="o">-</span> <span class="n">vp</span><span class="p">[</span><span class="s2">&quot;objective_max&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">count</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;AFSC &#39;&quot;</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;afscs&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;&#39; Objective &#39;&quot;</span> <span class="o">+</span> <span class="n">vp</span><span class="p">[</span><span class="s1">&#39;objectives&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; constraint failed to add.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exception:&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>

    <span class="c1"># Return updated model</span>
    <span class="k">return</span> <span class="n">m</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="solutions.optimization.add_objective_value_function_constraints" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_objective_value_function_constraints</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">measure</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span></code>

<a href="#solutions.optimization.add_objective_value_function_constraints" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Add linear value function constraints to the Pyomo model.</p>
<p>This function incorporates constraints related to the value function into the Pyomo optimization model.
These constraints ensure that the measure and value function constraints are properly enforced, the lambda
variables are bounded by y variables, and that summation and positivity constraints hold.</p>
<p>The constraints implemented correspond to the following formulations:</p>
<ul>
<li>Measure Constraint (20a): Ensures the measure is computed as a weighted sum of coefficients.</li>
<li>Value Function Constraint (20b): Computes the value function as a weighted sum of given parameters.</li>
<li>Lambda-Y Constraints (20c, 20d, 20e): Enforce relationships between lambda and y variables.</li>
<li>Y Summation Constraint (20f): Ensures the sum of y values equals 1.</li>
<li>Lambda Summation Constraint (20g): Ensures the sum of lambda values equals 1.</li>
<li>Lambda and Value Function Positivity Constraints (20h): Enforces non-negativity of lambda and the value function.</li>
</ul>
<p>Args:
    m (ConcreteModel): The Pyomo model to which the constraints will be added.
    j (int): The index representing the AFSC.
    k (int): The index representing the objective.
    measure (Expression): The measure variable in the value function.
    q (dict): A dictionary containing problem parameters, including:
        - 'a': Coefficients for the measure function.
        - 'f^hat': Coefficients for the value function.
        - 'L': Set of lambda indices.
        - 'r': The range parameter defining the number of lambda variables.</p>
<p>Returns:
    ConcreteModel: The updated Pyomo model with the value function constraints added.</p>

            <details class="quote">
              <summary>Source code in <code>afccp/solutions/optimization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_objective_value_function_constraints</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">measure</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add linear value function constraints to the Pyomo model.</span>

<span class="sd">    This function incorporates constraints related to the value function into the Pyomo optimization model.</span>
<span class="sd">    These constraints ensure that the measure and value function constraints are properly enforced, the lambda</span>
<span class="sd">    variables are bounded by y variables, and that summation and positivity constraints hold.</span>

<span class="sd">    The constraints implemented correspond to the following formulations:</span>

<span class="sd">    - Measure Constraint (20a): Ensures the measure is computed as a weighted sum of coefficients.</span>
<span class="sd">    - Value Function Constraint (20b): Computes the value function as a weighted sum of given parameters.</span>
<span class="sd">    - Lambda-Y Constraints (20c, 20d, 20e): Enforce relationships between lambda and y variables.</span>
<span class="sd">    - Y Summation Constraint (20f): Ensures the sum of y values equals 1.</span>
<span class="sd">    - Lambda Summation Constraint (20g): Ensures the sum of lambda values equals 1.</span>
<span class="sd">    - Lambda and Value Function Positivity Constraints (20h): Enforces non-negativity of lambda and the value function.</span>

<span class="sd">    Args:</span>
<span class="sd">        m (ConcreteModel): The Pyomo model to which the constraints will be added.</span>
<span class="sd">        j (int): The index representing the AFSC.</span>
<span class="sd">        k (int): The index representing the objective.</span>
<span class="sd">        measure (Expression): The measure variable in the value function.</span>
<span class="sd">        q (dict): A dictionary containing problem parameters, including:</span>
<span class="sd">            - &#39;a&#39;: Coefficients for the measure function.</span>
<span class="sd">            - &#39;f^hat&#39;: Coefficients for the value function.</span>
<span class="sd">            - &#39;L&#39;: Set of lambda indices.</span>
<span class="sd">            - &#39;r&#39;: The range parameter defining the number of lambda variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ConcreteModel: The updated Pyomo model with the value function constraints added.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Add Linear Value Function Constraints</span>
    <span class="n">m</span><span class="o">.</span><span class="n">measure_vf_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">measure</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>  <span class="c1"># Measure Constraint for Value Function (20a)</span>
        <span class="n">q</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">][</span><span class="n">l</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">lam</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">q</span><span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]))</span>
    <span class="n">m</span><span class="o">.</span><span class="n">value_vf_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">f_value</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>  <span class="c1"># Value Constraint for Value Function (20b)</span>
        <span class="n">q</span><span class="p">[</span><span class="s1">&#39;f^hat&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">][</span><span class="n">l</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">lam</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">q</span><span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]))</span>

    <span class="c1"># Lambda .. y constraints (20c, 20d, 20e)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">lambda_y_constraint1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">lam</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>  <span class="c1"># (20c)</span>
    <span class="k">if</span> <span class="n">q</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">m</span><span class="o">.</span><span class="n">lambda_y_constraint2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">lam</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">])</span>  <span class="c1"># (20d)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">lambda_y_constraint3</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">lam</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">q</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">q</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="p">])</span>  <span class="c1"># (20e)</span>

    <span class="c1"># Y sum to 1 constraint (20f)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">y_sum_constraint</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">q</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Lambda sum to 1 constraint (20g)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">lambda_sum_constraint</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">lam</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">q</span><span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Lambda .. value positive constraint (20h) although the &quot;f_value&quot; constraint is implied in the thesis</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">q</span><span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]:</span>
        <span class="n">m</span><span class="o">.</span><span class="n">lambda_positive</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">lam</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">f_value_positive</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">f_value</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Return updated model</span>
    <span class="k">return</span> <span class="n">m</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="solutions.optimization.base_training_model_handling" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">base_training_model_handling</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mdl_p</span><span class="p">)</span></code>

<a href="#solutions.optimization.base_training_model_handling" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Adds optimization model components to handle base and training (IST) assignments.</p>
<p>Parameters:
m (ConcreteModel): The Pyomo ConcreteModel instance to which the optimization model components will be added.
p (dict): A dictionary containing problem data, including cadet, base, course, utility, and weight information.
mdl_p (dict): A dictionary containing model-specific parameters and configurations.</p>
<p>Returns:
ConcreteModel: The modified Pyomo ConcreteModel instance with added optimization model components.</p>
<p>Notes:
- This function extends the given Pyomo ConcreteModel (m) by adding optimization model components to handle base and
  training (IST) assignments for cadets.
- The parameters are as follows:
    - m: The Pyomo ConcreteModel instance to be extended.
    - p: A dictionary containing various problem data, such as cadet information, base information, course
      information, utility values, and weight information.
    - mdl_p: A dictionary containing model-specific parameters and configurations.
- The added optimization model components include variables and constraints to handle cadet assignments to bases,
  courses, and values based on utility outcomes and constraints to ensure that assigned bases and courses do not
  exceed their capacities.
- Cadet assignments are modeled using binary variables (v and q), which represent assignments to bases and courses,
  respectively.
- Constraints are formulated to ensure cadet value calculations based on cadet states, base assignments, course
  assignments, and utility values.
- Additionally, constraints ensure that cadet assignments to bases and courses do not exceed base and course
  capacities.</p>
<p>Note: The given ConcreteModel (m) is modified in-place and returned for further use.</p>

            <details class="quote">
              <summary>Source code in <code>afccp/solutions/optimization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">base_training_model_handling</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mdl_p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds optimization model components to handle base and training (IST) assignments.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    m (ConcreteModel): The Pyomo ConcreteModel instance to which the optimization model components will be added.</span>
<span class="sd">    p (dict): A dictionary containing problem data, including cadet, base, course, utility, and weight information.</span>
<span class="sd">    mdl_p (dict): A dictionary containing model-specific parameters and configurations.</span>

<span class="sd">    Returns:</span>
<span class="sd">    ConcreteModel: The modified Pyomo ConcreteModel instance with added optimization model components.</span>

<span class="sd">    Notes:</span>
<span class="sd">    - This function extends the given Pyomo ConcreteModel (m) by adding optimization model components to handle base and</span>
<span class="sd">      training (IST) assignments for cadets.</span>
<span class="sd">    - The parameters are as follows:</span>
<span class="sd">        - m: The Pyomo ConcreteModel instance to be extended.</span>
<span class="sd">        - p: A dictionary containing various problem data, such as cadet information, base information, course</span>
<span class="sd">          information, utility values, and weight information.</span>
<span class="sd">        - mdl_p: A dictionary containing model-specific parameters and configurations.</span>
<span class="sd">    - The added optimization model components include variables and constraints to handle cadet assignments to bases,</span>
<span class="sd">      courses, and values based on utility outcomes and constraints to ensure that assigned bases and courses do not</span>
<span class="sd">      exceed their capacities.</span>
<span class="sd">    - Cadet assignments are modeled using binary variables (v and q), which represent assignments to bases and courses,</span>
<span class="sd">      respectively.</span>
<span class="sd">    - Constraints are formulated to ensure cadet value calculations based on cadet states, base assignments, course</span>
<span class="sd">      assignments, and utility values.</span>
<span class="sd">    - Additionally, constraints ensure that cadet assignments to bases and courses do not exceed base and course</span>
<span class="sd">      capacities.</span>

<span class="sd">    Note: The given ConcreteModel (m) is modified in-place and returned for further use.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Define the v and q-variables</span>
    <span class="n">m</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(((</span><span class="n">i</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;B^E&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]),</span> <span class="n">within</span><span class="o">=</span><span class="n">Binary</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">q</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^E&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;C^E&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]),</span> <span class="n">within</span><span class="o">=</span><span class="n">Binary</span><span class="p">)</span>

    <span class="c1"># Define the new cadet value variable</span>
    <span class="n">m</span><span class="o">.</span><span class="n">cadet_value</span> <span class="o">=</span> <span class="n">Var</span><span class="p">((</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]),</span> <span class="n">within</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="c1"># Cadet Value Constraints. Define what the &quot;cadet_value&quot; variable should be based on which &quot;state&quot; the cadet is in.</span>
    <span class="n">m</span><span class="o">.</span><span class="n">bc_cadet_value_constraints</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>

            <span class="c1"># Calculate auxiliary variables for AFSC, base, course utility outcomes</span>
            <span class="n">u</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;u^S&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">d</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;cadet_utility&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^State&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">d</span><span class="p">]),</span>
                <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
                    <span class="n">p</span><span class="p">[</span><span class="s1">&#39;course_utility&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;C^E&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^State&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">d</span><span class="p">])</span>
            <span class="p">}</span>

            <span class="c1"># Weighted sum of cadet utilities in each area depends on if bases are involved</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;B^State&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">d</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">u</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;base_utility&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;B^State&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">d</span><span class="p">])</span>
                <span class="n">weighted_sum</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;w^A&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">d</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;w^B&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">d</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;w^C&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">d</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">weighted_sum</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;w^A&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">d</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;w^C&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">d</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>

            <span class="c1"># This is the base/course state cadet value constraint. It ensures cadet_value will be the right value</span>
            <span class="n">m</span><span class="o">.</span><span class="n">bc_cadet_value_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">cadet_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;u^S&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">d</span><span class="p">]</span> <span class="o">*</span> <span class="n">weighted_sum</span> <span class="o">+</span>
                                                  <span class="n">mdl_p</span><span class="p">[</span><span class="s1">&#39;BIG M&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^State&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">d</span><span class="p">])))</span>

    <span class="c1"># Cadet Base Constraints. If a cadet is assigned to a base, it has to be one that the AFSC is located at</span>
    <span class="n">m</span><span class="o">.</span><span class="n">bc_cadet_base_constraints</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]:</span>
        <span class="n">m</span><span class="o">.</span><span class="n">bc_cadet_base_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;B^E&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span>
                                             <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^E&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^B&#39;</span><span class="p">])))</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^B&#39;</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^E&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]):</span>
            <span class="n">m</span><span class="o">.</span><span class="n">bc_cadet_base_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;B^A&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]))</span>

    <span class="c1"># Cadet Course Constraints. Cadets have to be assigned to a course for their designated AFSC</span>
    <span class="n">m</span><span class="o">.</span><span class="n">bc_cadet_course_constraints</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^E&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">m</span><span class="o">.</span><span class="n">bc_cadet_course_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;C^E&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]))</span>

    <span class="c1"># Base Capacity Constraints. A base/AFSC pair cannot exceed its capacity</span>
    <span class="n">m</span><span class="o">.</span><span class="n">bc_base_capacity_constraints</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J^B&#39;</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;B^A&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]:</span>
            <span class="n">m</span><span class="o">.</span><span class="n">bc_base_capacity_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I^E&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;hi^B&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">b</span><span class="p">])</span>
            <span class="n">m</span><span class="o">.</span><span class="n">bc_base_capacity_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I^E&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;lo^B&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">b</span><span class="p">])</span>

    <span class="c1"># Course Capacity Constraints. A course/AFSC pair cannot exceed its capacity</span>
    <span class="n">m</span><span class="o">.</span><span class="n">bc_course_capacity_constraints</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]:</span>
            <span class="n">m</span><span class="o">.</span><span class="n">bc_course_capacity_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I^A&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">c</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;hi^C&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">c</span><span class="p">])</span>
            <span class="n">m</span><span class="o">.</span><span class="n">bc_course_capacity_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;I^A&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">c</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;lo^C&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">c</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">m</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="solutions.optimization.bubble_chart_configuration_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bubble_chart_configuration_model</span><span class="p">(</span><span class="n">b</span><span class="p">)</span></code>

<a href="#solutions.optimization.bubble_chart_configuration_model" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Builds a Pyomo optimization model to determine the x and y coordinates of AFSC squares on a chart.</p>
<h4 id="solutions.optimization.bubble_chart_configuration_model--parameters">Parameters:<a class="headerlink" href="#solutions.optimization.bubble_chart_configuration_model--parameters" title="Permanent link">&para;</a></h4>
<p>b : dict
    A dictionary containing configuration parameters for the model.
    The dictionary should include the following key-value pairs:
    - 'n^sorted' : numpy array
        Sorted values of the AFSC sizes (cadet box sizes).
    - 'M' : int
        The number of AFSCs (cadet boxes).
    - 'add_legend' : bool
        Whether to include a legend box in the chart.
    - 'simplified_model' : bool
        Whether to use a simplified model without positional constraints.
    - 'row_constraint' : bool
        Whether to incorporate a row constraint for AFSCs.
    - Additional bounds and constants used in the model.</p>
<h4 id="solutions.optimization.bubble_chart_configuration_model--returns">Returns:<a class="headerlink" href="#solutions.optimization.bubble_chart_configuration_model--returns" title="Permanent link">&para;</a></h4>
<p>m : ConcreteModel
    The constructed Pyomo ConcreteModel instance representing the optimization model.</p>
<h4 id="solutions.optimization.bubble_chart_configuration_model--notes">Notes:<a class="headerlink" href="#solutions.optimization.bubble_chart_configuration_model--notes" title="Permanent link">&para;</a></h4>
<p>This function creates an optimization model to determine the x and y coordinates of AFSC squares (cadet boxes)
on a chart. The objective is to maximize the size of the cadet boxes, which are represented by the variable 'm.s'.
The model seeks to find an optimal placement of the AFSC squares while satisfying various constraints.
The specific constraints and objective function formulation depend on the configuration parameters provided in the 'b' dictionary.</p>
<p>The function defines decision variables for the AFSC sizes ('m.s') and the x and y coordinates of each AFSC square ('m.x' and 'm.y').
Depending on the configuration parameters, additional variables for the legend box and positional relationships between AFSCs may be included.</p>
<p>Constraints are added to ensure that the AFSC squares stay within the chart borders, avoid overlapping with the legend box (if present),
and meet any specified row constraints. The constraints vary based on whether the simplified model or the full model with positional
relationships between AFSCs is used.</p>
<p>The objective function aims to maximize the size of the cadet boxes ('m.s'), representing the objective of maximizing the visual prominence
of each AFSC on the chart.</p>

            <details class="quote">
              <summary>Source code in <code>afccp/solutions/optimization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">bubble_chart_configuration_model</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Builds a Pyomo optimization model to determine the x and y coordinates of AFSC squares on a chart.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    b : dict</span>
<span class="sd">        A dictionary containing configuration parameters for the model.</span>
<span class="sd">        The dictionary should include the following key-value pairs:</span>
<span class="sd">        - &#39;n^sorted&#39; : numpy array</span>
<span class="sd">            Sorted values of the AFSC sizes (cadet box sizes).</span>
<span class="sd">        - &#39;M&#39; : int</span>
<span class="sd">            The number of AFSCs (cadet boxes).</span>
<span class="sd">        - &#39;add_legend&#39; : bool</span>
<span class="sd">            Whether to include a legend box in the chart.</span>
<span class="sd">        - &#39;simplified_model&#39; : bool</span>
<span class="sd">            Whether to use a simplified model without positional constraints.</span>
<span class="sd">        - &#39;row_constraint&#39; : bool</span>
<span class="sd">            Whether to incorporate a row constraint for AFSCs.</span>
<span class="sd">        - Additional bounds and constants used in the model.</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    m : ConcreteModel</span>
<span class="sd">        The constructed Pyomo ConcreteModel instance representing the optimization model.</span>

<span class="sd">    Notes:</span>
<span class="sd">    ------</span>
<span class="sd">    This function creates an optimization model to determine the x and y coordinates of AFSC squares (cadet boxes)</span>
<span class="sd">    on a chart. The objective is to maximize the size of the cadet boxes, which are represented by the variable &#39;m.s&#39;.</span>
<span class="sd">    The model seeks to find an optimal placement of the AFSC squares while satisfying various constraints.</span>
<span class="sd">    The specific constraints and objective function formulation depend on the configuration parameters provided in the &#39;b&#39; dictionary.</span>

<span class="sd">    The function defines decision variables for the AFSC sizes (&#39;m.s&#39;) and the x and y coordinates of each AFSC square (&#39;m.x&#39; and &#39;m.y&#39;).</span>
<span class="sd">    Depending on the configuration parameters, additional variables for the legend box and positional relationships between AFSCs may be included.</span>

<span class="sd">    Constraints are added to ensure that the AFSC squares stay within the chart borders, avoid overlapping with the legend box (if present),</span>
<span class="sd">    and meet any specified row constraints. The constraints vary based on whether the simplified model or the full model with positional</span>
<span class="sd">    relationships between AFSCs is used.</span>

<span class="sd">    The objective function aims to maximize the size of the cadet boxes (&#39;m.s&#39;), representing the objective of maximizing the visual prominence</span>
<span class="sd">    of each AFSC on the chart.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Initialize Model</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">ConcreteModel</span><span class="p">()</span>  <span class="c1"># Concrete model allows native numpy/python objects</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="s1">&#39;n^sorted&#39;</span><span class="p">]</span>  <span class="c1"># Number of squares on edge of AFSC box (use sorted AFSCs)</span>
    <span class="n">J</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">])</span>  <span class="c1"># Use sorted AFSCs!</span>
    <span class="n">M</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>

    <span class="c1"># ______________________________VARIABLE DEFINITIONS________________________________________________________</span>
    <span class="n">m</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">within</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">)</span>  <span class="c1"># Size of the cadet boxes (AFSC objective value)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">Var</span><span class="p">((</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">J</span><span class="p">),</span> <span class="n">within</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">)</span>  <span class="c1"># X coordinate of bottom left corner of AFSC j box</span>
    <span class="n">m</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">Var</span><span class="p">((</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">J</span><span class="p">),</span> <span class="n">within</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">)</span>  <span class="c1"># Y coordinate of bottom left corner of AFSC j box</span>
    <span class="n">m</span><span class="o">.</span><span class="n">q</span> <span class="o">=</span> <span class="n">Var</span><span class="p">((</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">M</span><span class="p">)),</span> <span class="n">within</span><span class="o">=</span><span class="n">Binary</span><span class="p">)</span>  <span class="c1"># 1 if AFSC j is below AFSC j - 1, 0 otherwise</span>

    <span class="c1"># ______________________________OBJECTIVE FUNCTION__________________________________________________________</span>
    <span class="k">def</span> <span class="nf">objective_function</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="n">s</span>  <span class="c1"># Objective is to maximize the size of the cadet boxes!</span>

    <span class="n">m</span><span class="o">.</span><span class="n">objective</span> <span class="o">=</span> <span class="n">Objective</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="n">objective_function</span><span class="p">,</span> <span class="n">sense</span><span class="o">=</span><span class="n">maximize</span><span class="p">)</span>

    <span class="c1"># ____________________________________CONSTRAINTS___________________________________________________________</span>
    <span class="c1"># Loop through each AFSC to add the border constraints</span>
    <span class="n">m</span><span class="o">.</span><span class="n">border_constraints</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>  <span class="c1"># List of constraints that enforce AFSCs to stay within the borders</span>
    <span class="n">m</span><span class="o">.</span><span class="n">border_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">[</span><span class="s1">&#39;bw^l&#39;</span><span class="p">])</span>  <span class="c1"># Pin the first AFSC to the left</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">J</span><span class="p">:</span>
        <span class="n">m</span><span class="o">.</span><span class="n">border_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">b</span><span class="p">[</span><span class="s1">&#39;bw^l&#39;</span><span class="p">])</span>  <span class="c1"># Left Border</span>
        <span class="n">m</span><span class="o">.</span><span class="n">border_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">s</span> <span class="o">*</span> <span class="n">n</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">[</span><span class="s1">&#39;fw&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="s1">&#39;bw^r&#39;</span><span class="p">])</span>  <span class="c1"># Right Border</span>
        <span class="n">m</span><span class="o">.</span><span class="n">border_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">b</span><span class="p">[</span><span class="s1">&#39;bw^b&#39;</span><span class="p">])</span>  <span class="c1"># Bottom Border</span>
        <span class="n">m</span><span class="o">.</span><span class="n">border_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">s</span> <span class="o">*</span> <span class="n">n</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">[</span><span class="s1">&#39;fh&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="s1">&#39;bw^t&#39;</span><span class="p">])</span>  <span class="c1"># Top Border</span>

    <span class="c1"># Loop through each AFSC (after the first one) to add the grid constraints</span>
    <span class="n">m</span><span class="o">.</span><span class="n">grid_constraints</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>  <span class="c1"># List of constraints that line up AFSCs in a nice grid</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">M</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">grid_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">s</span> <span class="o">*</span> <span class="n">n</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="s1">&#39;abw^ud&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">q</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="n">m</span><span class="o">.</span><span class="n">grid_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">m</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">m</span><span class="o">.</span><span class="n">q</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
        <span class="n">m</span><span class="o">.</span><span class="n">grid_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">s</span> <span class="o">*</span> <span class="n">n</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="s1">&#39;abw^lr&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">m</span><span class="o">.</span><span class="n">q</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
        <span class="n">m</span><span class="o">.</span><span class="n">grid_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">[</span><span class="s1">&#39;bw^l&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">q</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span>
                                    <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">s</span> <span class="o">*</span> <span class="n">n</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="s1">&#39;abw^lr&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">m</span><span class="o">.</span><span class="n">q</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">m</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="solutions.optimization.gp_model_build" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">gp_model_build</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">printing</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#solutions.optimization.gp_model_build" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Builds Rebecca's goal programming (GP) model using the provided problem instance.</p>
<p>Args:
    instance (object): The problem instance to solve.
    printing (bool, optional): Specifies whether to print status updates during model building. Default is False.</p>
<p>Returns:
    pyomo.core.base.PyomoModel.ConcreteModel: The constructed Pyomo model.</p>
<p>Raises:
    None</p>
<p>Detailed Description:
    This function builds the GP model according to Rebecca's goal programming formulation using the provided problem instance.
    The model incorporates Rebecca's parameters and constructs the necessary variables, objective function, and constraints.</p>
<div class="highlight"><pre><span></span><code>The function iterates over each constraint and AFSC to create the decision variables, penalty variables, and reward variables.
It defines the main objective function that represents the overall goal programming problem.
Additionally, it defines penalty and reward specific objective functions to obtain raw penalties and rewards.

The function also constructs various constraints related to AFSC assignments, penalty terms, and reward terms.
</code></pre></div>
<p>Parameter Details:
    - instance (object): The problem instance to solve. It should contain the following attributes:
        - gp_parameters (dict): The GP parameters, including the constraint terms, utility values, and sets.
        - mdl_p (dict): Additional model parameters, including the current constraint term and the reward/penalty flag.
    - printing (bool, optional): Specifies whether to print status updates during model building. Default is False.</p>
<p>Returns:
    - model (pyomo.core.base.PyomoModel.ConcreteModel): The constructed Pyomo model representing the GP problem.</p>
<p>Note:
    The function assumes that the necessary libraries and packages (such as NumPy) are imported.</p>

            <details class="quote">
              <summary>Source code in <code>afccp/solutions/optimization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">gp_model_build</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">printing</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Builds Rebecca&#39;s goal programming (GP) model using the provided problem instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        instance (object): The problem instance to solve.</span>
<span class="sd">        printing (bool, optional): Specifies whether to print status updates during model building. Default is False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pyomo.core.base.PyomoModel.ConcreteModel: The constructed Pyomo model.</span>

<span class="sd">    Raises:</span>
<span class="sd">        None</span>

<span class="sd">    Detailed Description:</span>
<span class="sd">        This function builds the GP model according to Rebecca&#39;s goal programming formulation using the provided problem instance.</span>
<span class="sd">        The model incorporates Rebecca&#39;s parameters and constructs the necessary variables, objective function, and constraints.</span>

<span class="sd">        The function iterates over each constraint and AFSC to create the decision variables, penalty variables, and reward variables.</span>
<span class="sd">        It defines the main objective function that represents the overall goal programming problem.</span>
<span class="sd">        Additionally, it defines penalty and reward specific objective functions to obtain raw penalties and rewards.</span>

<span class="sd">        The function also constructs various constraints related to AFSC assignments, penalty terms, and reward terms.</span>

<span class="sd">    Parameter Details:</span>
<span class="sd">        - instance (object): The problem instance to solve. It should contain the following attributes:</span>
<span class="sd">            - gp_parameters (dict): The GP parameters, including the constraint terms, utility values, and sets.</span>
<span class="sd">            - mdl_p (dict): Additional model parameters, including the current constraint term and the reward/penalty flag.</span>
<span class="sd">        - printing (bool, optional): Specifies whether to print status updates during model building. Default is False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        - model (pyomo.core.base.PyomoModel.ConcreteModel): The constructed Pyomo model representing the GP problem.</span>

<span class="sd">    Note:</span>
<span class="sd">        The function assumes that the necessary libraries and packages (such as NumPy) are imported.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Building GP Model...&#39;</span><span class="p">)</span>

    <span class="c1"># Shorthand</span>
    <span class="n">gp</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">gp_parameters</span>
    <span class="n">mdl_p</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">mdl_p</span>

    <span class="c1"># Create model</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">ConcreteModel</span><span class="p">()</span>

    <span class="c1"># ___________________________________VARIABLE DEFINITIONS_________________________________</span>
    <span class="n">m</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(((</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;A^&#39;</span><span class="p">][</span><span class="s1">&#39;E&#39;</span><span class="p">][</span><span class="n">c</span><span class="p">]),</span> <span class="n">within</span><span class="o">=</span><span class="n">Binary</span><span class="p">)</span>

    <span class="c1"># Amount by which the constraint is not met</span>
    <span class="n">m</span><span class="o">.</span><span class="n">Y</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(((</span><span class="n">con</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">con</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;con&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;A^&#39;</span><span class="p">][</span><span class="n">con</span><span class="p">]),</span> <span class="n">within</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">)</span>

    <span class="c1"># Amount by which the constraint is exceeded</span>
    <span class="n">m</span><span class="o">.</span><span class="n">Z</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(((</span><span class="n">con</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">con</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;con&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;A^&#39;</span><span class="p">][</span><span class="n">con</span><span class="p">]),</span> <span class="n">within</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">)</span>

    <span class="c1"># Binary variable indicating if Y is used (1) or if Z is used (0)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(((</span><span class="n">con</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">con</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;con&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;A^&#39;</span><span class="p">][</span><span class="n">con</span><span class="p">]),</span> <span class="n">within</span><span class="o">=</span><span class="n">Binary</span><span class="p">)</span>

    <span class="c1"># ___________________________________OBJECTIVE FUNCTION___________________________________</span>
    <span class="k">def</span> <span class="nf">main_objective_function</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>  <span class="c1"># Sum across each constraint</span>
            <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>  <span class="c1"># Sum across each AFSC with that constraint</span>

                <span class="c1"># Calculate penalties and rewards for each necessary AFSC</span>
                <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;lam^&#39;</span><span class="p">][</span><span class="n">con</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">Z</span><span class="p">[</span><span class="n">con</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">-</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;mu^&#39;</span><span class="p">][</span><span class="n">con</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="n">con</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;A^&#39;</span><span class="p">][</span><span class="n">con</span><span class="p">])</span> <span class="k">for</span> <span class="n">con</span> <span class="ow">in</span>
            <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;con&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;lam^&#39;</span><span class="p">][</span><span class="s1">&#39;S&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>  <span class="c1"># Sum across every cadet</span>
            <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>  <span class="c1"># Sum across each AFSC that the cadet is both eligible for and has placed a preference on</span>

                <span class="c1"># Calculate utility that the cadet received  (for each preferred AFSC for each constraint)</span>
                <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;utility&#39;</span><span class="p">][</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;A^&#39;</span><span class="p">][</span><span class="s1">&#39;W^E&#39;</span><span class="p">][</span><span class="n">c</span><span class="p">])</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">penalty_objective_function</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;con_term&quot;</span><span class="p">],</span> <span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;A^&#39;</span><span class="p">][</span><span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;con_term&quot;</span><span class="p">]])</span>

    <span class="k">def</span> <span class="nf">reward_objective_function</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;con_term&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;S&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">gp</span><span class="p">[</span><span class="s1">&#39;utility&#39;</span><span class="p">][</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;A^&#39;</span><span class="p">][</span><span class="s1">&#39;W^E&#39;</span><span class="p">][</span><span class="n">c</span><span class="p">])</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">Z</span><span class="p">[</span><span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;con_term&quot;</span><span class="p">],</span> <span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;A^&#39;</span><span class="p">][</span><span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;con_term&quot;</span><span class="p">]])</span>

    <span class="c1"># Define model objective function</span>
    <span class="k">if</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;con_term&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Reward/Penalty specific objective function to get raw rewards/penalties</span>
        <span class="k">if</span> <span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;get_reward&quot;</span><span class="p">]:</span>
            <span class="n">m</span><span class="o">.</span><span class="n">objective</span> <span class="o">=</span> <span class="n">Objective</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="n">reward_objective_function</span><span class="p">,</span> <span class="n">sense</span><span class="o">=</span><span class="n">maximize</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">m</span><span class="o">.</span><span class="n">objective</span> <span class="o">=</span> <span class="n">Objective</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="n">penalty_objective_function</span><span class="p">,</span> <span class="n">sense</span><span class="o">=</span><span class="n">maximize</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># Regular objective function</span>
        <span class="n">m</span><span class="o">.</span><span class="n">objective</span> <span class="o">=</span> <span class="n">Objective</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="n">main_objective_function</span><span class="p">,</span> <span class="n">sense</span><span class="o">=</span><span class="n">maximize</span><span class="p">)</span>

    <span class="c1"># ___________________________________CONSTRAINTS______________________________________</span>
    <span class="k">pass</span>

    <span class="c1"># Each Cadet gets one AFSC for which they&#39;re eligible</span>
    <span class="n">m</span><span class="o">.</span><span class="n">one_afsc_constraints</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]:</span>
        <span class="n">m</span><span class="o">.</span><span class="n">one_afsc_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;A^&#39;</span><span class="p">][</span><span class="s1">&#39;E&#39;</span><span class="p">][</span><span class="n">c</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">m</span><span class="o">.</span><span class="n">con_constraints</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>  <span class="c1"># List of goal constraints (Each goal constraint for each AFSC)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">Y_constraints</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>  <span class="c1"># List of Y/alpha constraints</span>
    <span class="n">m</span><span class="o">.</span><span class="n">Z_constraints</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>  <span class="c1"># List of Z/alpha constraints</span>

    <span class="c1"># Loop through each &quot;goal&quot; constraint</span>
    <span class="k">for</span> <span class="n">con</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;con&#39;</span><span class="p">]:</span>

        <span class="c1"># Loop through all AFSCs for this constraint</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;A^&#39;</span><span class="p">][</span><span class="n">con</span><span class="p">]:</span>

            <span class="c1"># Number of cadets assigned to this AFSC</span>
            <span class="n">count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;C^&#39;</span><span class="p">][</span><span class="s1">&#39;E&#39;</span><span class="p">][</span><span class="n">a</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">con</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;R_under&#39;</span><span class="p">,</span> <span class="s1">&#39;R_over&#39;</span><span class="p">]:</span>

                <span class="c1"># Sum of percentiles of cadets assigned to this AFSC</span>
                <span class="n">con_count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">gp</span><span class="p">[</span><span class="s1">&#39;merit&#39;</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;C^&#39;</span><span class="p">][</span><span class="n">con</span><span class="p">][</span><span class="n">a</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>

                <span class="c1"># Number of cadets assigned to this AFSC that pertain to this constraint</span>
                <span class="n">con_count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;C^&#39;</span><span class="p">][</span><span class="n">con</span><span class="p">][</span><span class="n">a</span><span class="p">])</span>

            <span class="c1"># Parameter for this constraint for this AFSC</span>
            <span class="n">parameter</span> <span class="o">=</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;param&#39;</span><span class="p">][</span><span class="n">con</span><span class="p">][</span><span class="n">a</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">con</span> <span class="o">==</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span>
                <span class="n">m</span><span class="o">.</span><span class="n">con_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">count</span> <span class="o">==</span> <span class="n">parameter</span> <span class="o">-</span> <span class="n">m</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="n">con</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">Z</span><span class="p">[</span><span class="n">con</span><span class="p">,</span> <span class="n">a</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">con</span> <span class="o">==</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span>
                <span class="n">m</span><span class="o">.</span><span class="n">con_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">count</span> <span class="o">==</span> <span class="n">parameter</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="n">con</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">-</span> <span class="n">m</span><span class="o">.</span><span class="n">Z</span><span class="p">[</span><span class="n">con</span><span class="p">,</span> <span class="n">a</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">con</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;D_under&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;U_under&#39;</span><span class="p">,</span> <span class="s1">&#39;R_under&#39;</span><span class="p">]:</span>
                <span class="n">m</span><span class="o">.</span><span class="n">con_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">con_count</span> <span class="o">==</span> <span class="n">parameter</span> <span class="o">*</span> <span class="n">count</span> <span class="o">-</span> <span class="n">m</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="n">con</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">Z</span><span class="p">[</span><span class="n">con</span><span class="p">,</span> <span class="n">a</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># (&#39;D_over&#39;, &#39;P&#39;, &#39;U_over&#39;, &#39;R_over&#39;)</span>
                <span class="n">m</span><span class="o">.</span><span class="n">con_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">con_count</span> <span class="o">==</span> <span class="n">parameter</span> <span class="o">*</span> <span class="n">count</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="n">con</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">-</span> <span class="n">m</span><span class="o">.</span><span class="n">Z</span><span class="p">[</span><span class="n">con</span><span class="p">,</span> <span class="n">a</span><span class="p">])</span>

            <span class="c1"># Y/alpha constraint</span>
            <span class="n">m</span><span class="o">.</span><span class="n">Y_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="n">con</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;Big_M&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">con</span><span class="p">,</span> <span class="n">a</span><span class="p">])</span>

            <span class="c1"># Z/alpha constraint</span>
            <span class="n">m</span><span class="o">.</span><span class="n">Z_constraints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">Z</span><span class="p">[</span><span class="n">con</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;Big_M&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">m</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">con</span><span class="p">,</span> <span class="n">a</span><span class="p">]))</span>

    <span class="c1"># If we have AFSCs that have specified a limit on the number of USAFA cadets</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gp</span><span class="p">[</span><span class="s1">&#39;A^&#39;</span><span class="p">][</span><span class="s1">&#39;U_lim&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># Number of USAFA cadets assigned to AFSCs that have an upper limit on USAFA cadets</span>
        <span class="n">usafa_cadet_lim_afsc_count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;C^&#39;</span><span class="p">][</span><span class="s1">&#39;U&#39;</span><span class="p">][</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;A^&#39;</span><span class="p">][</span><span class="s1">&#39;U_lim&#39;</span><span class="p">])</span>

        <span class="c1"># Overall number of cadets assigned to AFSCs that have an upper limit on USAFA cadets</span>
        <span class="n">cadet_lim_afsc_count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;C^&#39;</span><span class="p">][</span><span class="s1">&#39;E&#39;</span><span class="p">][</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;A^&#39;</span><span class="p">][</span><span class="s1">&#39;U_lim&#39;</span><span class="p">])</span>

        <span class="c1"># USAFA upper limit constraint</span>
        <span class="k">def</span> <span class="nf">USAFA_Limit</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">usafa_cadet_lim_afsc_count</span> <span class="o">&lt;=</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;u_limit&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">cadet_lim_afsc_count</span>

        <span class="n">m</span><span class="o">.</span><span class="n">usafa_limit_constraint</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="n">USAFA_Limit</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model built.&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="solutions.optimization.calculate_rewards_penalties" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_rewards_penalties</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">printing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#solutions.optimization.calculate_rewards_penalties" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>This function calculates the normalized penalties and rewards specific to an instance of
Rebecca's goal programming (GP) model.</p>
<p>Args:
    instance (object): The problem instance to solve, which contains the GP parameters.
    printing (bool, optional): Specifies whether to print status updates during the calculation. Default is True.</p>
<p>Returns:
    tuple: A tuple containing the normalized penalties and rewards as NumPy arrays.</p>
<p>Detailed Description:
    This function takes a set of Rebecca's goal programming parameters and returns the normalized penalties and
    rewards specific to the given instance. The function iterates over each constraint in the GP parameters and
    calculates the penalties and rewards using a GP model.</p>
<div class="highlight"><pre><span></span><code>The GP model is built by initializing the necessary parameters and solving the model for each constraint.
The rewards are calculated by maximizing the objective function that represents the reward term, while the
penalties are calculated by maximizing the objective function that represents the penalty term.

The function also calculates the reward term for the special constraint &#39;S&#39; separately.
</code></pre></div>
<p>Parameter Details:
    - instance (object): The problem instance to solve. It should contain the following attributes:
        - gp_parameters (dict): The GP parameters, including the constraint terms, utility values, and sets.
    - printing (bool, optional): Specifies whether to print status updates during the calculation. Default is True.</p>
<p>Returns:
    - rewards (numpy.ndarray): An array containing the normalized rewards for each constraint, including the reward
    for constraint 'S'.
    - penalties (numpy.ndarray): An array containing the normalized penalties for each constraint.</p>
<p>Note:
    The function assumes that the necessary functions 'gp_model_build' and 'solve_pyomo_model'
    are defined and accessible.</p>

            <details class="quote">
              <summary>Source code in <code>afccp/solutions/optimization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">calculate_rewards_penalties</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">printing</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function calculates the normalized penalties and rewards specific to an instance of</span>
<span class="sd">    Rebecca&#39;s goal programming (GP) model.</span>

<span class="sd">    Args:</span>
<span class="sd">        instance (object): The problem instance to solve, which contains the GP parameters.</span>
<span class="sd">        printing (bool, optional): Specifies whether to print status updates during the calculation. Default is True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: A tuple containing the normalized penalties and rewards as NumPy arrays.</span>

<span class="sd">    Detailed Description:</span>
<span class="sd">        This function takes a set of Rebecca&#39;s goal programming parameters and returns the normalized penalties and</span>
<span class="sd">        rewards specific to the given instance. The function iterates over each constraint in the GP parameters and</span>
<span class="sd">        calculates the penalties and rewards using a GP model.</span>

<span class="sd">        The GP model is built by initializing the necessary parameters and solving the model for each constraint.</span>
<span class="sd">        The rewards are calculated by maximizing the objective function that represents the reward term, while the</span>
<span class="sd">        penalties are calculated by maximizing the objective function that represents the penalty term.</span>

<span class="sd">        The function also calculates the reward term for the special constraint &#39;S&#39; separately.</span>

<span class="sd">    Parameter Details:</span>
<span class="sd">        - instance (object): The problem instance to solve. It should contain the following attributes:</span>
<span class="sd">            - gp_parameters (dict): The GP parameters, including the constraint terms, utility values, and sets.</span>
<span class="sd">        - printing (bool, optional): Specifies whether to print status updates during the calculation. Default is True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        - rewards (numpy.ndarray): An array containing the normalized rewards for each constraint, including the reward</span>
<span class="sd">        for constraint &#39;S&#39;.</span>
<span class="sd">        - penalties (numpy.ndarray): An array containing the normalized penalties for each constraint.</span>

<span class="sd">    Note:</span>
<span class="sd">        The function assumes that the necessary functions &#39;gp_model_build&#39; and &#39;solve_pyomo_model&#39;</span>
<span class="sd">        are defined and accessible.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Shorthand</span>
    <span class="n">gp</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">gp_parameters</span>

    <span class="c1"># Initialize gp arrays</span>
    <span class="n">num_constraints</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">gp</span><span class="p">[</span><span class="s1">&#39;con&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">rewards</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_constraints</span><span class="p">)</span>
    <span class="n">penalties</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_constraints</span><span class="p">)</span>

    <span class="c1"># Initialize model</span>
    <span class="n">instance</span><span class="o">.</span><span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;con_term&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;con&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Initialize constraint term</span>
    <span class="n">instance</span><span class="o">.</span><span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;get_reward&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># We want the reward term</span>
    <span class="n">instance</span><span class="o">.</span><span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;solve_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">4</span>  <span class="c1"># Don&#39;t want to be solving this thing for too long</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">gp_model_build</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">printing</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Build model</span>

    <span class="c1"># Loop through each constraint</span>
    <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">con</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">gp</span><span class="p">[</span><span class="s1">&#39;con&#39;</span><span class="p">]):</span>

        <span class="c1"># Set the constraint term</span>
        <span class="n">instance</span><span class="o">.</span><span class="n">mdl_p</span><span class="p">[</span><span class="s2">&quot;con_term&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">con</span>

        <span class="c1"># Get reward term</span>
        <span class="k">def</span> <span class="nf">objective_function</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">Z</span><span class="p">[</span><span class="n">con</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;A^&#39;</span><span class="p">][</span><span class="n">con</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Obtaining reward for constraint &#39;</span> <span class="o">+</span> <span class="n">con</span> <span class="o">+</span> <span class="s1">&#39;...&#39;</span><span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">objective</span> <span class="o">=</span> <span class="n">Objective</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="n">objective_function</span><span class="p">,</span> <span class="n">sense</span><span class="o">=</span><span class="n">maximize</span><span class="p">)</span>
        <span class="n">rewards</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">solve_pyomo_model</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="s2">&quot;GP&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Reward:&#39;</span><span class="p">,</span> <span class="n">rewards</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>

        <span class="c1"># Get penalty term</span>
        <span class="k">def</span> <span class="nf">objective_function</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="n">con</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;A^&#39;</span><span class="p">][</span><span class="n">con</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Obtaining penalty for constraint &#39;</span> <span class="o">+</span> <span class="n">con</span> <span class="o">+</span> <span class="s1">&#39;...&#39;</span><span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">objective</span> <span class="o">=</span> <span class="n">Objective</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="n">objective_function</span><span class="p">,</span> <span class="n">sense</span><span class="o">=</span><span class="n">maximize</span><span class="p">)</span>
        <span class="n">penalties</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">solve_pyomo_model</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="s2">&quot;GP&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Penalty:&#39;</span><span class="p">,</span> <span class="n">penalties</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>

    <span class="c1"># S reward term</span>
    <span class="k">def</span> <span class="nf">objective_function</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">gp</span><span class="p">[</span><span class="s1">&#39;utility&#39;</span><span class="p">][</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;A^&#39;</span><span class="p">][</span><span class="s1">&#39;W^E&#39;</span><span class="p">][</span><span class="n">c</span><span class="p">])</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">gp</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Obtaining reward for constraint S...&#39;</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">objective</span> <span class="o">=</span> <span class="n">Objective</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="n">objective_function</span><span class="p">,</span> <span class="n">sense</span><span class="o">=</span><span class="n">maximize</span><span class="p">)</span>
    <span class="n">rewards</span><span class="p">[</span><span class="n">num_constraints</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">solve_pyomo_model</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="s2">&quot;GP&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">printing</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Reward:&#39;</span><span class="p">,</span> <span class="n">rewards</span><span class="p">[</span><span class="n">num_constraints</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">penalties</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://gitlab.com/path-to-your-repo" target="_blank" rel="noopener" title="gitlab.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/input/tex/extensions/bm.js"></script>
      
    
  </body>
</html>